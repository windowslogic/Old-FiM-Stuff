$(document).ready(function(){"use strict";var t=false;$(".js-add-to-user-list").click(function(i){$("#modal_add_to_list").modal("show");if(!t){AjaxApiRequest.makeGetApiRequest("/api/list/paginated-lists/",function(t){if(t.success){$("#modal_add_to_list .loading").remove();$("#modal_add_to_list .js-simple-paginator-container").html(t.html)}else{Phoenix.Ui.showErrorMessage("Could not load lists");$("#modal_add_to_list").modal("hide")}},function(){Phoenix.Ui.showErrorMessage("Could not load lists");$("#modal_add_to_list").modal("hide")});t=true}i.preventDefault()});$("#modal_add_to_list").on("click","tr.js-add-list",function(t){var i=$("#modal_add_to_list table").data("object-guid");var o=$(t.target);if(!o.is("tr")){o=o.parents("tr")}var a=o.attr("data-ref-id");AjaxApiRequest.makeGetApiRequest("/api/list/"+a+"/add-item/"+i+"/",function(t){if(t.success){Phoenix.Ui.showSuccessMessage("Successfully added item to list.");$("#modal_add_to_list").modal("hide")}else{Phoenix.Ui.showErrorMessage("Error while adding object to list.");$("#modal_add_to_list").modal("hide")}},function(){Phoenix.Ui.showErrorMessage("Error while adding object to list.");$("#modal_add_to_list").modal("hide")})})});
$(function(){var t=function(){var t="js-user-vote",e="user-vote-in-progress",n=$("."+t);if(!n||n.length<1){return}var r=function(){var r=$("<span/>");var i=[t,e,"js-event-tracking"].join(" ");return function(t){var e,a;if(t&&t.length<1){return}a=t.find(".js-upvote-btn__text");e=r.clone();e.addClass(t.attr("class")).removeClass(i).append(t.contents());t.off().replaceWith(e);a.text(a.data("successMsg"));e.addClass("disabled");n=n.not(t)}}();var i=function(t,e){var n=t.closest(".js-upvote"),r;if(!n||n.length<1){return}r=n.find(".js-upvote-status");if(!r||r.length<1){return}r.html(e.buttonCount)};var a=function(){if(Phoenix&&Phoenix.Ui&&Phoenix.Ui.showErrorMessage){Phoenix.Ui.showErrorMessage("Upvoting isn't working right now, please try again later.",{hideDelay:3e3})}};var s=function(){var t;return function(n){if(!t){t={}}var s=n.data("guid"),o=t[s];if(o){return}o=$.ajax({url:n.attr("href"),type:"POST",beforeSend:function(){n.addClass(e)},error:a,success:function(t){if(t.votedFailed){a();return}n.each(function(){var e=$(this);if(!!t.buttonCount){i(e,t)}r(e)});var e="";var s=n.data("guid").split("-");if(s[0]=="1900"){e="review"}else if(s[0]=="1100"){e="article"}else if(s[0]=="2300"){e="video"}_BoomTrain.sendEvent("upvoted",{model:e,id:s[1]})},complete:function(){delete t[s]}});t[s]=o}}();var o=function(t){t.preventDefault();var e=$(this),r=e.data("guid");e=n.filter('[data-guid="'+r+'"]');s(e)};n.on("click.upvote",o)};var e=function(){var t=$(".js-upvote-status-msg");if(!t||t.length<1){return false}PostRender.getPostRenderData("UserBundle",function(e,n){if($.isEmptyObject(n)){return}var r=n.upvote;if($.isEmptyObject(r)){return}$.each(r,function(e,n){var r=n.statusMsg,i=t.filter('[data-guid="'+e+'"]');i.html(r)})});return true};if(false===e()){t()}});