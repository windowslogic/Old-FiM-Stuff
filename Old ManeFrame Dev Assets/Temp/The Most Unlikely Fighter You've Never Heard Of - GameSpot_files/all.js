function Swipe(n,e){"use strict";var t=function(){};var i=function(n){setTimeout(n||t,0)};var s={addEventListener:!!window.addEventListener,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,transitions:function(n){var e=["transitionProperty","WebkitTransition","MozTransition","OTransition","msTransition"];for(var t in e)if(n.style[e[t]]!==undefined)return true;return false}(document.createElement("swipe"))};if(!n)return;var a=n.children[0];var r,o,u,l;e=e||{};var f=parseInt(e.startSlide,10)||0;var c=e.speed||300;e.continuous=e.continuous!==undefined?e.continuous:true;function d(){r=a.children;l=r.length;if(r.length<2)e.continuous=false;if(s.transitions&&e.continuous&&r.length<3){a.appendChild(r[0].cloneNode(true));a.appendChild(a.children[1].cloneNode(true));r=a.children}o=new Array(r.length);u=n.getBoundingClientRect().width||n.offsetWidth;a.style.width=r.length*u+"px";var t=r.length;while(t--){var i=r[t];i.style.width=u+"px";i.setAttribute("data-index",t);if(s.transitions){i.style.left=t*-u+"px";p(t,f>t?-u:f<t?u:0,0)}}if(e.continuous&&s.transitions){p(w(f-1),-u,0);p(w(f+1),u,0)}if(!s.transitions)a.style.left=f*-u+"px";n.style.visibility="visible"}function v(){if(e.continuous)E(f-1);else if(f)E(f-1)}function h(){if(e.continuous)E(f+1);else if(f<r.length-1)E(f+1)}function w(n){return(r.length+n%r.length)%r.length}function E(n,t){if(f==n)return;if(s.transitions){var a=Math.abs(f-n)/(f-n);if(e.continuous){var l=a;a=-o[w(n)]/u;if(a!==l)n=-a*r.length+n}var d=Math.abs(f-n)-1;while(d--)p(w((n>f?n:f)-d-1),u*a,0);n=w(n);p(f,u*a,t||c);p(n,0,t||c);if(e.continuous)p(w(n-a),-(u*a),0)}else{n=w(n);x(f*-u,n*-u,t||c)}f=n;i(e.callback&&e.callback(f,r[f]))}function p(n,e,t){m(n,e,t);o[n]=e}function m(n,e,t){var i=r[n];var s=i&&i.style;if(!s)return;s.webkitTransitionDuration=s.MozTransitionDuration=s.msTransitionDuration=s.OTransitionDuration=s.transitionDuration=t+"ms";s.webkitTransform="translate("+e+"px,0)"+"translateZ(0)";s.msTransform=s.MozTransform=s.OTransform="translateX("+e+"px)"}function x(n,t,i){if(!i){a.style.left=t+"px";return}var s=+new Date;var o=setInterval(function(){var u=+new Date-s;if(u>i){a.style.left=t+"px";if(b)T();e.transitionEnd&&e.transitionEnd.call(event,f,r[f]);clearInterval(o);return}a.style.left=(t-n)*(Math.floor(u/i*100)/100)+n+"px"},4)}var b=e.auto||0;var g;function T(){g=setTimeout(h,b)}function y(){b=0;clearTimeout(g)}var L={};var k={};var D;var M={handleEvent:function(n){switch(n.type){case"touchstart":this.start(n);break;case"touchmove":this.move(n);break;case"touchend":i(this.end(n));break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"otransitionend":case"transitionend":i(this.transitionEnd(n));break;case"resize":i(d.call());break}if(e.stopPropagation)n.stopPropagation()},start:function(n){var e=n.touches[0];L={x:e.pageX,y:e.pageY,time:+new Date};D=undefined;k={};a.addEventListener("touchmove",this,false);a.addEventListener("touchend",this,false)},move:function(n){if(n.touches.length>1||n.scale&&n.scale!==1)return;if(e.disableScroll)n.preventDefault();var t=n.touches[0];k={x:t.pageX-L.x,y:t.pageY-L.y};if(typeof D=="undefined"){D=!!(D||Math.abs(k.x)<Math.abs(k.y))}if(!D){n.preventDefault();y();if(e.continuous){m(w(f-1),k.x+o[w(f-1)],0);m(f,k.x+o[f],0);m(w(f+1),k.x+o[w(f+1)],0)}else{k.x=k.x/(!f&&k.x>0||f==r.length-1&&k.x<0?Math.abs(k.x)/u+1:1);m(f-1,k.x+o[f-1],0);m(f,k.x+o[f],0);m(f+1,k.x+o[f+1],0)}}},end:function(n){var t=+new Date-L.time;var i=Number(t)<250&&Math.abs(k.x)>20||Math.abs(k.x)>u/2;var s=!f&&k.x>0||f==r.length-1&&k.x<0;if(e.continuous)s=false;var l=k.x<0;if(!D){if(i&&!s){if(l){if(e.continuous){p(w(f-1),-u,0);p(w(f+2),u,0)}else{p(f-1,-u,0)}p(f,o[f]-u,c);p(w(f+1),o[w(f+1)]-u,c);f=w(f+1)}else{if(e.continuous){p(w(f+1),u,0);p(w(f-2),-u,0)}else{p(f+1,u,0)}p(f,o[f]+u,c);p(w(f-1),o[w(f-1)]+u,c);f=w(f-1)}e.callback&&e.callback(f,r[f])}else{if(e.continuous){p(w(f-1),-u,c);p(f,0,c);p(w(f+1),u,c)}else{p(f-1,-u,c);p(f,0,c);p(f+1,u,c)}}}a.removeEventListener("touchmove",M,false);a.removeEventListener("touchend",M,false)},transitionEnd:function(n){if(parseInt(n.target.getAttribute("data-index"),10)==f){if(b)T();e.transitionEnd&&e.transitionEnd.call(n,f,r[f])}}};d();if(b)T();if(s.addEventListener){if(s.touch)a.addEventListener("touchstart",M,false);if(s.transitions){a.addEventListener("webkitTransitionEnd",M,false);a.addEventListener("msTransitionEnd",M,false);a.addEventListener("oTransitionEnd",M,false);a.addEventListener("otransitionend",M,false);a.addEventListener("transitionend",M,false)}window.addEventListener("resize",M,false)}else{window.onresize=function(){d()}}return{setup:function(){d()},slide:function(n,e){y();E(n,e)},prev:function(){y();v()},next:function(){y();h()},getPos:function(){return f},getNumSlides:function(){return l},kill:function(){y();a.style.width="auto";a.style.left=0;var n=r.length;while(n--){var e=r[n];e.style.width="100%";e.style.left=0;if(s.transitions)m(n,0,0)}if(s.addEventListener){a.removeEventListener("touchstart",M,false);a.removeEventListener("webkitTransitionEnd",M,false);a.removeEventListener("msTransitionEnd",M,false);a.removeEventListener("oTransitionEnd",M,false);a.removeEventListener("otransitionend",M,false);a.removeEventListener("transitionend",M,false);window.removeEventListener("resize",M,false)}else{window.onresize=null}}}}if(window.jQuery||window.Zepto){(function(n){n.fn.Swipe=function(e){return this.each(function(){n(this).data("Swipe",new Swipe(n(this)[0],e))})}})(window.jQuery||window.Zepto)}
(function(){function n(t,r,e){if(t===r)return 0!==t||1/t==1/r;if(null==t||null==r)return t===r;t._chain&&(t=t._wrapped);r._chain&&(r=r._wrapped);if(t.isEqual&&j.isFunction(t.isEqual))return t.isEqual(r);if(r.isEqual&&j.isFunction(r.isEqual))return r.isEqual(t);var u=o.call(t);if(u!=o.call(r))return!1;switch(u){case"[object String]":return t==""+r;case"[object Number]":return t!=+t?r!=+r:0==t?1/t==1/r:t==+r;case"[object Date]":case"[object Boolean]":return+t==+r;case"[object RegExp]":return t.source==r.source&&t.global==r.global&&t.multiline==r.multiline&&t.ignoreCase==r.ignoreCase}if("object"!=typeof t||"object"!=typeof r)return!1;for(var i=e.length;i--;)if(e[i]==t)return!0;e.push(t);var i=0,a=!0;if("[object Array]"==u){if(i=t.length,a=i==r.length)for(;i--&&(a=i in t==i in r&&n(t[i],r[i],e)););}else{if("constructor"in t!="constructor"in r||t.constructor!=r.constructor)return!1;for(var c in t)if(j.has(t,c)&&(i++,!(a=j.has(r,c)&&n(t[c],r[c],e))))break;if(a){for(c in r)if(j.has(r,c)&&!i--)break;a=!i}}e.pop();return a}var t=this,r=t._,e={},u=Array.prototype,i=Object.prototype,a=u.slice,c=u.unshift,o=i.toString,l=i.hasOwnProperty,f=u.forEach,s=u.map,p=u.reduce,h=u.reduceRight,g=u.filter,v=u.every,m=u.some,d=u.indexOf,y=u.lastIndexOf,i=Array.isArray,b=Object.keys,x=Function.prototype.bind,j=function(n){return new R(n)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=j),exports._=j):t._=j;j.VERSION="1.3.3";var _=j.each=j.forEach=function(n,t,r){if(n!=null)if(f&&n.forEach===f)n.forEach(t,r);else if(n.length===+n.length)for(var u=0,i=n.length;u<i;u++){if(u in n&&t.call(r,n[u],u,n)===e)break}else for(u in n)if(j.has(n,u)&&t.call(r,n[u],u,n)===e)break};j.map=j.collect=function(n,t,r){var e=[];if(n==null)return e;if(s&&n.map===s)return n.map(t,r);_(n,function(n,u,i){e[e.length]=t.call(r,n,u,i)});if(n.length===+n.length)e.length=n.length;return e};j.reduce=j.foldl=j.inject=function(n,t,r,e){var u=arguments.length>2;n==null&&(n=[]);if(p&&n.reduce===p){e&&(t=j.bind(t,e));return u?n.reduce(t,r):n.reduce(t)}_(n,function(n,i,a){if(u)r=t.call(e,r,n,i,a);else{r=n;u=true}});if(!u)throw new TypeError("Reduce of empty array with no initial value");return r};j.reduceRight=j.foldr=function(n,t,r,e){var u=arguments.length>2;n==null&&(n=[]);if(h&&n.reduceRight===h){e&&(t=j.bind(t,e));return u?n.reduceRight(t,r):n.reduceRight(t)}var i=j.toArray(n).reverse();e&&!u&&(t=j.bind(t,e));return u?j.reduce(i,t,r,e):j.reduce(i,t)};j.find=j.detect=function(n,t,r){var e;A(n,function(n,u,i){if(t.call(r,n,u,i)){e=n;return true}});return e};j.filter=j.select=function(n,t,r){var e=[];if(n==null)return e;if(g&&n.filter===g)return n.filter(t,r);_(n,function(n,u,i){t.call(r,n,u,i)&&(e[e.length]=n)});return e};j.reject=function(n,t,r){var e=[];if(n==null)return e;_(n,function(n,u,i){t.call(r,n,u,i)||(e[e.length]=n)});return e};j.every=j.all=function(n,t,r){var u=true;if(n==null)return u;if(v&&n.every===v)return n.every(t,r);_(n,function(n,i,a){if(!(u=u&&t.call(r,n,i,a)))return e});return!!u};var A=j.some=j.any=function(n,t,r){t||(t=j.identity);var u=false;if(n==null)return u;if(m&&n.some===m)return n.some(t,r);_(n,function(n,i,a){if(u||(u=t.call(r,n,i,a)))return e});return!!u};j.include=j.contains=function(n,t){var r=false;if(n==null)return r;if(d&&n.indexOf===d)return n.indexOf(t)!=-1;return r=A(n,function(n){return n===t})};j.invoke=function(n,t){var r=a.call(arguments,2);return j.map(n,function(n){return(j.isFunction(t)?t||n:n[t]).apply(n,r)})};j.pluck=function(n,t){return j.map(n,function(n){return n[t]})};j.max=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0])return Math.max.apply(Math,n);if(!t&&j.isEmpty(n))return-Infinity;var e={computed:-Infinity};_(n,function(n,u,i){u=t?t.call(r,n,u,i):n;u>=e.computed&&(e={value:n,computed:u})});return e.value};j.min=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0])return Math.min.apply(Math,n);if(!t&&j.isEmpty(n))return Infinity;var e={computed:Infinity};_(n,function(n,u,i){u=t?t.call(r,n,u,i):n;u<e.computed&&(e={value:n,computed:u})});return e.value};j.shuffle=function(n){var t=[],r;_(n,function(n,e){r=Math.floor(Math.random()*(e+1));t[e]=t[r];t[r]=n});return t};j.sortBy=function(n,t,r){var e=j.isFunction(t)?t:function(n){return n[t]};return j.pluck(j.map(n,function(n,t,u){return{value:n,criteria:e.call(r,n,t,u)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;return r===void 0?1:e===void 0?-1:r<e?-1:r>e?1:0}),"value")};j.groupBy=function(n,t){var r={},e=j.isFunction(t)?t:function(n){return n[t]};_(n,function(n,t){var u=e(n,t);(r[u]||(r[u]=[])).push(n)});return r};j.sortedIndex=function(n,t,r){r||(r=j.identity);for(var e=0,u=n.length;e<u;){var i=e+u>>1;r(n[i])<r(t)?e=i+1:u=i}return e};j.toArray=function(n){return!n?[]:j.isArray(n)||j.isArguments(n)?a.call(n):n.toArray&&j.isFunction(n.toArray)?n.toArray():j.values(n)};j.size=function(n){return j.isArray(n)?n.length:j.keys(n).length};j.first=j.head=j.take=function(n,t,r){return t!=null&&!r?a.call(n,0,t):n[0]};j.initial=function(n,t,r){return a.call(n,0,n.length-(t==null||r?1:t))};j.last=function(n,t,r){return t!=null&&!r?a.call(n,Math.max(n.length-t,0)):n[n.length-1]};j.rest=j.tail=function(n,t,r){return a.call(n,t==null||r?1:t)};j.compact=function(n){return j.filter(n,function(n){return!!n})};j.flatten=function(n,t){return j.reduce(n,function(n,r){if(j.isArray(r))return n.concat(t?r:j.flatten(r));n[n.length]=r;return n},[])};j.without=function(n){return j.difference(n,a.call(arguments,1))};j.uniq=j.unique=function(n,t,r){var r=r?j.map(n,r):n,e=[];n.length<3&&(t=true);j.reduce(r,function(r,u,i){if(t?j.last(r)!==u||!r.length:!j.include(r,u)){r.push(u);e.push(n[i])}return r},[]);return e};j.union=function(){return j.uniq(j.flatten(arguments,true))};j.intersection=j.intersect=function(n){var t=a.call(arguments,1);return j.filter(j.uniq(n),function(n){return j.every(t,function(t){return j.indexOf(t,n)>=0})})};j.difference=function(n){var t=j.flatten(a.call(arguments,1),true);return j.filter(n,function(n){return!j.include(t,n)})};j.zip=function(){for(var n=a.call(arguments),t=j.max(j.pluck(n,"length")),r=Array(t),e=0;e<t;e++)r[e]=j.pluck(n,""+e);return r};j.indexOf=function(n,t,r){if(n==null)return-1;var e;if(r){r=j.sortedIndex(n,t);return n[r]===t?r:-1}if(d&&n.indexOf===d)return n.indexOf(t);r=0;for(e=n.length;r<e;r++)if(r in n&&n[r]===t)return r;return-1};j.lastIndexOf=function(n,t){if(n==null)return-1;if(y&&n.lastIndexOf===y)return n.lastIndexOf(t);for(var r=n.length;r--;)if(r in n&&n[r]===t)return r;return-1};j.range=function(n,t,r){if(arguments.length<=1){t=n||0;n=0}for(var r=arguments[2]||1,e=Math.max(Math.ceil((t-n)/r),0),u=0,i=Array(e);u<e;){i[u++]=n;n=n+r}return i};var w=function(){};j.bind=function(n,t){var r,e;if(n.bind===x&&x)return x.apply(n,a.call(arguments,1));if(!j.isFunction(n))throw new TypeError;e=a.call(arguments,2);return r=function(){if(!(this instanceof r))return n.apply(t,e.concat(a.call(arguments)));w.prototype=n.prototype;var u=new w,i=n.apply(u,e.concat(a.call(arguments)));return Object(i)===i?i:u}};j.bindAll=function(n){var t=a.call(arguments,1);t.length==0&&(t=j.functions(n));_(t,function(t){n[t]=j.bind(n[t],n)});return n};j.memoize=function(n,t){var r={};t||(t=j.identity);return function(){var e=t.apply(this,arguments);return j.has(r,e)?r[e]:r[e]=n.apply(this,arguments)}};j.delay=function(n,t){var r=a.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)};j.defer=function(n){return j.delay.apply(j,[n,1].concat(a.call(arguments,1)))};j.throttle=function(n,t){var r,e,u,i,a,c,o=j.debounce(function(){a=i=false},t);return function(){r=this;e=arguments;u||(u=setTimeout(function(){u=null;a&&n.apply(r,e);o()},t));i?a=true:c=n.apply(r,e);o();i=true;return c}};j.debounce=function(n,t,r){var e;return function(){var u=this,i=arguments;r&&!e&&n.apply(u,i);clearTimeout(e);e=setTimeout(function(){e=null;r||n.apply(u,i)},t)}};j.once=function(n){var t=false,r;return function(){if(t)return r;t=true;return r=n.apply(this,arguments)}};j.wrap=function(n,t){return function(){var r=[n].concat(a.call(arguments,0));return t.apply(this,r)}};j.compose=function(){var n=arguments;return function(){for(var t=arguments,r=n.length-1;r>=0;r--)t=[n[r].apply(this,t)];return t[0]}};j.after=function(n,t){return n<=0?t():function(){if(--n<1)return t.apply(this,arguments)}};j.keys=b||function(n){if(n!==Object(n))throw new TypeError("Invalid object");var t=[],r;for(r in n)j.has(n,r)&&(t[t.length]=r);return t};j.values=function(n){return j.map(n,j.identity)};j.functions=j.methods=function(n){var t=[],r;for(r in n)j.isFunction(n[r])&&t.push(r);return t.sort()};j.extend=function(n){_(a.call(arguments,1),function(t){for(var r in t)n[r]=t[r]});return n};j.pick=function(n){var t={};_(j.flatten(a.call(arguments,1)),function(r){r in n&&(t[r]=n[r])});return t};j.defaults=function(n){_(a.call(arguments,1),function(t){for(var r in t)n[r]==null&&(n[r]=t[r])});return n};j.clone=function(n){return!j.isObject(n)?n:j.isArray(n)?n.slice():j.extend({},n)};j.tap=function(n,t){t(n);return n};j.isEqual=function(t,r){return n(t,r,[])};j.isEmpty=function(n){if(n==null)return true;if(j.isArray(n)||j.isString(n))return n.length===0;for(var t in n)if(j.has(n,t))return false;return true};j.isElement=function(n){return!!(n&&n.nodeType==1)};j.isArray=i||function(n){return o.call(n)=="[object Array]"};j.isObject=function(n){return n===Object(n)};j.isArguments=function(n){return o.call(n)=="[object Arguments]"};j.isArguments(arguments)||(j.isArguments=function(n){return!(!n||!j.has(n,"callee"))});j.isFunction=function(n){return o.call(n)=="[object Function]"};j.isString=function(n){return o.call(n)=="[object String]"};j.isNumber=function(n){return o.call(n)=="[object Number]"};j.isFinite=function(n){return j.isNumber(n)&&isFinite(n)};j.isNaN=function(n){return n!==n};j.isBoolean=function(n){return n===true||n===false||o.call(n)=="[object Boolean]"};j.isDate=function(n){return o.call(n)=="[object Date]"};j.isRegExp=function(n){return o.call(n)=="[object RegExp]"};j.isNull=function(n){return n===null};j.isUndefined=function(n){return n===void 0};j.has=function(n,t){return l.call(n,t)};j.noConflict=function(){t._=r;return this};j.identity=function(n){return n};j.times=function(n,t,r){for(var e=0;e<n;e++)t.call(r,e)};j.escape=function(n){return(""+n).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};j.result=function(n,t){if(n==null)return null;var r=n[t];return j.isFunction(r)?r.call(n):r};j.mixin=function(n){_(j.functions(n),function(t){N(t,j[t]=n[t])})};var E=0;j.uniqueId=function(n){var t=E++;return n?n+t:t};j.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var O=/.^/,F={"\\":"\\","'":"'",r:"\r",n:"\n",t:"	",u2028:"\u2028",u2029:"\u2029"},k;for(k in F)F[F[k]]=k;var q=/\\|'|\r|\n|\t|\u2028|\u2029/g,I=/\\(\\|'|r|n|t|u2028|u2029)/g,S=function(n){return n.replace(I,function(n,t){return F[t]})};j.template=function(n,t,r){r=j.defaults(r||{},j.templateSettings);n="__p+='"+n.replace(q,function(n){return"\\"+F[n]}).replace(r.escape||O,function(n,t){return"'+\n_.escape("+S(t)+")+\n'"}).replace(r.interpolate||O,function(n,t){return"'+\n("+S(t)+")+\n'"}).replace(r.evaluate||O,function(n,t){return"';\n"+S(t)+"\n;__p+='"})+"';\n";r.variable||(n="with(obj||{}){\n"+n+"}\n");var n="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+n+"return __p;\n",e=new Function(r.variable||"obj","_",n);if(t)return e(t,j);t=function(n){return e.call(this,n,j)};t.source="function("+(r.variable||"obj")+"){\n"+n+"}";return t};j.chain=function(n){return j(n).chain()};var R=function(n){this._wrapped=n};j.prototype=R.prototype;var M=function(n,t){return t?j(n).chain():n},N=function(n,t){R.prototype[n]=function(){var n=a.call(arguments);c.call(n,this._wrapped);return M(t.apply(j,n),this._chain)}};j.mixin(j);_("pop,push,reverse,shift,sort,splice,unshift".split(","),function(n){var t=u[n];R.prototype[n]=function(){var r=this._wrapped;t.apply(r,arguments);var e=r.length;(n=="shift"||n=="splice")&&e===0&&delete r[0];return M(r,this._chain)}});_(["concat","join","slice"],function(n){var t=u[n];R.prototype[n]=function(){return M(t.apply(this._wrapped,arguments),this._chain)}});R.prototype.chain=function(){this._chain=true;return this};R.prototype.value=function(){return this._wrapped}}).call(this);
(function(){var t=this,e=t.Backbone,i=Array.prototype.slice,s=Array.prototype.splice,n;n="undefined"!==typeof exports?exports:t.Backbone={};n.VERSION="0.9.2";var r=t._;!r&&"undefined"!==typeof require&&(r=require("underscore"));var a=t.jQuery||t.Zepto||t.ender;n.setDomLibrary=function(t){a=t};n.noConflict=function(){t.Backbone=e;return this};n.emulateHTTP=!1;n.emulateJSON=!1;var o=/\s+/,h=n.Events={on:function(t,e,i){var s,n,r,a,h;if(!e)return this;t=t.split(o);for(s=this._callbacks||(this._callbacks={});n=t.shift();)r=(h=s[n])?h.tail:{},r.next=a={},r.context=i,r.callback=e,s[n]={tail:a,next:h?h.next:r};return this},off:function(t,e,i){var s,n,a,h,c,u;if(n=this._callbacks){if(!t&&!e&&!i)return delete this._callbacks,this;for(t=t?t.split(o):r.keys(n);s=t.shift();)if(a=n[s],delete n[s],a&&(e||i))for(h=a.tail;(a=a.next)!==h;)if(c=a.callback,u=a.context,e&&c!==e||i&&u!==i)this.on(s,c,u);return this}},trigger:function(t){var e,s,n,r,a,h;if(!(n=this._callbacks))return this;a=n.all;t=t.split(o);for(h=i.call(arguments,1);e=t.shift();){if(s=n[e])for(r=s.tail;(s=s.next)!==r;)s.callback.apply(s.context||this,h);if(s=a){r=s.tail;for(e=[e].concat(h);(s=s.next)!==r;)s.callback.apply(s.context||this,e)}}return this}};h.bind=h.on;h.unbind=h.off;var c=n.Model=function(t,e){var i;t||(t={});e&&e.parse&&(t=this.parse(t));if(i=S(this,"defaults"))t=r.extend({},i,t);e&&e.collection&&(this.collection=e.collection);this.attributes={};this._escapedAttributes={};this.cid=r.uniqueId("c");this.changed={};this._silent={};this._pending={};this.set(t,{silent:!0});this.changed={};this._silent={};this._pending={};this._previousAttributes=r.clone(this.attributes);this.initialize.apply(this,arguments)};r.extend(c.prototype,h,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(){return r.clone(this.attributes)},get:function(t){return this.attributes[t]},escape:function(t){var e;if(e=this._escapedAttributes[t])return e;e=this.get(t);return this._escapedAttributes[t]=r.escape(null==e?"":""+e)},has:function(t){return null!=this.get(t)},set:function(t,e,i){var s,n;r.isObject(t)||null==t?(s=t,i=e):(s={},s[t]=e);i||(i={});if(!s)return this;s instanceof c&&(s=s.attributes);if(i.unset)for(n in s)s[n]=void 0;if(!this._validate(s,i))return!1;this.idAttribute in s&&(this.id=s[this.idAttribute]);var e=i.changes={},a=this.attributes,o=this._escapedAttributes,h=this._previousAttributes||{};for(n in s){t=s[n];if(!r.isEqual(a[n],t)||i.unset&&r.has(a,n))delete o[n],(i.silent?this._silent:e)[n]=!0;i.unset?delete a[n]:a[n]=t;!r.isEqual(h[n],t)||r.has(a,n)!=r.has(h,n)?(this.changed[n]=t,i.silent||(this._pending[n]=!0)):(delete this.changed[n],delete this._pending[n])}i.silent||this.change(i);return this},unset:function(t,e){(e||(e={})).unset=!0;return this.set(t,null,e)},clear:function(t){(t||(t={})).unset=!0;return this.set(r.clone(this.attributes),t)},fetch:function(t){var t=t?r.clone(t):{},e=this,i=t.success;t.success=function(s,n,r){if(!e.set(e.parse(s,r),t))return!1;i&&i(e,s)};t.error=n.wrapError(t.error,e,t);return(this.sync||n.sync).call(this,"read",this,t)},save:function(t,e,i){var s,a;r.isObject(t)||null==t?(s=t,i=e):(s={},s[t]=e);i=i?r.clone(i):{};if(i.wait){if(!this._validate(s,i))return!1;a=r.clone(this.attributes)}t=r.extend({},i,{silent:!0});if(s&&!this.set(s,i.wait?t:i))return!1;var o=this,h=i.success;i.success=function(t,e,n){e=o.parse(t,n);if(i.wait){delete i.wait;e=r.extend(s||{},e)}if(!o.set(e,i))return false;h?h(o,t):o.trigger("sync",o,t,i)};i.error=n.wrapError(i.error,o,i);e=this.isNew()?"create":"update";e=(this.sync||n.sync).call(this,e,this,i);i.wait&&this.set(a,t);return e},destroy:function(t){var t=t?r.clone(t):{},e=this,i=t.success,s=function(){e.trigger("destroy",e,e.collection,t)};if(this.isNew())return s(),!1;t.success=function(n){t.wait&&s();i?i(e,n):e.trigger("sync",e,n,t)};t.error=n.wrapError(t.error,e,t);var a=(this.sync||n.sync).call(this,"delete",this,t);t.wait||s();return a},url:function(){var t=S(this,"urlRoot")||S(this.collection,"url")||k();return this.isNew()?t:t+("/"==t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(t){t||(t={});var e=this._changing;this._changing=!0;for(var i in this._silent)this._pending[i]=!0;var s=r.extend({},t.changes,this._silent);this._silent={};for(i in s)this.trigger("change:"+i,this,this.get(i),t);if(e)return this;for(;!r.isEmpty(this._pending);){this._pending={};this.trigger("change",this,t);for(i in this.changed)!this._pending[i]&&!this._silent[i]&&delete this.changed[i];this._previousAttributes=r.clone(this.attributes)}this._changing=!1;return this},hasChanged:function(t){return!arguments.length?!r.isEmpty(this.changed):r.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?r.clone(this.changed):!1;var e,i=!1,s=this._previousAttributes,n;for(n in t)if(!r.isEqual(s[n],e=t[n]))(i||(i={}))[n]=e;return i},previous:function(t){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[t]},previousAttributes:function(){return r.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(t,e){if(e.silent||!this.validate)return!0;var t=r.extend({},this.attributes,t),i=this.validate(t,e);if(!i)return!0;e&&e.error?e.error(this,i,e):this.trigger("error",this,i,e);return!1}});var u=n.Collection=function(t,e){e||(e={});e.model&&(this.model=e.model);e.comparator&&(this.comparator=e.comparator);this._reset();this.initialize.apply(this,arguments);t&&this.reset(t,{silent:!0,parse:e.parse})};r.extend(u.prototype,h,{model:c,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},add:function(t,e){var i,n,a,o,h,c={},u={},l=[];e||(e={});t=r.isArray(t)?t.slice():[t];i=0;for(n=t.length;i<n;i++){if(!(a=t[i]=this._prepareModel(t[i],e)))throw Error("Can't add an invalid model to a collection");o=a.cid;h=a.id;c[o]||this._byCid[o]||null!=h&&(u[h]||this._byId[h])?l.push(i):c[o]=u[h]=a}for(i=l.length;i--;)t.splice(l[i],1);i=0;for(n=t.length;i<n;i++)(a=t[i]).on("all",this._onModelEvent,this),this._byCid[a.cid]=a,null!=a.id&&(this._byId[a.id]=a);this.length+=n;s.apply(this.models,[null!=e.at?e.at:this.models.length,0].concat(t));this.comparator&&this.sort({silent:!0});if(e.silent)return this;i=0;for(n=this.models.length;i<n;i++)if(c[(a=this.models[i]).cid])e.index=i,a.trigger("add",a,this,e);return this},remove:function(t,e){var i,s,n,a;e||(e={});t=r.isArray(t)?t.slice():[t];i=0;for(s=t.length;i<s;i++)if(a=this.getByCid(t[i])||this.get(t[i]))delete this._byId[a.id],delete this._byCid[a.cid],n=this.indexOf(a),this.models.splice(n,1),this.length--,e.silent||(e.index=n,a.trigger("remove",a,this,e)),this._removeReference(a);return this},push:function(t,e){t=this._prepareModel(t,e);this.add(t,e);return t},pop:function(t){var e=this.at(this.length-1);this.remove(e,t);return e},unshift:function(t,e){t=this._prepareModel(t,e);this.add(t,r.extend({at:0},e));return t},shift:function(t){var e=this.at(0);this.remove(e,t);return e},get:function(t){return null==t?void 0:this._byId[null!=t.id?t.id:t]},getByCid:function(t){return t&&this._byCid[t.cid||t]},at:function(t){return this.models[t]},where:function(t){return r.isEmpty(t)?[]:this.filter(function(e){for(var i in t)if(t[i]!==e.get(i))return!1;return!0})},sort:function(t){t||(t={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");var e=r.bind(this.comparator,this);1==this.comparator.length?this.models=this.sortBy(e):this.models.sort(e);t.silent||this.trigger("reset",this,t);return this},pluck:function(t){return r.map(this.models,function(e){return e.get(t)})},reset:function(t,e){t||(t=[]);e||(e={});for(var i=0,s=this.models.length;i<s;i++)this._removeReference(this.models[i]);this._reset();this.add(t,r.extend({silent:!0},e));e.silent||this.trigger("reset",this,e);return this},fetch:function(t){t=t?r.clone(t):{};void 0===t.parse&&(t.parse=!0);var e=this,i=t.success;t.success=function(s,n,r){e[t.add?"add":"reset"](e.parse(s,r),t);i&&i(e,s)};t.error=n.wrapError(t.error,e,t);return(this.sync||n.sync).call(this,"read",this,t)},create:function(t,e){var i=this,e=e?r.clone(e):{},t=this._prepareModel(t,e);if(!t)return!1;e.wait||i.add(t,e);var s=e.success;e.success=function(n,r){e.wait&&i.add(n,e);s?s(n,r):n.trigger("sync",t,r,e)};t.save(null,e);return t},parse:function(t){return t},chain:function(){return r(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(t,e){e||(e={});t instanceof c?t.collection||(t.collection=this):(e.collection=this,t=new this.model(t,e),t._validate(t.attributes,e)||(t=!1));return t},_removeReference:function(t){this==t.collection&&delete t.collection;t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,s){("add"==t||"remove"==t)&&i!=this||("destroy"==t&&this.remove(e,s),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],this._byId[e.id]=e),this.trigger.apply(this,arguments))}});r.each("forEach,each,map,reduce,reduceRight,find,detect,filter,select,reject,every,all,some,any,include,contains,invoke,max,min,sortBy,sortedIndex,toArray,size,first,initial,rest,last,without,indexOf,shuffle,lastIndexOf,isEmpty,groupBy".split(","),function(t){u.prototype[t]=function(){return r[t].apply(r,[this.models].concat(r.toArray(arguments)))}});var l=n.Router=function(t){t||(t={});t.routes&&(this.routes=t.routes);this._bindRoutes();this.initialize.apply(this,arguments)},d=/:\w+/g,f=/\*\w+/g,p=/[-[\]{}()+?.,\\^$|#\s]/g;r.extend(l.prototype,h,{initialize:function(){},route:function(t,e,i){n.history||(n.history=new g);r.isRegExp(t)||(t=this._routeToRegExp(t));i||(i=this[e]);n.history.route(t,r.bind(function(s){s=this._extractParameters(t,s);i&&i.apply(this,s);this.trigger.apply(this,["route:"+e].concat(s));n.history.trigger("route",this,e,s)},this));return this},navigate:function(t,e){n.history.navigate(t,e)},_bindRoutes:function(){if(this.routes){var t=[],e;for(e in this.routes)t.unshift([e,this.routes[e]]);e=0;for(var i=t.length;e<i;e++)this.route(t[e][0],t[e][1],this[t[e][1]])}},_routeToRegExp:function(t){t=t.replace(p,"\\$&").replace(d,"([^/]+)").replace(f,"(.*?)");return RegExp("^"+t+"$")},_extractParameters:function(t,e){return t.exec(e).slice(1)}});var g=n.History=function(){this.handlers=[];r.bindAll(this,"checkUrl")},m=/^[#\/]/,v=/msie [\w.]+/;g.started=!1;r.extend(g.prototype,h,{interval:50,getHash:function(t){return(t=(t?t.location:window.location).href.match(/#(.*)$/))?t[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||e){var t=window.location.pathname,i=window.location.search;i&&(t+=i)}else t=this.getHash();t.indexOf(this.options.root)||(t=t.substr(this.options.root.length));return t.replace(m,"")},start:function(t){if(g.started)throw Error("Backbone.history has already been started");g.started=!0;this.options=r.extend({},{root:"/"},this.options,t);this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!window.history||!window.history.pushState);var t=this.getFragment(),e=document.documentMode;if(e=v.exec(navigator.userAgent.toLowerCase())&&(!e||7>=e))this.iframe=a('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t);this._hasPushState?a(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!e?a(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval));this.fragment=t;t=window.location;e=t.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!e)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&e&&t.hash&&(this.fragment=this.getHash().replace(m,""),window.history.replaceState({},document.title,t.protocol+"//"+t.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){a(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);g.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();t==this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t==this.fragment)return!1;this.iframe&&this.navigate(t);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(t){var e=this.fragment=this.getFragment(t);return r.any(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0})},navigate:function(t,e){if(!g.started)return!1;if(!e||!0===e)e={trigger:e};var i=(t||"").replace(m,"");this.fragment!=i&&(this._hasPushState?(0!=i.indexOf(this.options.root)&&(i=this.options.root+i),this.fragment=i,window.history[e.replace?"replaceState":"pushState"]({},document.title,i)):this._wantsHashChange?(this.fragment=i,this._updateHash(window.location,i,e.replace),this.iframe&&i!=this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,i,e.replace))):window.location.assign(this.options.root+t),e.trigger&&this.loadUrl(t))},_updateHash:function(t,e,i){i?t.replace(t.toString().replace(/(javascript:|#).*$/,"")+"#"+e):t.hash=e}});var _=n.View=function(t){this.cid=r.uniqueId("view");this._configure(t||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()},y=/^(\S+)\s*(.*)$/,b="model,collection,el,id,attributes,className,tagName".split(",");r.extend(_.prototype,h,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();return this},make:function(t,e,i){t=document.createElement(t);e&&a(t).attr(e);i&&a(t).html(i);return t},setElement:function(t,e){this.$el&&this.undelegateEvents();this.$el=t instanceof a?t:a(t);this.el=this.$el[0];!1!==e&&this.delegateEvents();return this},delegateEvents:function(t){if(t||(t=S(this,"events"))){this.undelegateEvents();for(var e in t){var i=t[e];r.isFunction(i)||(i=this[t[e]]);if(!i)throw Error('Method "'+t[e]+'" does not exist');var s=e.match(y),n=s[1],s=s[2],i=r.bind(i,this),n=n+(".delegateEvents"+this.cid);""===s?this.$el.bind(n,i):this.$el.delegate(s,n,i)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(t){this.options&&(t=r.extend({},this.options,t));for(var e=0,i=b.length;e<i;e++){var s=b[e];t[s]&&(this[s]=t[s])}this.options=t},_ensureElement:function(){if(this.el)this.setElement(this.el,!1);else{var t=S(this,"attributes")||{};this.id&&(t.id=this.id);this.className&&(t["class"]=this.className);this.setElement(this.make(this.tagName,t),!1)}}});c.extend=u.extend=l.extend=_.extend=function(t,e){var i=E(this,t,e);i.extend=this.extend;return i};var w={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};n.sync=function(t,e,i){var s=w[t];i||(i={});var o={type:s,dataType:"json"};i.url||(o.url=S(e,"url")||k());if(!i.data&&e&&("create"==t||"update"==t))o.contentType="application/json",o.data=JSON.stringify(e.toJSON());n.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{});if(n.emulateHTTP&&("PUT"===s||"DELETE"===s))n.emulateJSON&&(o.data._method=s),o.type="POST",o.beforeSend=function(t){t.setRequestHeader("X-HTTP-Method-Override",s)};"GET"!==o.type&&!n.emulateJSON&&(o.processData=!1);return a.ajax(r.extend(o,i))};n.wrapError=function(t,e,i){return function(s,n){n=s===e?n:s;t?t(e,n,i):e.trigger("error",e,n,i)}};var x=function(){},E=function(t,e,i){var s;s=e&&e.hasOwnProperty("constructor")?e.constructor:function(){t.apply(this,arguments)};r.extend(s,t);x.prototype=t.prototype;s.prototype=new x;e&&r.extend(s.prototype,e);i&&r.extend(s,i);s.prototype.constructor=s;s.__super__=t.prototype;return s},S=function(t,e){return!t||!t[e]?null:r.isFunction(t[e])?t[e]():t[e]},k=function(){throw Error('A "url" property or function must be specified')}}).call(this);
var Kinetic={};Kinetic.GlobalObject={stages:[],idCounter:0,tempNodes:[],animations:[],animIdCounter:0,animRunning:false,maxDragTimeInterval:20,frame:{time:0,timeDiff:0,lastTime:0},drag:{moving:false,node:undefined,offset:{x:0,y:0},lastDrawTime:0},extend:function(t,e){for(var i in e.prototype){if(e.prototype.hasOwnProperty(i)&&t.prototype[i]===undefined){t.prototype[i]=e.prototype[i]}}},addSetters:function(t,e){for(var i=0;i<e.length;i++){var n=e[i];this._addSetter(t,n)}},addGetters:function(t,e){for(var i=0;i<e.length;i++){var n=e[i];this._addGetter(t,n)}},_pullNodes:function(t){var e=this.tempNodes;for(var i=0;i<e.length;i++){var n=e[i];if(n.getStage()!==undefined&&n.getStage()._id===t._id){t._addId(n);t._addName(n);this.tempNodes.splice(i,1);i-=1}}},_addAnimation:function(t){t.id=this.animIdCounter++;this.animations.push(t)},_removeAnimation:function(t){var e=t.id;var i=this.animations;for(var n=0;n<i.length;n++){if(i[n].id===e){this.animations.splice(n,1);return false}}},_runFrames:function(){var t={};for(var e=0;e<this.animations.length;e++){var i=this.animations[e];if(i.node&&i.node._id!==undefined){t[i.node._id]=i.node}i.func(this.frame)}for(var n in t){t[n].draw()}},_updateFrameObject:function(){var t=new Date;var e=t.getTime();if(this.frame.lastTime===0){this.frame.lastTime=e}else{this.frame.timeDiff=e-this.frame.lastTime;this.frame.lastTime=e;this.frame.time+=this.frame.timeDiff}},_animationLoop:function(){if(this.animations.length>0){this._updateFrameObject();this._runFrames();var t=this;window.requestAnimFrame(function(){t._animationLoop()})}else{this.animRunning=false;this.frame.lastTime=0}},_handleAnimation:function(){var t=this;if(!this.animRunning){this.animRunning=true;t._animationLoop()}else{this.frame.lastTime=0}},_isElement:function(t){return!!(t&&t.nodeType==1)},_isFunction:function(t){return!!(t&&t.constructor&&t.call&&t.apply)},_isArray:function(t){return Object.prototype.toString.call(t)=="[object Array]"},_isObject:function(t){return t!==undefined&&t.constructor==Object},_isNumber:function(t){return Object.prototype.toString.call(t)=="[object Number]"},_hasMethods:function(t){var e=[];for(var i in t){if(this._isFunction(t[i]))e.push(i)}return e.length>0},_getXY:function(t){if(this._isNumber(t)){return{x:t,y:t}}else if(this._isArray(t)){if(t.length===1){var e=t[0];if(this._isNumber(e)){return{x:e,y:e}}else if(this._isArray(e)){return{x:e[0],y:e[1]}}else if(this._isObject(e)){return e}}else if(t.length>=2){return{x:t[0],y:t[1]}}}else if(this._isObject(t)){return t}return{x:0,y:0}},_getSize:function(t){if(this._isNumber(t)){return{width:t,height:t}}else if(this._isArray(t)){if(t.length===1){var e=t[0];if(this._isNumber(e)){return{width:e,height:e}}else if(this._isArray(e)){if(e.length>=4){return{width:e[2],height:e[3]}}else if(e.length>=2){return{width:e[0],height:e[1]}}}else if(this._isObject(e)){return e}}else if(t.length>=4){return{width:t[2],height:t[3]}}else if(t.length>=2){return{width:t[0],height:t[1]}}}else if(this._isObject(t)){return t}return{width:0,height:0}},_getPoints:function(t){if(t===undefined){return[]}if(this._isObject(t[0])){return t}else{var e=[];for(var i=0;i<t.length;i+=2){e.push({x:t[i],y:t[i+1]})}return e}},_addSetter:function(t,e){var i=this;var n="set"+e.charAt(0).toUpperCase()+e.slice(1);t.prototype[n]=function(t){var i={};i[e]=t;this.setAttrs(i)}},_addGetter:function(t,e){var i=this;var n="get"+e.charAt(0).toUpperCase()+e.slice(1);t.prototype[n]=function(t){return this.attrs[e]}}};window.requestAnimFrame=function(t){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();Kinetic.Node=function(t){this.defaultNodeAttrs={visible:true,listening:true,name:undefined,alpha:1,x:0,y:0,scale:{x:1,y:1},rotation:0,offset:{x:0,y:0},dragConstraint:"none",dragBounds:{},draggable:false};this.setDefaultAttrs(this.defaultNodeAttrs);this.eventListeners={};this.setAttrs(t);this.on("draggableChange.kinetic",function(){if(this.attrs.draggable){this._listenDrag()}else{this._dragCleanup();var t=this.getStage();var e=Kinetic.GlobalObject;if(t&&e.drag.node&&e.drag.node._id===this._id){t._endDrag()}}});this.simulate("draggableChange")};Kinetic.Node.prototype={on:function(t,e){var i=t.split(" ");for(var n=0;n<i.length;n++){var s=i[n];var a=s;var r=a.split(".");var h=r[0];var o=r.length>1?r[1]:"";if(!this.eventListeners[h]){this.eventListeners[h]=[]}this.eventListeners[h].push({name:o,handler:e})}},off:function(t){var e=t.split(" ");for(var i=0;i<e.length;i++){var n=e[i];var s=n;var a=s.split(".");var r=a[0];if(this.eventListeners[r]&&a.length>1){var h=a[1];for(var o=0;o<this.eventListeners[r].length;o++){if(this.eventListeners[r][o].name===h){this.eventListeners[r].splice(o,1);if(this.eventListeners[r].length===0){delete this.eventListeners[r];break}o--}}}else{delete this.eventListeners[r]}}},getAttrs:function(){return this.attrs},setDefaultAttrs:function(t){if(this.attrs===undefined){this.attrs={}}if(t){for(var e in t){if(this.attrs[e]===undefined){this.attrs[e]=t[e]}}}},setAttrs:function(t){var e=Kinetic.GlobalObject;var i=this;var n;if(t!==undefined){var s=function(t,a,r){for(var h in a){var o=a[h];if(t[h]===undefined){t[h]={}}if(e._isObject(o)&&!e._isArray(o)&&!e._isElement(o)&&!e._hasMethods(o)){if(!Kinetic.GlobalObject._isObject(t[h])){t[h]={}}s(t[h],o,r+1)}else{switch(h){case"rotationDeg":i._setAttr(t,"rotation",a[h]*Math.PI/180);h="rotation";break;case"offset":n=e._getXY(o);i._setAttr(t[h],"x",n.x);i._setAttr(t[h],"y",n.y);break;case"scale":n=e._getXY(o);i._setAttr(t[h],"x",n.x);i._setAttr(t[h],"y",n.y);break;case"points":i._setAttr(t,h,e._getPoints(o));break;case"crop":n=e._getXY(o);var c=e._getSize(o);i._setAttr(t[h],"x",n.x);i._setAttr(t[h],"y",n.y);i._setAttr(t[h],"width",c.width);i._setAttr(t[h],"height",c.height);break;default:i._setAttr(t,h,o);break}if(r===0){i._fireChangeEvent(h)}}}};s(this.attrs,t,0)}},isVisible:function(){if(this.getParent()&&!this.getParent().isVisible()){return false}return this.attrs.visible},show:function(){this.setAttrs({visible:true})},hide:function(){this.setAttrs({visible:false})},getZIndex:function(){return this.index},getAbsoluteZIndex:function(){var t=this.getLevel();var e=this.getStage();var i=this;var n=0;function s(e){var a=[];for(var r=0;r<e.length;r++){var h=e[r];n++;if(h.nodeType!=="Shape"){a=a.concat(h.getChildren())}if(h._id===i._id){r=e.length}}if(a.length>0&&a[0].getLevel()<=t){s(a)}}if(i.nodeType!=="Stage"){s(i.getStage().getChildren())}return n},getLevel:function(){var t=0;var e=this.parent;while(e){t++;e=e.parent}return t},setScale:function(){this.setAttrs({scale:Array.prototype.slice.call(arguments)})},setPosition:function(){var t=Kinetic.GlobalObject._getXY(Array.prototype.slice.call(arguments));this.setAttrs(t)},getPosition:function(){return{x:this.attrs.x,y:this.attrs.y}},getAbsolutePosition:function(){return this.getAbsoluteTransform().getTranslation()},setAbsolutePosition:function(){var t=Kinetic.GlobalObject._getXY(Array.prototype.slice.call(arguments));var e=this.attrs.rotation;var i={x:this.attrs.scale.x,y:this.attrs.scale.y};var n={x:this.attrs.offset.x,y:this.attrs.offset.y};this.attrs.rotation=0;this.attrs.scale={x:1,y:1};var s=this.getAbsoluteTransform();s.invert();s.translate(t.x,t.y);t={x:this.attrs.x+s.getTranslation().x,y:this.attrs.y+s.getTranslation().y};this.setPosition(t.x,t.y);this.rotate(e);this.attrs.scale={x:i.x,y:i.y}},move:function(){var t=Kinetic.GlobalObject._getXY(Array.prototype.slice.call(arguments));var e=this.getX();var i=this.getY();if(t.x!==undefined){e+=t.x}if(t.y!==undefined){i+=t.y}this.setAttrs({x:e,y:i})},setRotationDeg:function(t){this.setRotation(t*Math.PI/180)},getRotationDeg:function(){return this.attrs.rotation*180/Math.PI},rotate:function(t){this.setAttrs({rotation:this.getRotation()+t})},rotateDeg:function(t){this.setAttrs({rotation:this.getRotation()+t*Math.PI/180})},moveToTop:function(){var t=this.index;this.parent.children.splice(t,1);this.parent.children.push(this);this.parent._setChildrenIndices()},moveUp:function(){var t=this.index;this.parent.children.splice(t,1);this.parent.children.splice(t+1,0,this);this.parent._setChildrenIndices()},moveDown:function(){var t=this.index;if(t>0){this.parent.children.splice(t,1);this.parent.children.splice(t-1,0,this);this.parent._setChildrenIndices()}},moveToBottom:function(){var t=this.index;this.parent.children.splice(t,1);this.parent.children.unshift(this);this.parent._setChildrenIndices()},setZIndex:function(t){var e=this.index;this.parent.children.splice(e,1);this.parent.children.splice(t,0,this);this.parent._setChildrenIndices()},getAbsoluteAlpha:function(){var t=1;var e=this;while(e.nodeType!=="Stage"){t*=e.attrs.alpha;e=e.parent}return t},isDragging:function(){var t=Kinetic.GlobalObject;return t.drag.node!==undefined&&t.drag.node._id===this._id&&t.drag.moving},moveTo:function(t){var e=this.parent;e.children.splice(this.index,1);e._setChildrenIndices();t.children.push(this);this.index=t.children.length-1;this.parent=t;t._setChildrenIndices()},getParent:function(){return this.parent},getLayer:function(){if(this.nodeType==="Layer"){return this}else{return this.getParent().getLayer()}},getStage:function(){if(this.nodeType==="Stage"){return this}else{if(this.getParent()===undefined){return undefined}else{return this.getParent().getStage()}}},simulate:function(t){this._handleEvent(t,{})},setOffset:function(){this.setAttrs({offset:Array.prototype.slice.call(arguments)})},transitionTo:function(t){var e=Kinetic.GlobalObject;if(this.transAnim!==undefined){e._removeAnimation(this.transAnim);this.transAnim=undefined}var i=this.nodeType==="Stage"?this:this.getLayer();var n=this;var s=new Kinetic.Transition(this,t);var a={func:function(){s._onEnterFrame()},node:i};this.transAnim=a;e._addAnimation(a);s.onFinished=function(){e._removeAnimation(a);n.transAnim=undefined;if(t.callback!==undefined){t.callback()}a.node.draw()};s.start();e._handleAnimation();return s},getAbsoluteTransform:function(){var t=new Kinetic.Transform;var e=[];var i=this.parent;e.unshift(this);while(i){e.unshift(i);i=i.parent}for(var n=0;n<e.length;n++){var s=e[n];var a=s.getTransform();t.multiply(a)}return t},getTransform:function(){var t=new Kinetic.Transform;if(this.attrs.x!==0||this.attrs.y!==0){t.translate(this.attrs.x,this.attrs.y)}if(this.attrs.rotation!==0){t.rotate(this.attrs.rotation)}if(this.attrs.scale.x!==1||this.attrs.scale.y!==1){t.scale(this.attrs.scale.x,this.attrs.scale.y)}return t},_fireChangeEvent:function(t){this._handleEvent(t+"Change",{})},_setAttr:function(t,e,i){if(i!==undefined){t[e]=i}},_listenDrag:function(){this._dragCleanup();var t=Kinetic.GlobalObject;var e=this;this.on("mousedown.kinetic_initdrag touchstart.kinetic_initdrag",function(t){e._initDrag()})},_initDrag:function(){var t=Kinetic.GlobalObject;var e=this.getStage();var i=e.getUserPosition();if(i){var n=this.getTransform().getTranslation();var s=this.getAbsoluteTransform().getTranslation();t.drag.node=this;t.drag.offset.x=i.x-this.getAbsoluteTransform().getTranslation().x;t.drag.offset.y=i.y-this.getAbsoluteTransform().getTranslation().y}},_dragCleanup:function(){this.off("mousedown.kinetic_initdrag");this.off("touchstart.kinetic_initdrag")},_handleEvent:function(t,e){if(this.nodeType==="Shape"){e.shape=this}var i=this.getStage();var n=i?i.mouseoverShape:null;var s=i?i.mouseoutShape:null;var a=this.eventListeners;var r=true;if(t==="mouseover"&&s&&s._id===this._id){r=false}else if(t==="mouseout"&&n&&n._id===this._id){r=false}if(a[t]&&r){var h=a[t];for(var o=0;o<h.length;o++){h[o].handler.apply(this,[e])}}var c=n?n.parent:undefined;var d=s?s.parent:undefined;if(!e.cancelBubble&&this.parent&&this.parent.nodeType!=="Stage"){this._handleEvent.call(this.parent,t,e)}}};Kinetic.GlobalObject.addSetters(Kinetic.Node,["x","y","detectionType","rotation","alpha","name","id","draggable","dragConstraint","dragBounds","listening"]);Kinetic.GlobalObject.addGetters(Kinetic.Node,["scale","x","y","detectionType","rotation","alpha","name","id","draggable","offset","dragConstraint","dragBounds","listening"]);Kinetic.Container=function(){this.children=[]};Kinetic.Container.prototype={getChildren:function(){return this.children},removeChildren:function(){while(this.children.length>0){this.remove(this.children[0])}},add:function(t){var e;t._id=Kinetic.GlobalObject.idCounter++;t.index=this.children.length;t.parent=this;this.children.push(t);var i=t.getStage();if(i===undefined){e=Kinetic.GlobalObject;e.tempNodes.push(t)}else{i._addId(t);i._addName(t);e=Kinetic.GlobalObject;e._pullNodes(i)}if(this._add!==undefined){this._add(t)}return this},remove:function(t){if(t&&t.index!==undefined&&this.children[t.index]._id==t._id){var e=this.getStage();if(e!==undefined){e._removeId(t);e._removeName(t)}var i=Kinetic.GlobalObject;for(var n=0;n<i.tempNodes.length;n++){var s=i.tempNodes[n];if(s._id===t._id){i.tempNodes.splice(n,1);break}}this.children.splice(t.index,1);this._setChildrenIndices();if(t.children){for(n=0;n<t.children.length;n++){t.remove(t.children[n])}}if(this._remove!==undefined){this._remove(t)}}return this},get:function(t){var e=this.getStage();var i;var n=t.slice(1);if(t.charAt(0)==="#"){i=e.ids[n]!==undefined?[e.ids[n]]:[]}else if(t.charAt(0)==="."){i=e.names[n]!==undefined?e.names[n]:[]}else if(t==="Shape"||t==="Group"||t==="Layer"){return this._getNodes(t)}else{return false}var s=[];for(var a=0;a<i.length;a++){var r=i[a];if(this.isAncestorOf(r)){s.push(r)}}return s},isAncestorOf:function(t){if(this.nodeType==="Stage"){return true}var e=t.getParent();while(e){if(e._id===this._id){return true}e=e.getParent()}return false},_getNodes:function(t){var e=[];function i(n){var s=n.getChildren();for(var a=0;a<s.length;a++){var r=s[a];if(r.nodeType===t){e.push(r)}else if(r.nodeType!=="Shape"){i(r)}}}i(this);return e},_drawChildren:function(){var t=this.getStage();var e=this.children;for(var i=0;i<e.length;i++){var n=e[i];if(n.nodeType==="Shape"){if(n.isVisible()&&t.isVisible()){n._draw(n.getLayer())}}else{n.draw()}}},_setChildrenIndices:function(){if(this.nodeType==="Stage"){var t=this.content.children;var e=t[0];var i=t[1];this.content.innerHTML="";this.content.appendChild(e);this.content.appendChild(i)}for(var n=0;n<this.children.length;n++){this.children[n].index=n;if(this.nodeType==="Stage"){this.content.appendChild(this.children[n].canvas)}}}};Kinetic.Stage=function(t){this.setDefaultAttrs({width:400,height:200,throttle:80});if(typeof t.container==="string"){t.container=document.getElementById(t.container)}Kinetic.Container.apply(this,[]);Kinetic.Node.apply(this,[t]);this._setStageDefaultProperties();this._id=Kinetic.GlobalObject.idCounter++;this._buildDOM();this._bindContentEvents();this.on("widthChange.kinetic",function(){this._resizeDOM()});this.on("heightChange.kinetic",function(){this._resizeDOM()});var e=Kinetic.GlobalObject;e.stages.push(this);this._addId(this);this._addName(this)};Kinetic.Stage.prototype={onFrame:function(t){var e=Kinetic.GlobalObject;this.anim={func:t}},start:function(){if(!this.animRunning){var t=Kinetic.GlobalObject;t._addAnimation(this.anim);t._handleAnimation();this.animRunning=true}},stop:function(){var t=Kinetic.GlobalObject;t._removeAnimation(this.anim);this.animRunning=false},draw:function(){this._drawChildren()},setSize:function(){var t=Kinetic.GlobalObject._getSize(Array.prototype.slice.call(arguments));this.setAttrs(t)},getSize:function(){return{width:this.attrs.width,height:this.attrs.height}},clear:function(){var t=this.children;for(var e=0;e<t.length;e++){t[e].clear()}},toDataURL:function(t,e,i){var n=this.bufferLayer;var s=n.getContext();var a=this.children;var r=this;function h(r){var o=a[r].getCanvas().toDataURL();var c=new Image;c.onload=function(){s.drawImage(this,0,0);r++;if(r<a.length){h(r)}else{try{t(n.getCanvas().toDataURL(e,i))}catch(o){t(n.getCanvas().toDataURL())}}};c.src=o}n.clear();h(0)},toJSON:function(){var t=Kinetic.GlobalObject;function e(i){var n={};var s=i.attrs;for(var a in s){var r=s[a];if(t._isFunction(r)||t._isElement(r)||t._hasMethods(r)){s[a]=undefined}}n.attrs=s;n.nodeType=i.nodeType;n.shapeType=i.shapeType;if(i.nodeType!=="Shape"){n.children=[];var h=i.getChildren();for(var o=0;o<h.length;o++){var c=h[o];n.children.push(e(c))}}return n}return window.JSON.stringify(e(this))},reset:function(){this.removeChildren();this._setStageDefaultProperties();this.setAttrs(this.defaultNodeAttrs)},load:function(t){this.reset();function e(t,i){var n=i.children;if(n!==undefined){for(var s=0;s<n.length;s++){var a=n[s];var r;if(a.nodeType==="Shape"){if(a.shapeType===undefined){r="Shape"}else{r=a.shapeType}}else{r=a.nodeType}var h=new Kinetic[r](a.attrs);t.add(h);e(h,a)}}}var i=window.JSON.parse(t);this.attrs=i.attrs;e(this,i);this.draw()},getMousePosition:function(t){return this.mousePos},getTouchPosition:function(t){return this.touchPos},getUserPosition:function(t){return this.getTouchPosition()||this.getMousePosition()},getContainer:function(){return this.attrs.container},getContent:function(){return this.content},getStage:function(){return this},getIntersections:function(){var t=Kinetic.GlobalObject._getXY(Array.prototype.slice.call(arguments));var e=[];var i=this.get("Shape");for(var n=0;n<i.length;n++){var s=i[n];if(s.intersects(t)){e.push(s)}}return e},getDOM:function(){return this.content},_resizeDOM:function(){var t=this.attrs.width;var e=this.attrs.height;this.content.style.width=t+"px";this.content.style.height=e+"px";this.bufferLayer.getCanvas().width=t;this.bufferLayer.getCanvas().height=e;this.pathLayer.getCanvas().width=t;this.pathLayer.getCanvas().height=e;var i=this.children;for(var n=0;n<i.length;n++){var s=i[n];s.getCanvas().width=t;s.getCanvas().height=e;s.draw()}},_remove:function(t){try{this.content.removeChild(t.canvas)}catch(e){}},_add:function(t){t.canvas.width=this.attrs.width;t.canvas.height=this.attrs.height;t.draw();this.content.appendChild(t.canvas);t.lastDrawTime=0},_detectEvent:function(t,e){var i=Kinetic.GlobalObject.drag.moving;var n=Kinetic.GlobalObject;var s=this.getUserPosition();var a=t.eventListeners;var r=this;if(this.targetShape&&t._id===this.targetShape._id){this.targetFound=true}if(t.isVisible()&&s!==undefined&&t.intersects(s)){if(!i&&this.mouseDown){this.mouseDown=false;this.clickStart=true;t._handleEvent("mousedown",e);return true}else if(this.mouseUp){this.mouseUp=false;t._handleEvent("mouseup",e);if(this.clickStart){if(!n.drag.moving||!n.drag.node){t._handleEvent("click",e);if(this.inDoubleClickWindow){t._handleEvent("dblclick",e)}this.inDoubleClickWindow=true;setTimeout(function(){r.inDoubleClickWindow=false},this.dblClickWindow)}}return true}else if(!i&&this.touchStart&&!this.touchMove){this.touchStart=false;this.tapStart=true;t._handleEvent("touchstart",e);return true}else if(this.touchEnd){this.touchEnd=false;t._handleEvent("touchend",e);if(this.tapStart){if(!n.drag.moving||!n.drag.node){t._handleEvent("tap",e);if(this.inDoubleClickWindow){t._handleEvent("dbltap",e)}this.inDoubleClickWindow=true;setTimeout(function(){r.inDoubleClickWindow=false},this.dblClickWindow)}}return true}else if(!i&&this.touchMove){t._handleEvent("touchmove",e);return true}else if(!i&&this._isNewTarget(t,e)){if(this.mouseoutShape){this.mouseoverShape=t;this.mouseoutShape._handleEvent("mouseout",e);this.mouseoverShape=undefined}t._handleEvent("mouseover",e);this._setTarget(t);return true}else if(!i&&this.mouseMove){t._handleEvent("mousemove",e);return true}}else if(!i&&this.targetShape&&this.targetShape._id===t._id){this._setTarget(undefined);this.mouseoutShape=t;return true}return false},_setTarget:function(t){this.targetShape=t;this.targetFound=true},_isNewTarget:function(t,e){if(!this.targetShape||!this.targetFound&&t._id!==this.targetShape._id){if(this.targetShape){var i=this.targetShape.eventListeners;if(i){this.mouseoutShape=this.targetShape}}return true}else{return false}},_traverseChildren:function(t,e){var i=t.children;var n;for(var s=i.length-1;s>=0;s--){var a=i[s];if(a.getListening()){if(a.nodeType==="Shape"){n=this._detectEvent(a,e);if(n){return true}}else{n=this._traverseChildren(a,e);if(n){return true}}}}return false},_handleStageEvent:function(t){var e=new Date;var i=e.getTime();this.lastEventTime=i;var n=Kinetic.GlobalObject;if(!t){t=window.event}this._setMousePosition(t);this._setTouchPosition(t);this.pathLayer.clear();this.targetFound=false;var s=false;for(var a=this.children.length-1;a>=0;a--){var r=this.children[a];if(r.isVisible()&&a>=0&&r.getListening()){if(this._traverseChildren(r,t)){s=true;break}}}if(!s&&this.mouseoutShape){this.mouseoutShape._handleEvent("mouseout",t);this.mouseoutShape=undefined}},_bindContentEvents:function(){var t=Kinetic.GlobalObject;var e=this;var i=["mousedown","mousemove","mouseup","mouseover","mouseout","touchstart","touchmove","touchend"];for(var n=0;n<i.length;n++){var s=i[n];(function(){var t=s;e.content.addEventListener(t,function(i){e["_"+t](i)},false)})()}},_mouseover:function(t){this._handleStageEvent(t)},_mouseout:function(t){var e=this.targetShape;if(e){e._handleEvent("mouseout",t);this.targetShape=undefined}this.mousePos=undefined;this._endDrag(t)},_mousemove:function(t){var e=this.attrs.throttle;var i=new Date;var n=i.getTime();var s=n-this.lastEventTime;var a=1e3/e;if(s>=a||e>200){this.mouseDown=false;this.mouseUp=false;this.mouseMove=true;this._handleStageEvent(t)}this._startDrag(t)},_mousedown:function(t){this.mouseDown=true;this.mouseUp=false;this.mouseMove=false;this._handleStageEvent(t);if(this.attrs.draggable){this._initDrag()}},_mouseup:function(t){this.mouseDown=false;this.mouseUp=true;this.mouseMove=false;this._handleStageEvent(t);this.clickStart=false;this._endDrag(t)},_touchstart:function(t){t.preventDefault();this.touchStart=true;this.touchEnd=false;this.touchMove=false;this._handleStageEvent(t);if(this.attrs.draggable){this._initDrag()}},_touchend:function(t){this.touchStart=false;this.touchEnd=true;this.touchMove=false;this._handleStageEvent(t);this.tapStart=false;this._endDrag(t)},_touchmove:function(t){var e=this;var i=this.attrs.throttle;var n=new Date;var s=n.getTime();var a=s-this.lastEventTime;var r=1e3/i;if(a>=r||i>200){t.preventDefault();e.touchEnd=false;e.touchMove=true;e._handleStageEvent(t)}this._startDrag(t)},_setMousePosition:function(t){var e=t.offsetX||t.clientX-this._getContentPosition().left+window.pageXOffset;var i=t.offsetY||t.clientY-this._getContentPosition().top+window.pageYOffset;this.mousePos={x:e,y:i}},_setTouchPosition:function(t){if(t.touches!==undefined&&t.touches.length===1){var e=t.touches[0];var i=e.clientX-this._getContentPosition().left+window.pageXOffset;var n=e.clientY-this._getContentPosition().top+window.pageYOffset;this.touchPos={x:i,y:n}}},_getContentPosition:function(){var t=this.content;var e=0;var i=0;while(t&&t.tagName!=="BODY"){e+=t.offsetTop-t.scrollTop;i+=t.offsetLeft-t.scrollLeft;t=t.offsetParent}return{top:e,left:i}},_modifyPathContext:function(t){t.stroke=function(){};t.fill=function(){};t.fillRect=function(e,i,n,s){t.rect(e,i,n,s)};t.strokeRect=function(e,i,n,s){t.rect(e,i,n,s)};t.drawImage=function(){};t.fillText=function(){};t.strokeText=function(){}},_endDrag:function(t){var e=Kinetic.GlobalObject;if(e.drag.node){if(e.drag.moving){e.drag.moving=false;e.drag.node._handleEvent("dragend",t)}}e.drag.node=undefined},_startDrag:function(t){var e=this;var i=Kinetic.GlobalObject;var n=i.drag.node;if(n){var s=e.getUserPosition();var a=n.attrs.dragConstraint;var r=n.attrs.dragBounds;var h={x:n.attrs.x,y:n.attrs.y};var o={x:s.x-i.drag.offset.x,y:s.y-i.drag.offset.y};if(r.left!==undefined&&o.x<r.left){o.x=r.left}if(r.right!==undefined&&o.x>r.right){o.x=r.right}if(r.top!==undefined&&o.y<r.top){o.y=r.top}if(r.bottom!==undefined&&o.y>r.bottom){o.y=r.bottom}n.setAbsolutePosition(o);if(a==="horizontal"){n.attrs.y=h.y}else if(a==="vertical"){n.attrs.x=h.x}if(i.drag.node.nodeType==="Stage"){i.drag.node.draw()}else{i.drag.node.getLayer().draw()}if(!i.drag.moving){i.drag.moving=true;i.drag.node._handleEvent("dragstart",t)}i.drag.node._handleEvent("dragmove",t)}},_buildDOM:function(){this.content=document.createElement("div");this.content.style.position="relative";this.content.style.display="inline-block";this.content.className="kineticjs-content";this.attrs.container.appendChild(this.content);this.bufferLayer=new Kinetic.Layer({name:"bufferLayer"});this.pathLayer=new Kinetic.Layer({name:"pathLayer"});this.bufferLayer.parent=this;this.pathLayer.parent=this;this._modifyPathContext(this.pathLayer.context);this.bufferLayer.getCanvas().style.display="none";this.pathLayer.getCanvas().style.display="none";this.bufferLayer.canvas.className="kineticjs-buffer-layer";this.content.appendChild(this.bufferLayer.canvas);this.pathLayer.canvas.className="kineticjs-path-layer";this.content.appendChild(this.pathLayer.canvas);this.setSize(this.attrs.width,this.attrs.height);this._resizeDOM()},_addId:function(t){if(t.attrs.id!==undefined){this.ids[t.attrs.id]=t}},_removeId:function(t){if(t.attrs.id!==undefined){this.ids[t.attrs.id]=undefined}},_addName:function(t){var e=t.attrs.name;if(e!==undefined){if(this.names[e]===undefined){this.names[e]=[]}this.names[e].push(t)}},_removeName:function(t){if(t.attrs.name!==undefined){var e=this.names[t.attrs.name];if(e!==undefined){for(var i=0;i<e.length;i++){var n=e[i];if(n._id===t._id){e.splice(i,1)}}if(e.length===0){delete this.names[t.attrs.name]}}}},_onContent:function(t,e){var i=t.split(" ");for(var n=0;n<i.length;n++){var s=i[n];this.content.addEventListener(s,e,false)}},_setStageDefaultProperties:function(){this.nodeType="Stage";this.lastEventTime=0;this.dblClickWindow=400;this.targetShape=undefined;this.targetFound=false;this.mouseoverShape=undefined;this.mouseoutShape=undefined;this.mousePos=undefined;this.mouseDown=false;this.mouseUp=false;this.mouseMove=false;this.clickStart=false;this.touchPos=undefined;this.touchStart=false;this.touchEnd=false;this.touchMove=false;this.tapStart=false;this.ids={};this.names={};this.anim=undefined;this.animRunning=false}};Kinetic.GlobalObject.extend(Kinetic.Stage,Kinetic.Container);Kinetic.GlobalObject.extend(Kinetic.Stage,Kinetic.Node);Kinetic.GlobalObject.addSetters(Kinetic.Stage,["width","height","throttle"]);Kinetic.GlobalObject.addGetters(Kinetic.Stage,["width","height","throttle"]);Kinetic.Layer=function(t){this.setDefaultAttrs({throttle:80});this.nodeType="Layer";this.lastDrawTime=0;this.beforeDrawFunc=undefined;this.afterDrawFunc=undefined;this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.canvas.style.position="absolute";Kinetic.Container.apply(this,[]);Kinetic.Node.apply(this,[t])};Kinetic.Layer.prototype={draw:function(){var t=this.attrs.throttle;var e=new Date;var i=e.getTime();var n=i-this.lastDrawTime;var s=1e3/t;if(n>=s||t>200){this._draw();if(this.drawTimeout!==undefined){clearTimeout(this.drawTimeout);this.drawTimeout=undefined}}else if(this.drawTimeout===undefined){var a=this;this.drawTimeout=setTimeout(function(){a.draw()},17)}},setThrottle:function(t){this.attrs.throttle=t},getThrottle:function(){return this.attrs.throttle},beforeDraw:function(t){this.beforeDrawFunc=t},afterDraw:function(t){this.afterDrawFunc=t},clear:function(){var t=this.getContext();var e=this.getCanvas();t.clearRect(0,0,e.width,e.height)},getCanvas:function(){return this.canvas},getContext:function(){return this.context},_draw:function(){var t=new Date;var e=t.getTime();this.lastDrawTime=e;if(this.beforeDrawFunc!==undefined){this.beforeDrawFunc.call(this)}this.clear();if(this.isVisible()){if(this.attrs.drawFunc!==undefined){this.attrs.drawFunc.call(this)}this._drawChildren()}if(this.afterDrawFunc!==undefined){this.afterDrawFunc.call(this)}}};Kinetic.GlobalObject.extend(Kinetic.Layer,Kinetic.Container);Kinetic.GlobalObject.extend(Kinetic.Layer,Kinetic.Node);Kinetic.Group=function(t){this.nodeType="Group";Kinetic.Container.apply(this,[]);Kinetic.Node.apply(this,[t])};Kinetic.Group.prototype={draw:function(){if(this.attrs.visible){this._drawChildren()}}};Kinetic.GlobalObject.extend(Kinetic.Group,Kinetic.Container);Kinetic.GlobalObject.extend(Kinetic.Group,Kinetic.Node);Kinetic.Shape=function(t){this.setDefaultAttrs({fill:undefined,stroke:undefined,strokeWidth:undefined,lineJoin:undefined,detectionType:"path",shadow:{blur:10,alpha:1,offset:{x:0,y:0}}});this.data=[];this.nodeType="Shape";this.appliedShadow=false;Kinetic.Node.apply(this,[t])};Kinetic.Shape.prototype={getContext:function(){if(this.tempLayer===undefined){return null}else{return this.tempLayer.getContext()}},getCanvas:function(){return this.tempLayer.getCanvas()},stroke:function(){var t=false;var e=this.getContext();e.save();if(!!this.attrs.stroke||!!this.attrs.strokeWidth){if(!this.appliedShadow){t=this._applyShadow()}var i=!!this.attrs.stroke?this.attrs.stroke:"black";var n=!!this.attrs.strokeWidth?this.attrs.strokeWidth:2;e.lineWidth=n;e.strokeStyle=i;e.stroke()}e.restore();if(t){this.stroke()}},fill:function(){var t=false;var e=this.getContext();e.save();var i=this.attrs.fill;var n,s,a;if(!!i){if(!this.appliedShadow){t=this._applyShadow()}var r=i.start;var h=i.end;var o=null;if(typeof i=="string"){o=this.attrs.fill;e.fillStyle=o;e.fill()}else if(i.image!==undefined){var c=i.repeat===undefined?"repeat":i.repeat;o=e.createPattern(i.image,c);e.save();if(i.scale!==undefined){e.scale(i.scale.x,i.scale.y)}if(i.offset!==undefined){e.translate(i.offset.x,i.offset.y)}e.fillStyle=o;e.fill();e.restore()}else if(r.radius===undefined&&h.radius===undefined){e=this.getContext();n=e.createLinearGradient(r.x,r.y,h.x,h.y);s=i.colorStops;for(a=0;a<s.length;a+=2){n.addColorStop(s[a],s[a+1])}o=n;e.fillStyle=o;e.fill()}else if(r.radius!==undefined&&h.radius!==undefined){e=this.getContext();n=e.createRadialGradient(r.x,r.y,r.radius,h.x,h.y,h.radius);s=i.colorStops;for(a=0;a<s.length;a+=2){n.addColorStop(s[a],s[a+1])}o=n;e.fillStyle=o;e.fill()}else{o="black";e.fillStyle=o;e.fill()}}e.restore();if(t){this.fill()}},fillText:function(t,e,i){var n=false;var s=this.getContext();s.save();if(this.attrs.textFill!==undefined){if(!this.appliedShadow){n=this._applyShadow()}s.fillStyle=this.attrs.textFill;s.fillText(t,e,i)}s.restore();if(n){this.fillText(t,e,i)}},strokeText:function(t,e,i){var n=false;var s=this.getContext();s.save();if(this.attrs.textStroke!==undefined||this.attrs.textStrokeWidth!==undefined){if(!this.appliedShadow){n=this._applyShadow()}if(this.attrs.textStroke===undefined){this.attrs.textStroke="black"}else if(this.attrs.textStrokeWidth===undefined){this.attrs.textStrokeWidth=2}s.lineWidth=this.attrs.textStrokeWidth;s.strokeStyle=this.attrs.textStroke;s.strokeText(t,e,i)}s.restore();if(n){this.strokeText(t,e,i)}},drawImage:function(){var t=false;var e=this.getContext();e.save();var i=Array.prototype.slice.call(arguments);if(i.length===5||i.length===9){if(!this.appliedShadow){t=this._applyShadow()}switch(i.length){case 5:e.drawImage(i[0],i[1],i[2],i[3],i[4]);break;case 9:e.drawImage(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8]);break}}e.restore();if(t){this.drawImage.apply(this,i)}},applyLineJoin:function(){var t=this.getContext();if(this.attrs.lineJoin!==undefined){t.lineJoin=this.attrs.lineJoin}},_applyShadow:function(){var t=this.getContext();var e=this.attrs.shadow;if(e!==undefined){var i=this.getAbsoluteAlpha();var n=this.attrs.shadow.alpha;if(n!==undefined&&e.color!==undefined){t.globalAlpha=n*i;t.shadowColor=e.color;t.shadowBlur=e.blur;t.shadowOffsetX=e.offset.x;t.shadowOffsetY=e.offset.y;this.appliedShadow=true;return true}}return false},saveData:function(){var t=this.getStage();var e=t.attrs.width;var i=t.attrs.height;var n=t.bufferLayer;var s=n.getContext();n.clear();this._draw(n);var a=s.getImageData(0,0,e,i);this.data=a.data},clearData:function(){this.data=[]},intersects:function(){var t=Kinetic.GlobalObject._getXY(Array.prototype.slice.call(arguments));var e=this.getStage();if(this.attrs.detectionType==="path"){var i=e.pathLayer;
var n=i.getContext();this._draw(i);return n.isPointInPath(t.x,t.y)}else{var s=e.attrs.width;var a=this.data[(s*t.y+t.x)*4+3];return a!==undefined&&a!==0}},_draw:function(t){if(t!==undefined&&this.attrs.drawFunc!==undefined){var e=t.getStage();var i=t.getContext();var n=[];var s=this.parent;n.unshift(this);while(s){n.unshift(s);s=s.parent}i.save();for(var a=0;a<n.length;a++){var r=n[a];var h=r.getTransform();if(r.attrs.offset.x!==0||r.attrs.offset.y!==0){h.translate(-1*r.attrs.offset.x,-1*r.attrs.offset.y)}var o=h.getMatrix();i.transform(o[0],o[1],o[2],o[3],o[4],o[5])}this.tempLayer=t;if(this.getAbsoluteAlpha()!==1){i.globalAlpha=this.getAbsoluteAlpha()}this.applyLineJoin();this.appliedShadow=false;this.attrs.drawFunc.call(this);i.restore()}}};Kinetic.GlobalObject.extend(Kinetic.Shape,Kinetic.Node);Kinetic.GlobalObject.addSetters(Kinetic.Shape,["fill","stroke","lineJoin","strokeWidth","shadow","drawFunc"]);Kinetic.GlobalObject.addGetters(Kinetic.Shape,["fill","stroke","lineJoin","strokeWidth","shadow","drawFunc"]);Kinetic.Rect=function(t){this.setDefaultAttrs({width:0,height:0,cornerRadius:0});this.shapeType="Rect";t.drawFunc=function(){var t=this.getContext();t.beginPath();if(this.attrs.cornerRadius===0){t.rect(0,0,this.attrs.width,this.attrs.height)}else{t.moveTo(this.attrs.cornerRadius,0);t.lineTo(this.attrs.width-this.attrs.cornerRadius,0);t.arc(this.attrs.width-this.attrs.cornerRadius,this.attrs.cornerRadius,this.attrs.cornerRadius,Math.PI*3/2,0,false);t.lineTo(this.attrs.width,this.attrs.height-this.attrs.cornerRadius);t.arc(this.attrs.width-this.attrs.cornerRadius,this.attrs.height-this.attrs.cornerRadius,this.attrs.cornerRadius,0,Math.PI/2,false);t.lineTo(this.attrs.cornerRadius,this.attrs.height);t.arc(this.attrs.cornerRadius,this.attrs.height-this.attrs.cornerRadius,this.attrs.cornerRadius,Math.PI/2,Math.PI,false);t.lineTo(0,this.attrs.cornerRadius);t.arc(this.attrs.cornerRadius,this.attrs.cornerRadius,this.attrs.cornerRadius,Math.PI,Math.PI*3/2,false)}t.closePath();this.fill();this.stroke()};Kinetic.Shape.apply(this,[t])};Kinetic.Rect.prototype={setSize:function(){var t=Kinetic.GlobalObject._getSize(Array.prototype.slice.call(arguments));this.setAttrs(t)},getSize:function(){return{width:this.attrs.width,height:this.attrs.height}}};Kinetic.GlobalObject.extend(Kinetic.Rect,Kinetic.Shape);Kinetic.GlobalObject.addSetters(Kinetic.Rect,["width","height","cornerRadius"]);Kinetic.GlobalObject.addGetters(Kinetic.Rect,["width","height","cornerRadius"]);Kinetic.Ellipse=function(t){this.setDefaultAttrs({radius:{x:0,y:0}});this.shapeType="Ellipse";t.drawFunc=function(){var t=this.getCanvas();var e=this.getContext();var i=this.getRadius();e.beginPath();e.save();if(i.x!==i.y){e.scale(1,i.y/i.x)}e.arc(0,0,i.x,0,Math.PI*2,true);e.restore();e.closePath();this.fill();this.stroke()};Kinetic.Shape.apply(this,[t]);this._convertRadius();var e=this;this.on("radiusChange",function(){e._convertRadius()})};Kinetic.Circle=Kinetic.Ellipse;Kinetic.Ellipse.prototype={setRadius:function(){this.setAttrs({radius:Array.prototype.slice.call(arguments)})},_convertRadius:function(){var t=Kinetic.GlobalObject;var e=this.getRadius();if(t._isObject(e)){return false}var i=t._getXY(e);this.setAttrs({radius:i})}};Kinetic.GlobalObject.extend(Kinetic.Ellipse,Kinetic.Shape);Kinetic.GlobalObject.addGetters(Kinetic.Ellipse,["radius"]);Kinetic.Image=function(t){this.setDefaultAttrs({crop:{x:0,y:0,width:undefined,height:undefined}});this.shapeType="Image";t.drawFunc=function(){if(this.attrs.image!==undefined){var t=this.attrs.width!==undefined?this.attrs.width:this.attrs.image.width;var e=this.attrs.height!==undefined?this.attrs.height:this.attrs.image.height;var i=this.attrs.crop.x;var n=this.attrs.crop.y;var s=this.attrs.crop.width;var a=this.attrs.crop.height;var r=this.getCanvas();var h=this.getContext();h.beginPath();h.rect(0,0,t,e);h.closePath();this.fill();this.stroke();if(s!==undefined&&a!==undefined){this.drawImage(this.attrs.image,i,n,s,a,0,0,t,e)}else{this.drawImage(this.attrs.image,0,0,t,e)}}};Kinetic.Shape.apply(this,[t])};Kinetic.Image.prototype={setSize:function(){var t=Kinetic.GlobalObject._getSize(Array.prototype.slice.call(arguments));this.setAttrs(t)},getSize:function(){return{width:this.attrs.width,height:this.attrs.height}},setCrop:function(){this.setAttrs({crop:Array.prototype.slice.call(arguments)})}};Kinetic.GlobalObject.extend(Kinetic.Image,Kinetic.Shape);Kinetic.GlobalObject.addSetters(Kinetic.Image,["height","width","image"]);Kinetic.GlobalObject.addGetters(Kinetic.Image,["crop","height","width","image"]);Kinetic.Sprite=function(t){this.setDefaultAttrs({index:0,frameRate:17});t.drawFunc=function(){if(this.attrs.image!==undefined){var t=this.getContext();var e=this.attrs.animation;var i=this.attrs.index;var n=this.attrs.animations[e][i];t.beginPath();t.rect(0,0,n.width,n.height);t.closePath();this.drawImage(this.attrs.image,n.x,n.y,n.width,n.height,0,0,n.width,n.height)}};Kinetic.Shape.apply(this,[t]);var e=this;this.on("animationChange",function(){e.setIndex(0)})};Kinetic.Sprite.prototype={start:function(){var t=this;var e=this.getLayer();this.interval=setInterval(function(){t._updateIndex();e.draw();if(t.afterFrameFunc&&t.attrs.index===t.afterFrameIndex){t.afterFrameFunc()}},1e3/this.attrs.frameRate)},stop:function(){clearInterval(this.interval)},afterFrame:function(t,e){this.afterFrameIndex=t;this.afterFrameFunc=e},_updateIndex:function(){var t=this.attrs.index;var e=this.attrs.animation;if(t<this.attrs.animations[e].length-1){this.attrs.index++}else{this.attrs.index=0}}};Kinetic.GlobalObject.extend(Kinetic.Sprite,Kinetic.Shape);Kinetic.GlobalObject.addSetters(Kinetic.Sprite,["animation","animations","index"]);Kinetic.GlobalObject.addGetters(Kinetic.Sprite,["animation","animations","index"]);Kinetic.Polygon=function(t){this.setDefaultAttrs({points:[]});this.shapeType="Polygon";t.drawFunc=function(){var t=this.getContext();t.beginPath();t.moveTo(this.attrs.points[0].x,this.attrs.points[0].y);for(var e=1;e<this.attrs.points.length;e++){t.lineTo(this.attrs.points[e].x,this.attrs.points[e].y)}t.closePath();this.fill();this.stroke()};Kinetic.Shape.apply(this,[t])};Kinetic.GlobalObject.extend(Kinetic.Polygon,Kinetic.Shape);Kinetic.GlobalObject.addSetters(Kinetic.Polygon,["points"]);Kinetic.GlobalObject.addGetters(Kinetic.Polygon,["points"]);Kinetic.RegularPolygon=function(t){this.setDefaultAttrs({radius:0,sides:0});this.shapeType="RegularPolygon";t.drawFunc=function(){var t=this.getContext();t.beginPath();t.moveTo(0,0-this.attrs.radius);for(var e=1;e<this.attrs.sides;e++){var i=this.attrs.radius*Math.sin(e*2*Math.PI/this.attrs.sides);var n=-1*this.attrs.radius*Math.cos(e*2*Math.PI/this.attrs.sides);t.lineTo(i,n)}t.closePath();this.fill();this.stroke()};Kinetic.Shape.apply(this,[t])};Kinetic.GlobalObject.extend(Kinetic.RegularPolygon,Kinetic.Shape);Kinetic.GlobalObject.addSetters(Kinetic.Rect,["radius","sides"]);Kinetic.GlobalObject.addGetters(Kinetic.Rect,["radius","sides"]);Kinetic.Star=function(t){this.setDefaultAttrs({numPoints:0,innerRadius:0,outerRadius:0});this.shapeType="Star";t.drawFunc=function(){var t=this.getContext();t.beginPath();t.moveTo(0,0-this.attrs.outerRadius);for(var e=1;e<this.attrs.numPoints*2;e++){var i=e%2===0?this.attrs.outerRadius:this.attrs.innerRadius;var n=i*Math.sin(e*Math.PI/this.attrs.numPoints);var s=-1*i*Math.cos(e*Math.PI/this.attrs.numPoints);t.lineTo(n,s)}t.closePath();this.fill();this.stroke()};Kinetic.Shape.apply(this,[t])};Kinetic.GlobalObject.extend(Kinetic.Star,Kinetic.Shape);Kinetic.GlobalObject.addSetters(Kinetic.Star,["numPoints","innerRadius","outerRadius"]);Kinetic.GlobalObject.addGetters(Kinetic.Star,["numPoints","innerRadius","outerRadius"]);Kinetic.Text=function(t){this.setDefaultAttrs({fontFamily:"Calibri",text:"",fontSize:12,align:"left",verticalAlign:"top",padding:0,fontStyle:"normal",width:"auto",detectionType:"pixel"});this.shapeType="Text";t.drawFunc=function(){var t=this.getContext();t.font=this.attrs.fontStyle+" "+this.attrs.fontSize+"pt "+this.attrs.fontFamily;t.textBaseline="middle";var e=this.getTextHeight();var i=this.attrs.width==="auto"?this.getTextWidth():this.attrs.width;var n=this.attrs.padding;var s=0;var a=0;var r=this;switch(this.attrs.align){case"center":s=i/-2-n;break;case"right":s=-1*i-n;break}switch(this.attrs.verticalAlign){case"middle":a=e/-2-n;break;case"bottom":a=-1*e-n;break}t.save();t.beginPath();t.rect(s,a,i+n*2,e+n*2);t.closePath();this.fill();this.stroke();t.restore();var h=n+s;var o=e/2+n+a;t.save();if(this.attrs.width!=="auto"){t.beginPath();t.rect(s,a,i+n,e+n*2);t.closePath();t.clip()}this.fillText(this.attrs.text,h,o);this.strokeText(this.attrs.text,h,o);t.restore()};Kinetic.Shape.apply(this,[t])};Kinetic.Text.prototype={getTextWidth:function(){return this.getTextSize().width},getTextHeight:function(){return this.getTextSize().height},getTextSize:function(){var t=this.getContext();if(!t){var e=document.createElement("canvas");t=e.getContext("2d")}t.save();t.font=this.attrs.fontStyle+" "+this.attrs.fontSize+"pt "+this.attrs.fontFamily;var i=t.measureText(this.attrs.text);t.restore();return{width:i.width,height:parseInt(this.attrs.fontSize,10)}}};Kinetic.GlobalObject.extend(Kinetic.Text,Kinetic.Shape);Kinetic.GlobalObject.addSetters(Kinetic.Text,["fontFamily","fontSize","fontStyle","textFill","textStroke","textStrokeWidth","padding","align","verticalAlign","text","width"]);Kinetic.GlobalObject.addGetters(Kinetic.Text,["fontFamily","fontSize","fontStyle","textFill","textStroke","textStrokeWidth","padding","align","verticalAlign","text","width"]);Kinetic.Line=function(t){this.setDefaultAttrs({points:[],lineCap:"butt",dashArray:[],detectionType:"pixel"});this.shapeType="Line";t.drawFunc=function(){var t=this.getContext();var e={};t.beginPath();t.moveTo(this.attrs.points[0].x,this.attrs.points[0].y);for(var i=1;i<this.attrs.points.length;i++){var n=this.attrs.points[i].x;var s=this.attrs.points[i].y;if(this.attrs.dashArray.length>0){var a=this.attrs.points[i-1].x;var r=this.attrs.points[i-1].y;this._dashedLine(a,r,n,s,this.attrs.dashArray)}else{t.lineTo(n,s)}}if(!!this.attrs.lineCap){t.lineCap=this.attrs.lineCap}this.stroke()};Kinetic.Shape.apply(this,[t])};Kinetic.Line.prototype={setPoints:function(t){this.setAttrs({points:t})},_dashedLine:function(t,e,i,n,s){var a=this.getContext();var r=s.length;var h=i-t,o=n-e;var c=h>o;var d=c?o/h:h/o;if(d>9999){d=9999}else if(d<-9999){d=-9999}var f=Math.sqrt(h*h+o*o);var l=0,u=true;while(f>=.1&&l<1e4){var g=s[l++%r];if(g===0){g=.001}if(g>f){g=f}var v=Math.sqrt(g*g/(1+d*d));if(c){t+=h<0&&o<0?v*-1:v;e+=h<0&&o<0?d*v*-1:d*v}else{t+=h<0&&o<0?d*v*-1:d*v;e+=h<0&&o<0?v*-1:v}a[u?"lineTo":"moveTo"](t,e);f-=g;u=!u}a.moveTo(i,n)}};Kinetic.GlobalObject.extend(Kinetic.Line,Kinetic.Shape);Kinetic.GlobalObject.addSetters(Kinetic.Line,["dashArray","lineCap"]);Kinetic.GlobalObject.addGetters(Kinetic.Line,["dashArray","lineCap","points"]);Kinetic.Path=function(t){this.shapeType="Path";this.dataArray=[];var e=this;t.drawFunc=function(){var t=this.getContext();var e=this.dataArray;t.beginPath();for(var i=0;i<e.length;i++){var n=e[i].command;var s=e[i].points;switch(n){case"L":t.lineTo(s[0],s[1]);break;case"M":t.moveTo(s[0],s[1]);break;case"C":t.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case"Q":t.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case"A":var a=s[0],r=s[1],h=s[2],o=s[3],c=s[4],d=s[5],f=s[6],l=s[7];var u=h>o?h:o;var g=h>o?1:h/o;var v=h>o?o/h:1;t.translate(a,r);t.rotate(f);t.scale(g,v);t.arc(0,0,u,c,c+d,1-l);t.scale(1/g,1/v);t.rotate(-f);t.translate(-a,-r);break;case"z":t.closePath();break}}this.fill();this.stroke()};Kinetic.Shape.apply(this,[t]);this.dataArray=this.getDataArray();this.on("dataChange",function(){e.dataArray=e.getDataArray()})};Kinetic.Path.prototype={getDataArray:function(){var t=this.attrs.data;if(!this.attrs.data){return[]}var e=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];t=t.replace(new RegExp(" ","g"),",");for(var i=0;i<e.length;i++){t=t.replace(new RegExp(e[i],"g"),"|"+e[i])}var n=t.split("|");var s=[];var a=0;var r=0;for(i=1;i<n.length;i++){var h=n[i];var o=h.charAt(0);h=h.slice(1);h=h.replace(new RegExp(",-","g"),"-");h=h.replace(new RegExp("-","g"),",-");var c=h.split(",");if(c.length>0&&c[0]===""){c.shift()}for(var d=0;d<c.length;d++){c[d]=parseFloat(c[d])}var f,l,u,g,v;var p,m,b,y,_,w,x;while(c.length>0){if(isNaN(c[0]))break;v=[];switch(o){case"l":a+=c.shift();r+=c.shift();g="L";v.push(a,r);break;case"L":a=c.shift();r=c.shift();v.push(a,r);break;case"m":a+=c.shift();r+=c.shift();g="M";v.push(a,r);o="l";break;case"M":a=c.shift();r=c.shift();g="M";v.push(a,r);o="L";break;case"h":a+=c.shift();g="L";v.push(a,r);break;case"H":a=c.shift();g="L";v.push(a,r);break;case"v":r+=c.shift();g="L";v.push(a,r);break;case"V":r=c.shift();g="L";v.push(a,r);break;case"C":v.push(c.shift(),c.shift(),c.shift(),c.shift());a=c.shift();r=c.shift();v.push(a,r);break;case"c":v.push(a+c.shift(),r+c.shift(),a+c.shift(),r+c.shift());a+=c.shift();r+=c.shift();g="C";v.push(a,r);break;case"S":f=a,l=r;u=s[s.length-1];if(u.command==="C"){f=a+(a-u.points[2]);l=r+(r-u.points[3])}v.push(f,l,c.shift(),c.shift());a=c.shift();r=c.shift();g="C";v.push(a,r);break;case"s":f=a;l=r;u=s[s.length-1];if(u.command==="C"){f=a+(a-u.points[2]);l=r+(r-u.points[3])}v.push(f,l,a+c.shift(),r+c.shift());a+=c.shift();r+=c.shift();g="C";v.push(a,r);break;case"Q":v.push(c.shift(),c.shift());a=c.shift();r=c.shift();v.push(a,r);break;case"q":v.push(a+c.shift(),r+c.shift());a+=c.shift();r+=c.shift();g="Q";v.push(a,r);break;case"T":f=a;l=r;u=s[s.length-1];if(u.command==="Q"){f=a+(a-u.points[0]);l=r+(r-u.points[1])}a=c.shift();r=c.shift();g="Q";v.push(f,l,a,r);break;case"t":f=a;l=r;u=s[s.length-1];if(u.command==="Q"){f=a+(a-u.points[0]);l=r+(r-u.points[1])}a+=c.shift();r+=c.shift();g="Q";v.push(f,l,a,r);break;case"A":p=c.shift();m=c.shift();b=c.shift();y=c.shift();_=c.shift();w=a;x=r;a=c.shift(),r=c.shift();g="A";v=this._convertEndpointToCenterParameterization(w,x,a,r,y,_,p,m,b);break;case"a":p=c.shift();m=c.shift();b=c.shift();y=c.shift();_=c.shift();w=a;x=r;a+=c.shift(),r+=c.shift();g="A";v=this._convertEndpointToCenterParameterization(w,x,a,r,y,_,p,m,b);break}s.push({command:g||o,points:v})}if(o==="z"||o==="Z")s.push({command:"z",points:[]})}return s},_convertEndpointToCenterParameterization:function(t,e,i,n,s,a,r,h,o){var c=o*(Math.PI/180);var d=Math.cos(c)*(t-i)/2+Math.sin(c)*(e-n)/2;var f=-1*Math.sin(c)*(t-i)/2+Math.cos(c)*(e-n)/2;var l=d*d/(r*r)+f*f/(h*h);if(l>1){r*=Math.sqrt(l);h*=Math.sqrt(l)}var u=Math.sqrt((r*r*(h*h)-r*r*(f*f)-h*h*(d*d))/(r*r*(f*f)+h*h*(d*d)));if(s==a)u*=-1;if(isNaN(u))u=0;var g=u*r*f/h;var v=u*-h*d/r;var p=(t+i)/2+Math.cos(c)*g-Math.sin(c)*v;var m=(e+n)/2+Math.sin(c)*g+Math.cos(c)*v;var b=function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])};var y=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(b(t)*b(e))};var _=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(y(t,e))};var w=_([1,0],[(d-g)/r,(f-v)/h]);var x=[(d-g)/r,(f-v)/h];var S=[(-1*d-g)/r,(-1*f-v)/h];var K=_(x,S);if(y(x,S)<=-1)K=Math.PI;if(y(x,S)>=1)K=0;if(a===0&&K>0)K=K-2*Math.PI;if(a==1&&K<0)K=K+2*Math.PI;return[p,m,r,h,w,K,c,a]}};Kinetic.GlobalObject.extend(Kinetic.Path,Kinetic.Shape);Kinetic.GlobalObject.addSetters(Kinetic.Path,["data"]);Kinetic.GlobalObject.addGetters(Kinetic.Path,["data"]);Kinetic.Transform=function(){this.m=[1,0,0,1,0,0]};Kinetic.Transform.prototype={translate:function(t,e){this.m[4]+=this.m[0]*t+this.m[2]*e;this.m[5]+=this.m[1]*t+this.m[3]*e},scale:function(t,e){this.m[0]*=t;this.m[1]*=t;this.m[2]*=e;this.m[3]*=e},rotate:function(t){var e=Math.cos(t);var i=Math.sin(t);var n=this.m[0]*e+this.m[2]*i;var s=this.m[1]*e+this.m[3]*i;var a=this.m[0]*-i+this.m[2]*e;var r=this.m[1]*-i+this.m[3]*e;this.m[0]=n;this.m[1]=s;this.m[2]=a;this.m[3]=r},getTranslation:function(){return{x:this.m[4],y:this.m[5]}},multiply:function(t){var e=this.m[0]*t.m[0]+this.m[2]*t.m[1];var i=this.m[1]*t.m[0]+this.m[3]*t.m[1];var n=this.m[0]*t.m[2]+this.m[2]*t.m[3];var s=this.m[1]*t.m[2]+this.m[3]*t.m[3];var a=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4];var r=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];this.m[0]=e;this.m[1]=i;this.m[2]=n;this.m[3]=s;this.m[4]=a;this.m[5]=r},invert:function(){var t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]);var e=this.m[3]*t;var i=-this.m[1]*t;var n=-this.m[2]*t;var s=this.m[0]*t;var a=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]);var r=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=e;this.m[1]=i;this.m[2]=n;this.m[3]=s;this.m[4]=a;this.m[5]=r},getMatrix:function(){return this.m}};Kinetic.Transition=function(t,e){this.node=t;this.config=e;this.tweens=[];var i=this;function n(t,e){for(var s in t){if(s!=="duration"&&s!=="easing"&&s!=="callback"){if(Kinetic.GlobalObject._isObject(t[s])){n(t[s],e[s])}else{i._add(i._getTween(e,s,t[s]))}}}}n(e,t.attrs);var s=0;for(var a=0;a<this.tweens.length;a++){var r=this.tweens[a];r.onFinished=function(){s++;if(s>=i.tweens.length){i.onFinished()}}}};Kinetic.Transition.prototype={start:function(){for(var t=0;t<this.tweens.length;t++){this.tweens[t].start()}},stop:function(){for(var t=0;t<this.tweens.length;t++){this.tweens[t].stop()}},resume:function(){for(var t=0;t<this.tweens.length;t++){this.tweens[t].resume()}},_onEnterFrame:function(){for(var t=0;t<this.tweens.length;t++){this.tweens[t].onEnterFrame()}},_add:function(t){this.tweens.push(t)},_getTween:function(t,e,i){var n=this.config;var s=this.node;var a=n.easing;if(a===undefined){a="linear"}var r=new Kinetic.Tween(s,function(i){t[e]=i},Kinetic.Tweens[a],t[e],i,n.duration);return r}};Kinetic.Tween=function(t,e,i,n,s,a){this._listeners=[];this.addListener(this);this.obj=t;this.propFunc=e;this.begin=n;this._pos=n;this.setDuration(a);this.isPlaying=false;this._change=0;this.prevTime=0;this.prevPos=0;this.looping=false;this._time=0;this._position=0;this._startTime=0;this._finish=0;this.name="";this.func=i;this.setFinish(s)};Kinetic.Tween.prototype={setTime:function(t){this.prevTime=this._time;if(t>this.getDuration()){if(this.looping){this.rewind(t-this._duration);this.update();this.broadcastMessage("onLooped",{target:this,type:"onLooped"})}else{this._time=this._duration;this.update();this.stop();this.broadcastMessage("onFinished",{target:this,type:"onFinished"})}}else if(t<0){this.rewind();this.update()}else{this._time=t;this.update()}},getTime:function(){return this._time},setDuration:function(t){this._duration=t===null||t<=0?1e5:t},getDuration:function(){return this._duration},setPosition:function(t){this.prevPos=this._pos;this.propFunc(t);this._pos=t;this.broadcastMessage("onChanged",{target:this,type:"onChanged"})},getPosition:function(t){if(t===undefined){t=this._time}return this.func(t,this.begin,this._change,this._duration)},setFinish:function(t){this._change=t-this.begin},getFinish:function(){return this.begin+this._change},start:function(){this.rewind();this.startEnterFrame();this.broadcastMessage("onStarted",{target:this,type:"onStarted"})},rewind:function(t){this.stop();this._time=t===undefined?0:t;this.fixTime();this.update()},fforward:function(){this._time=this._duration;this.fixTime();this.update()},update:function(){this.setPosition(this.getPosition(this._time))},startEnterFrame:function(){this.stopEnterFrame();this.isPlaying=true;this.onEnterFrame()},onEnterFrame:function(){if(this.isPlaying){this.nextFrame()}},nextFrame:function(){this.setTime((this.getTimer()-this._startTime)/1e3)},stop:function(){this.stopEnterFrame();this.broadcastMessage("onStopped",{target:this,type:"onStopped"})},stopEnterFrame:function(){this.isPlaying=false},continueTo:function(t,e){this.begin=this._pos;this.setFinish(t);if(this._duration!==undefined){this.setDuration(e)}this.start()},resume:function(){this.fixTime();this.startEnterFrame();this.broadcastMessage("onResumed",{target:this,type:"onResumed"})},yoyo:function(){this.continueTo(this.begin,this._time)},addListener:function(t){this.removeListener(t);return this._listeners.push(t)},removeListener:function(t){var e=this._listeners;var i=e.length;while(i--){if(e[i]==t){e.splice(i,1);return true}}return false},broadcastMessage:function(){var t=[];for(var e=0;e<arguments.length;e++){t.push(arguments[e])}var i=t.shift();var n=this._listeners;var s=n.length;for(e=0;e<s;e++){if(n[e][i]){n[e][i].apply(n[e],t)}}},fixTime:function(){this._startTime=this.getTimer()-this._time*1e3},getTimer:function(){return(new Date).getTime()-this._time}};Kinetic.Tweens={"back-ease-in":function(t,e,i,n,s,a){var r=1.70158;return i*(t/=n)*t*((r+1)*t-r)+e},"back-ease-out":function(t,e,i,n,s,a){var r=1.70158;return i*((t=t/n-1)*t*((r+1)*t+r)+1)+e},"back-ease-in-out":function(t,e,i,n,s,a){var r=1.70158;if((t/=n/2)<1){return i/2*(t*t*(((r*=1.525)+1)*t-r))+e}return i/2*((t-=2)*t*(((r*=1.525)+1)*t+r)+2)+e},"elastic-ease-in":function(t,e,i,n,s,a){var r=0;if(t===0){return e}if((t/=n)==1){return e+i}if(!a){a=n*.3}if(!s||s<Math.abs(i)){s=i;r=a/4}else{r=a/(2*Math.PI)*Math.asin(i/s)}return-(s*Math.pow(2,10*(t-=1))*Math.sin((t*n-r)*(2*Math.PI)/a))+e},"elastic-ease-out":function(t,e,i,n,s,a){var r=0;if(t===0){return e}if((t/=n)==1){return e+i}if(!a){a=n*.3}if(!s||s<Math.abs(i)){s=i;r=a/4}else{r=a/(2*Math.PI)*Math.asin(i/s)}return s*Math.pow(2,-10*t)*Math.sin((t*n-r)*(2*Math.PI)/a)+i+e},"elastic-ease-in-out":function(t,e,i,n,s,a){var r=0;if(t===0){return e}if((t/=n/2)==2){return e+i}if(!a){a=n*(.3*1.5)}if(!s||s<Math.abs(i)){s=i;r=a/4}else{r=a/(2*Math.PI)*Math.asin(i/s)}if(t<1){return-.5*(s*Math.pow(2,10*(t-=1))*Math.sin((t*n-r)*(2*Math.PI)/a))+e}return s*Math.pow(2,-10*(t-=1))*Math.sin((t*n-r)*(2*Math.PI)/a)*.5+i+e},"bounce-ease-out":function(t,e,i,n){if((t/=n)<1/2.75){return i*(7.5625*t*t)+e}else if(t<2/2.75){return i*(7.5625*(t-=1.5/2.75)*t+.75)+e}else if(t<2.5/2.75){return i*(7.5625*(t-=2.25/2.75)*t+.9375)+e}else{return i*(7.5625*(t-=2.625/2.75)*t+.984375)+e}},"bounce-ease-in":function(t,e,i,n){return i-Kinetic.Tweens["bounce-ease-out"](n-t,0,i,n)+e},"bounce-ease-in-out":function(t,e,i,n){if(t<n/2){return Kinetic.Tweens["bounce-ease-in"](t*2,0,i,n)*.5+e}else{return Kinetic.Tweens["bounce-ease-out"](t*2-n,0,i,n)*.5+i*.5+e}},"ease-in":function(t,e,i,n){return i*(t/=n)*t+e},"ease-out":function(t,e,i,n){return-i*(t/=n)*(t-2)+e},"ease-in-out":function(t,e,i,n){if((t/=n/2)<1){return i/2*t*t+e}return-i/2*(--t*(t-2)-1)+e},"strong-ease-in":function(t,e,i,n){return i*(t/=n)*t*t*t*t+e},"strong-ease-out":function(t,e,i,n){return i*((t=t/n-1)*t*t*t*t+1)+e},"strong-ease-in-out":function(t,e,i,n){if((t/=n/2)<1){return i/2*t*t*t*t*t+e}return i/2*((t-=2)*t*t*t*t+2)+e},linear:function(t,e,i,n){return i*t/n+e}};
(function(e,n){"use strict";var l=typeof Element!=="undefined"&&"ALLOW_KEYBOARD_INPUT"in Element,r=function(){var e,l;var r=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]];var t=0;var u=r.length;var c={};for(;t<u;t++){e=r[t];if(e&&e[1]in n){for(t=0,l=e.length;t<l;t++){c[r[0][t]]=e[t]}return c}}return false}(),t={request:function(e){var t=r.requestFullscreen;e=e||n.documentElement;if(/5\.1[\.\d]* Safari/.test(navigator.userAgent)){e[t]()}else{e[t](l&&Element.ALLOW_KEYBOARD_INPUT)}},exit:function(){n[r.exitFullscreen]()},toggle:function(e){if(this.isFullscreen){this.exit()}else{this.request(e)}},onchange:function(){},onerror:function(){},raw:r};if(!r){e.screenfull=false;return}Object.defineProperties(t,{isFullscreen:{get:function(){return!!n[r.fullscreenElement]}},element:{enumerable:true,get:function(){return n[r.fullscreenElement]}},enabled:{enumerable:true,get:function(){return!!n[r.fullscreenEnabled]}}});n.addEventListener(r.fullscreenchange,function(e){t.onchange.call(t,e)});n.addEventListener(r.fullscreenerror,function(e){t.onerror.call(t,e)});e.screenfull=t})(window,document);
var SWFUpload=function(t){this.initSWFUpload(t)};SWFUpload.prototype.initSWFUpload=function(t){try{this.customSettings={};this.settings={};this.eventQueue=[];this.movieName="SWFUpload_"+SWFUpload.movieCount++;this.movieElement=null;SWFUpload.instances[this.movieName]=this;this.initSettings(t);this.loadSupport();if(this.swfuploadPreload()){this.loadFlash()}this.displayDebugInfo()}catch(e){delete SWFUpload.instances[this.movieName];throw e}};SWFUpload.instances={};SWFUpload.movieCount=0;SWFUpload.version="2.5.0 2010-01-15 Beta 2";SWFUpload.QUEUE_ERROR={QUEUE_LIMIT_EXCEEDED:-100,FILE_EXCEEDS_SIZE_LIMIT:-110,ZERO_BYTE_FILE:-120,INVALID_FILETYPE:-130};SWFUpload.UPLOAD_ERROR={HTTP_ERROR:-200,MISSING_UPLOAD_URL:-210,IO_ERROR:-220,SECURITY_ERROR:-230,UPLOAD_LIMIT_EXCEEDED:-240,UPLOAD_FAILED:-250,SPECIFIED_FILE_ID_NOT_FOUND:-260,FILE_VALIDATION_FAILED:-270,FILE_CANCELLED:-280,UPLOAD_STOPPED:-290,RESIZE:-300};SWFUpload.FILE_STATUS={QUEUED:-1,IN_PROGRESS:-2,ERROR:-3,COMPLETE:-4,CANCELLED:-5};SWFUpload.UPLOAD_TYPE={NORMAL:-1,RESIZED:-2};SWFUpload.BUTTON_ACTION={SELECT_FILE:-100,SELECT_FILES:-110,START_UPLOAD:-120,JAVASCRIPT:-130,NONE:-130};SWFUpload.CURSOR={ARROW:-1,HAND:-2};SWFUpload.WINDOW_MODE={WINDOW:"window",TRANSPARENT:"transparent",OPAQUE:"opaque"};SWFUpload.RESIZE_ENCODING={JPEG:-1,PNG:-2};SWFUpload.completeURL=function(t){try{var e="",s=-1;if(typeof t!=="string"||t.match(/^https?:\/\//i)||t.match(/^\//)||t===""){return t}s=window.location.pathname.lastIndexOf("/");if(s<=0){e="/"}else{e=window.location.pathname.substr(0,s)+"/"}return e+t}catch(n){return t}};SWFUpload.onload=function(){};SWFUpload.prototype.initSettings=function(t){this.ensureDefault=function(e,s){var n=t[e];if(n!=undefined){this.settings[e]=n}else{this.settings[e]=s}};this.ensureDefault("upload_url","");this.ensureDefault("preserve_relative_urls",false);this.ensureDefault("file_post_name","Filedata");this.ensureDefault("post_params",{});this.ensureDefault("use_query_string",false);this.ensureDefault("requeue_on_error",false);this.ensureDefault("http_success",[]);this.ensureDefault("assume_success_timeout",0);this.ensureDefault("file_types","*.*");this.ensureDefault("file_types_description","All Files");this.ensureDefault("file_size_limit",0);this.ensureDefault("file_upload_limit",0);this.ensureDefault("file_queue_limit",0);this.ensureDefault("flash_url","swfupload.swf");this.ensureDefault("flash9_url","swfupload_fp9.swf");this.ensureDefault("prevent_swf_caching",true);this.ensureDefault("button_image_url","");this.ensureDefault("button_width",1);this.ensureDefault("button_height",1);this.ensureDefault("button_text","");this.ensureDefault("button_text_style","color: #000000; font-size: 16pt;");this.ensureDefault("button_text_top_padding",0);this.ensureDefault("button_text_left_padding",0);this.ensureDefault("button_action",SWFUpload.BUTTON_ACTION.SELECT_FILES);this.ensureDefault("button_disabled",false);this.ensureDefault("button_placeholder_id","");this.ensureDefault("button_placeholder",null);this.ensureDefault("button_cursor",SWFUpload.CURSOR.ARROW);this.ensureDefault("button_window_mode",SWFUpload.WINDOW_MODE.WINDOW);this.ensureDefault("debug",false);this.settings.debug_enabled=this.settings.debug;this.settings.return_upload_start_handler=this.returnUploadStart;this.ensureDefault("swfupload_preload_handler",null);this.ensureDefault("swfupload_load_failed_handler",null);this.ensureDefault("swfupload_loaded_handler",null);this.ensureDefault("file_dialog_start_handler",null);this.ensureDefault("file_queued_handler",null);this.ensureDefault("file_queue_error_handler",null);this.ensureDefault("file_dialog_complete_handler",null);this.ensureDefault("upload_resize_start_handler",null);this.ensureDefault("upload_start_handler",null);this.ensureDefault("upload_progress_handler",null);this.ensureDefault("upload_error_handler",null);this.ensureDefault("upload_success_handler",null);this.ensureDefault("upload_complete_handler",null);this.ensureDefault("mouse_click_handler",null);this.ensureDefault("mouse_out_handler",null);this.ensureDefault("mouse_over_handler",null);this.ensureDefault("debug_handler",this.debugMessage);this.ensureDefault("custom_settings",{});this.customSettings=this.settings.custom_settings;if(!!this.settings.prevent_swf_caching){this.settings.flash_url=this.settings.flash_url+(this.settings.flash_url.indexOf("?")<0?"?":"&")+"preventswfcaching="+(new Date).getTime();this.settings.flash9_url=this.settings.flash9_url+(this.settings.flash9_url.indexOf("?")<0?"?":"&")+"preventswfcaching="+(new Date).getTime()}if(!this.settings.preserve_relative_urls){this.settings.upload_url=SWFUpload.completeURL(this.settings.upload_url);this.settings.button_image_url=SWFUpload.completeURL(this.settings.button_image_url)}delete this.ensureDefault};SWFUpload.prototype.loadSupport=function(){this.support={loading:swfobject.hasFlashPlayerVersion("9.0.28"),imageResize:swfobject.hasFlashPlayerVersion("10.0.0")}};SWFUpload.prototype.loadFlash=function(){var t,e,s,n,i;if(!this.support.loading){this.queueEvent("swfupload_load_failed_handler",["Flash Player doesn't support SWFUpload"]);return}if(document.getElementById(this.movieName)!==null){this.support.loading=false;this.queueEvent("swfupload_load_failed_handler",["Element ID already in use"]);return}t=document.getElementById(this.settings.button_placeholder_id)||this.settings.button_placeholder;if(t==undefined){this.support.loading=false;this.queueEvent("swfupload_load_failed_handler",["button place holder not found"]);return}s=(t.currentStyle&&t.currentStyle["display"]||window.getComputedStyle&&document.defaultView.getComputedStyle(t,null).getPropertyValue("display"))!=="block"?"span":"div";e=document.createElement(s);n=this.getFlashHTML();try{e.innerHTML=n}catch(o){this.support.loading=false;this.queueEvent("swfupload_load_failed_handler",["Exception loading Flash HTML into placeholder"]);return}i=e.getElementsByTagName("object");if(!i||i.length>1||i.length===0){this.support.loading=false;this.queueEvent("swfupload_load_failed_handler",["Unable to find movie after adding to DOM"]);return}else if(i.length===1){this.movieElement=i[0]}t.parentNode.replaceChild(e.firstChild,t);if(window[this.movieName]==undefined){window[this.movieName]=this.getMovieElement()}};SWFUpload.prototype.getFlashHTML=function(t){return['<object id="',this.movieName,'" type="application/x-shockwave-flash" data="',this.support.imageResize?this.settings.flash_url:this.settings.flash9_url,'" width="',this.settings.button_width,'" height="',this.settings.button_height,'" class="swfupload">','<param name="wmode" value="',this.settings.button_window_mode,'" />','<param name="movie" value="',this.support.imageResize?this.settings.flash_url:this.settings.flash9_url,'" />','<param name="quality" value="high" />','<param name="allowScriptAccess" value="always" />','<param name="flashvars" value="'+this.getFlashVars()+'" />',"</object>"].join("")};SWFUpload.prototype.getFlashVars=function(){var t,e;e=this.buildParamString();t=this.settings.http_success.join(",");return["movieName=",encodeURIComponent(this.movieName),"&amp;uploadURL=",encodeURIComponent(this.settings.upload_url),"&amp;useQueryString=",encodeURIComponent(this.settings.use_query_string),"&amp;requeueOnError=",encodeURIComponent(this.settings.requeue_on_error),"&amp;httpSuccess=",encodeURIComponent(t),"&amp;assumeSuccessTimeout=",encodeURIComponent(this.settings.assume_success_timeout),"&amp;params=",encodeURIComponent(e),"&amp;filePostName=",encodeURIComponent(this.settings.file_post_name),"&amp;fileTypes=",encodeURIComponent(this.settings.file_types),"&amp;fileTypesDescription=",encodeURIComponent(this.settings.file_types_description),"&amp;fileSizeLimit=",encodeURIComponent(this.settings.file_size_limit),"&amp;fileUploadLimit=",encodeURIComponent(this.settings.file_upload_limit),"&amp;fileQueueLimit=",encodeURIComponent(this.settings.file_queue_limit),"&amp;debugEnabled=",encodeURIComponent(this.settings.debug_enabled),"&amp;buttonImageURL=",encodeURIComponent(this.settings.button_image_url),"&amp;buttonWidth=",encodeURIComponent(this.settings.button_width),"&amp;buttonHeight=",encodeURIComponent(this.settings.button_height),"&amp;buttonText=",encodeURIComponent(this.settings.button_text),"&amp;buttonTextTopPadding=",encodeURIComponent(this.settings.button_text_top_padding),"&amp;buttonTextLeftPadding=",encodeURIComponent(this.settings.button_text_left_padding),"&amp;buttonTextStyle=",encodeURIComponent(this.settings.button_text_style),"&amp;buttonAction=",encodeURIComponent(this.settings.button_action),"&amp;buttonDisabled=",encodeURIComponent(this.settings.button_disabled),"&amp;buttonCursor=",encodeURIComponent(this.settings.button_cursor)].join("")};SWFUpload.prototype.getMovieElement=function(){if(this.movieElement==undefined){this.movieElement=document.getElementById(this.movieName)}if(this.movieElement===null){throw"Could not find Flash element"}return this.movieElement};SWFUpload.prototype.buildParamString=function(){var t,e,s=[];e=this.settings.post_params;if(typeof e==="object"){for(t in e){if(e.hasOwnProperty(t)){s.push(encodeURIComponent(t.toString())+"="+encodeURIComponent(e[t].toString()))}}}return s.join("&amp;")};SWFUpload.prototype.destroy=function(){var t;try{this.cancelUpload(null,false);t=this.cleanUp();if(t){try{t.parentNode.removeChild(t)}catch(e){}}window[this.movieName]=null;SWFUpload.instances[this.movieName]=null;delete SWFUpload.instances[this.movieName];this.movieElement=null;this.settings=null;this.customSettings=null;this.eventQueue=null;this.movieName=null;return true}catch(s){return false}};SWFUpload.prototype.displayDebugInfo=function(){this.debug(["---SWFUpload Instance Info---\n","Version: ",SWFUpload.version,"\n","Movie Name: ",this.movieName,"\n","Settings:\n","	","upload_url:               ",this.settings.upload_url,"\n","	","flash_url:                ",this.settings.flash_url,"\n","	","flash9_url:                ",this.settings.flash9_url,"\n","	","use_query_string:         ",this.settings.use_query_string.toString(),"\n","	","requeue_on_error:         ",this.settings.requeue_on_error.toString(),"\n","	","http_success:             ",this.settings.http_success.join(", "),"\n","	","assume_success_timeout:   ",this.settings.assume_success_timeout,"\n","	","file_post_name:           ",this.settings.file_post_name,"\n","	","post_params:              ",this.settings.post_params.toString(),"\n","	","file_types:               ",this.settings.file_types,"\n","	","file_types_description:   ",this.settings.file_types_description,"\n","	","file_size_limit:          ",this.settings.file_size_limit,"\n","	","file_upload_limit:        ",this.settings.file_upload_limit,"\n","	","file_queue_limit:         ",this.settings.file_queue_limit,"\n","	","debug:                    ",this.settings.debug.toString(),"\n","	","prevent_swf_caching:      ",this.settings.prevent_swf_caching.toString(),"\n","	","button_placeholder_id:    ",this.settings.button_placeholder_id.toString(),"\n","	","button_placeholder:       ",this.settings.button_placeholder?"Set":"Not Set","\n","	","button_image_url:         ",this.settings.button_image_url.toString(),"\n","	","button_width:             ",this.settings.button_width.toString(),"\n","	","button_height:            ",this.settings.button_height.toString(),"\n","	","button_text:              ",this.settings.button_text.toString(),"\n","	","button_text_style:        ",this.settings.button_text_style.toString(),"\n","	","button_text_top_padding:  ",this.settings.button_text_top_padding.toString(),"\n","	","button_text_left_padding: ",this.settings.button_text_left_padding.toString(),"\n","	","button_action:            ",this.settings.button_action.toString(),"\n","	","button_cursor:            ",this.settings.button_cursor.toString(),"\n","	","button_disabled:          ",this.settings.button_disabled.toString(),"\n","	","custom_settings:          ",this.settings.custom_settings.toString(),"\n","Event Handlers:\n","	","swfupload_preload_handler assigned:  ",(typeof this.settings.swfupload_preload_handler==="function").toString(),"\n","	","swfupload_load_failed_handler assigned:  ",(typeof this.settings.swfupload_load_failed_handler==="function").toString(),"\n","	","swfupload_loaded_handler assigned:  ",(typeof this.settings.swfupload_loaded_handler==="function").toString(),"\n","	","mouse_click_handler assigned:       ",(typeof this.settings.mouse_click_handler==="function").toString(),"\n","	","mouse_over_handler assigned:        ",(typeof this.settings.mouse_over_handler==="function").toString(),"\n","	","mouse_out_handler assigned:         ",(typeof this.settings.mouse_out_handler==="function").toString(),"\n","	","file_dialog_start_handler assigned: ",(typeof this.settings.file_dialog_start_handler==="function").toString(),"\n","	","file_queued_handler assigned:       ",(typeof this.settings.file_queued_handler==="function").toString(),"\n","	","file_queue_error_handler assigned:  ",(typeof this.settings.file_queue_error_handler==="function").toString(),"\n","	","upload_resize_start_handler assigned:      ",(typeof this.settings.upload_resize_start_handler==="function").toString(),"\n","	","upload_start_handler assigned:      ",(typeof this.settings.upload_start_handler==="function").toString(),"\n","	","upload_progress_handler assigned:   ",(typeof this.settings.upload_progress_handler==="function").toString(),"\n","	","upload_error_handler assigned:      ",(typeof this.settings.upload_error_handler==="function").toString(),"\n","	","upload_success_handler assigned:    ",(typeof this.settings.upload_success_handler==="function").toString(),"\n","	","upload_complete_handler assigned:   ",(typeof this.settings.upload_complete_handler==="function").toString(),"\n","	","debug_handler assigned:             ",(typeof this.settings.debug_handler==="function").toString(),"\n","Support:\n","	","Load:                     ",this.support.loading?"Yes":"No","\n","	","Image Resize:             ",this.support.imageResize?"Yes":"No","\n"].join(""))};SWFUpload.prototype.addSetting=function(t,e,s){if(e==undefined){return this.settings[t]=s}else{return this.settings[t]=e}};SWFUpload.prototype.getSetting=function(t){if(this.settings[t]!=undefined){return this.settings[t]}return""};SWFUpload.prototype.callFlash=function(functionName,argumentArray){var movieElement,returnValue,returnString;argumentArray=argumentArray||[];movieElement=this.getMovieElement();try{if(movieElement!=undefined){returnString=movieElement.CallFunction('<invoke name="'+functionName+'" returntype="javascript">'+__flash__argumentsToXML(argumentArray,0)+"</invoke>");returnValue=eval(returnString)}else{this.debug("Can't call flash because the movie wasn't found.")}}catch(ex){this.debug("Exception calling flash function '"+functionName+"': "+ex.message)}if(returnValue!=undefined&&typeof returnValue.post==="object"){returnValue=this.unescapeFilePostParams(returnValue)}return returnValue};SWFUpload.prototype.selectFile=function(){this.callFlash("SelectFile")};SWFUpload.prototype.selectFiles=function(){this.callFlash("SelectFiles")};SWFUpload.prototype.startUpload=function(t){this.callFlash("StartUpload",[t])};SWFUpload.prototype.startResizedUpload=function(t,e,s,n,i,o){this.callFlash("StartUpload",[t,{width:e,height:s,encoding:n,quality:i,allowEnlarging:o}])};SWFUpload.prototype.cancelUpload=function(t,e){if(e!==false){e=true}this.callFlash("CancelUpload",[t,e])};SWFUpload.prototype.stopUpload=function(){this.callFlash("StopUpload")};SWFUpload.prototype.requeueUpload=function(t){return this.callFlash("RequeueUpload",[t])};SWFUpload.prototype.getStats=function(){return this.callFlash("GetStats")};SWFUpload.prototype.setStats=function(t){this.callFlash("SetStats",[t])};SWFUpload.prototype.getFile=function(t){if(typeof t==="number"){return this.callFlash("GetFileByIndex",[t])}else{return this.callFlash("GetFile",[t])}};SWFUpload.prototype.getQueueFile=function(t){if(typeof t==="number"){return this.callFlash("GetFileByQueueIndex",[t])}else{return this.callFlash("GetFile",[t])}};SWFUpload.prototype.addFileParam=function(t,e,s){return this.callFlash("AddFileParam",[t,e,s])};SWFUpload.prototype.removeFileParam=function(t,e){this.callFlash("RemoveFileParam",[t,e])};SWFUpload.prototype.setUploadURL=function(t){this.settings.upload_url=t.toString();this.callFlash("SetUploadURL",[t])};SWFUpload.prototype.setPostParams=function(t){this.settings.post_params=t;this.callFlash("SetPostParams",[t])};SWFUpload.prototype.addPostParam=function(t,e){this.settings.post_params[t]=e;this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.removePostParam=function(t){delete this.settings.post_params[t];this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.setFileTypes=function(t,e){this.settings.file_types=t;this.settings.file_types_description=e;this.callFlash("SetFileTypes",[t,e])};SWFUpload.prototype.setFileSizeLimit=function(t){this.settings.file_size_limit=t;this.callFlash("SetFileSizeLimit",[t])};SWFUpload.prototype.setFileUploadLimit=function(t){this.settings.file_upload_limit=t;this.callFlash("SetFileUploadLimit",[t])};SWFUpload.prototype.setFileQueueLimit=function(t){this.settings.file_queue_limit=t;this.callFlash("SetFileQueueLimit",[t])};SWFUpload.prototype.setFilePostName=function(t){this.settings.file_post_name=t;this.callFlash("SetFilePostName",[t])};SWFUpload.prototype.setUseQueryString=function(t){this.settings.use_query_string=t;this.callFlash("SetUseQueryString",[t])};SWFUpload.prototype.setRequeueOnError=function(t){this.settings.requeue_on_error=t;this.callFlash("SetRequeueOnError",[t])};SWFUpload.prototype.setHTTPSuccess=function(t){if(typeof t==="string"){t=t.replace(" ","").split(",")}this.settings.http_success=t;this.callFlash("SetHTTPSuccess",[t])};SWFUpload.prototype.setAssumeSuccessTimeout=function(t){this.settings.assume_success_timeout=t;this.callFlash("SetAssumeSuccessTimeout",[t])};SWFUpload.prototype.setDebugEnabled=function(t){this.settings.debug_enabled=t;this.callFlash("SetDebugEnabled",[t])};SWFUpload.prototype.setButtonImageURL=function(t){if(t==undefined){t=""}this.settings.button_image_url=t;this.callFlash("SetButtonImageURL",[t])};SWFUpload.prototype.setButtonDimensions=function(t,e){this.settings.button_width=t;this.settings.button_height=e;var s=this.getMovieElement();if(s!=undefined){s.style.width=t+"px";s.style.height=e+"px"}this.callFlash("SetButtonDimensions",[t,e])};SWFUpload.prototype.setButtonText=function(t){this.settings.button_text=t;this.callFlash("SetButtonText",[t])};SWFUpload.prototype.setButtonTextPadding=function(t,e){this.settings.button_text_top_padding=e;this.settings.button_text_left_padding=t;this.callFlash("SetButtonTextPadding",[t,e])};SWFUpload.prototype.setButtonTextStyle=function(t){this.settings.button_text_style=t;this.callFlash("SetButtonTextStyle",[t])};SWFUpload.prototype.setButtonDisabled=function(t){this.settings.button_disabled=t;this.callFlash("SetButtonDisabled",[t])};SWFUpload.prototype.setButtonAction=function(t){this.settings.button_action=t;this.callFlash("SetButtonAction",[t])};SWFUpload.prototype.setButtonCursor=function(t){this.settings.button_cursor=t;this.callFlash("SetButtonCursor",[t])};SWFUpload.prototype.queueEvent=function(t,e){var s=this;if(e==undefined){e=[]}else if(!(e instanceof Array)){e=[e]}if(typeof this.settings[t]==="function"){this.eventQueue.push(function(){this.settings[t].apply(this,e)});setTimeout(function(){s.executeNextEvent()},0)}else if(this.settings[t]!==null){throw"Event handler "+t+" is unknown or is not a function"}};SWFUpload.prototype.executeNextEvent=function(){var t=this.eventQueue?this.eventQueue.shift():null;if(typeof t==="function"){t.apply(this)}};SWFUpload.prototype.unescapeFilePostParams=function(t){var e=/[$]([0-9a-f]{4})/i,s={},n,i,o;if(t!=undefined){for(i in t.post){if(t.post.hasOwnProperty(i)){n=i;while((o=e.exec(n))!==null){n=n.replace(o[0],String.fromCharCode(parseInt("0x"+o[1],16)))}s[n]=t.post[i]}}t.post=s}return t};SWFUpload.prototype.swfuploadPreload=function(){var t;if(typeof this.settings.swfupload_preload_handler==="function"){t=this.settings.swfupload_preload_handler.call(this)}else if(this.settings.swfupload_preload_handler!=undefined){throw"upload_start_handler must be a function"}if(t===undefined){t=true}return!!t};SWFUpload.prototype.flashReady=function(){var t=this.cleanUp();if(!t){this.debug("Flash called back ready but the flash movie can't be found.");return}this.queueEvent("swfupload_loaded_handler")};SWFUpload.prototype.cleanUp=function(){var t,e=this.getMovieElement();try{if(e&&typeof e.CallFunction==="unknown"){this.debug("Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)");for(t in e){try{if(typeof e[t]==="function"){e[t]=null}}catch(s){}}}}catch(n){}window["__flash__removeCallback"]=function(t,e){try{if(t){t[e]=null}}catch(s){}};return e};SWFUpload.prototype.mouseClick=function(){this.queueEvent("mouse_click_handler")};SWFUpload.prototype.mouseOver=function(){this.queueEvent("mouse_over_handler")};SWFUpload.prototype.mouseOut=function(){this.queueEvent("mouse_out_handler")};SWFUpload.prototype.fileDialogStart=function(){this.queueEvent("file_dialog_start_handler")};SWFUpload.prototype.fileQueued=function(t){t=this.unescapeFilePostParams(t);this.queueEvent("file_queued_handler",t)};SWFUpload.prototype.fileQueueError=function(t,e,s){t=this.unescapeFilePostParams(t);this.queueEvent("file_queue_error_handler",[t,e,s])};SWFUpload.prototype.fileDialogComplete=function(t,e,s){this.queueEvent("file_dialog_complete_handler",[t,e,s])};SWFUpload.prototype.uploadResizeStart=function(t,e){t=this.unescapeFilePostParams(t);this.queueEvent("upload_resize_start_handler",[t,e.width,e.height,e.encoding,e.quality])};SWFUpload.prototype.uploadStart=function(t){t=this.unescapeFilePostParams(t);this.queueEvent("return_upload_start_handler",t)};SWFUpload.prototype.returnUploadStart=function(t){var e;if(typeof this.settings.upload_start_handler==="function"){t=this.unescapeFilePostParams(t);e=this.settings.upload_start_handler.call(this,t)}else if(this.settings.upload_start_handler!=undefined){throw"upload_start_handler must be a function"}if(e===undefined){e=true}e=!!e;this.callFlash("ReturnUploadStart",[e])};SWFUpload.prototype.uploadProgress=function(t,e,s){t=this.unescapeFilePostParams(t);this.queueEvent("upload_progress_handler",[t,e,s])};SWFUpload.prototype.uploadError=function(t,e,s){t=this.unescapeFilePostParams(t);this.queueEvent("upload_error_handler",[t,e,s])};SWFUpload.prototype.uploadSuccess=function(t,e,s){t=this.unescapeFilePostParams(t);this.queueEvent("upload_success_handler",[t,e,s])};SWFUpload.prototype.uploadComplete=function(t){t=this.unescapeFilePostParams(t);this.queueEvent("upload_complete_handler",t)};SWFUpload.prototype.debug=function(t){this.queueEvent("debug_handler",t)};SWFUpload.prototype.debugMessage=function(t){var e,s,n;if(this.settings.debug){s=[];if(typeof t==="object"&&typeof t.name==="string"&&typeof t.message==="string"){for(n in t){if(t.hasOwnProperty(n)){s.push(n+": "+t[n])}}e=s.join("\n")||"";s=e.split("\n");e="EXCEPTION: "+s.join("\nEXCEPTION: ");SWFUpload.Console.writeLine(e)}else{SWFUpload.Console.writeLine(t)}}};SWFUpload.Console={};SWFUpload.Console.writeLine=function(t){var e,s;try{e=document.getElementById("SWFUpload_Console");if(!e){s=document.createElement("form");document.getElementsByTagName("body")[0].appendChild(s);e=document.createElement("textarea");e.id="SWFUpload_Console";e.style.fontFamily="monospace";e.setAttribute("wrap","off");e.wrap="off";e.style.overflow="auto";e.style.width="700px";e.style.height="350px";e.style.margin="5px";s.appendChild(e)}e.value+=t+"\n";e.scrollTop=e.scrollHeight-e.clientHeight}catch(n){alert("Exception: "+n.name+" Message: "+n.message)}};swfobject.addDomLoadEvent(function(){if(typeof SWFUpload.onload==="function"){SWFUpload.onload.call(window)}});
if(typeof SWFUpload==="function"){SWFUpload.prototype.initSettings=function(t){return function(i){if(typeof t==="function"){t.call(this,i)}this.refreshCookies(false)}}(SWFUpload.prototype.initSettings);SWFUpload.prototype.refreshCookies=function(t){if(t===undefined){t=true}t=!!t;var i=this.settings.post_params;var o,e=document.cookie.split(";"),n=e.length,s,r,f,p;for(o=0;o<n;o++){s=e[o];while(s.charAt(0)===" "){s=s.substring(1,s.length)}r=s.indexOf("=");if(r>0){f=s.substring(0,r);p=s.substring(r+1);i[f]=p}}if(t){this.setPostParams(i)}}}
if(!Function.prototype.bind){Function.prototype.bind=function(t){if(typeof this!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable")}var o=Array.prototype.slice.call(arguments,1),n=this,r=function(){},i=function(){return n.apply(this instanceof r&&t?this:t,o.concat(Array.prototype.slice.call(arguments)))};r.prototype=this.prototype;i.prototype=new r;return i}}
Object.keys=Object.keys||function(){var t=Object.prototype.hasOwnProperty,r=!{toString:null}.propertyIsEnumerable("toString"),e=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],o=e.length;return function(n){if(typeof n!="object"&&typeof n!="function"||n===null)throw new TypeError("Object.keys called on a non-object");var c=[];for(var l in n){if(t.call(n,l))c.push(l)}if(r){for(var a=0;a<o;a++){if(t.call(n,e[a]))c.push(e[a])}}return c}}();
(function(t){if(typeof define!=="undefined"&&define.amd){define([],t)}else if(typeof module!=="undefined"&&module.exports){module.exports=t()}else{window.scrollMonitor=t()}})(function(){var t=function(){return window.pageYOffset||document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop};var i={};var e=[];var o="visibilityChange";var s="enterViewport";var n="fullyEnterViewport";var r="exitViewport";var h="partiallyExitViewport";var l="locationChange";var c="stateChange";var a=[o,s,n,r,h,l,c];var p={top:0,bottom:0};var u=function(){return window.innerHeight||document.documentElement.clientHeight};var w=function(){return Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.documentElement.clientHeight)};i.viewportTop=null;i.viewportBottom=null;i.documentHeight=null;i.viewportHeight=u();var f;var m;var d;function v(){i.viewportTop=t();i.viewportBottom=i.viewportTop+i.viewportHeight;i.documentHeight=w();if(i.documentHeight!==f){d=e.length;while(d--){e[d].recalculateLocation()}f=i.documentHeight}}function b(){i.viewportHeight=u();v();I()}var g;function V(){clearTimeout(g);g=setTimeout(b,100)}var y;function I(){y=e.length;while(y--){e[y].update()}y=e.length;while(y--){e[y].triggerCallbacks()}}function k(t,e){var u=this;this.watchItem=t;if(!e){this.offsets=p}else if(e===+e){this.offsets={top:e,bottom:e}}else{this.offsets={top:e.top||p.top,bottom:e.bottom||p.bottom}}this.callbacks={};for(var w=0,f=a.length;w<f;w++){u.callbacks[a[w]]=[]}this.locked=false;var d;var v;var b;var g;var V;var y;function I(t){if(t.length===0){return}V=t.length;while(V--){y=t[V];y.callback.call(u,m);if(y.isOne){t.splice(V,1)}}}this.triggerCallbacks=function k(){if(this.isInViewport&&!d){I(this.callbacks[s])}if(this.isFullyInViewport&&!v){I(this.callbacks[n])}if(this.isAboveViewport!==b&&this.isBelowViewport!==g){I(this.callbacks[o]);if(!v&&!this.isFullyInViewport){I(this.callbacks[n]);I(this.callbacks[h])}if(!d&&!this.isInViewport){I(this.callbacks[s]);I(this.callbacks[r])}}if(!this.isFullyInViewport&&v){I(this.callbacks[h])}if(!this.isInViewport&&d){I(this.callbacks[r])}if(this.isInViewport!==d){I(this.callbacks[o])}switch(true){case d!==this.isInViewport:case v!==this.isFullyInViewport:case b!==this.isAboveViewport:case g!==this.isBelowViewport:I(this.callbacks[c])}d=this.isInViewport;v=this.isFullyInViewport;b=this.isAboveViewport;g=this.isBelowViewport};this.recalculateLocation=function(){if(this.locked){return}var t=this.top;var e=this.bottom;if(this.watchItem.nodeName){var o=this.watchItem.style.display;if(o==="none"){this.watchItem.style.display=""}var s=this.watchItem.getBoundingClientRect();this.top=s.top+i.viewportTop;this.bottom=s.bottom+i.viewportTop;if(o==="none"){this.watchItem.style.display=o}}else if(this.watchItem===+this.watchItem){if(this.watchItem>0){this.top=this.bottom=this.watchItem}else{this.top=this.bottom=i.documentHeight-this.watchItem}}else{this.top=this.watchItem.top;this.bottom=this.watchItem.bottom}this.top-=this.offsets.top;this.bottom+=this.offsets.bottom;this.height=this.bottom-this.top;if((t!==undefined||e!==undefined)&&(this.top!==t||this.bottom!==e)){I(this.callbacks[l])}};this.recalculateLocation();this.update();d=this.isInViewport;v=this.isFullyInViewport;b=this.isAboveViewport;g=this.isBelowViewport}k.prototype={on:function(t,i,e){switch(true){case t===o&&!this.isInViewport&&this.isAboveViewport:case t===s&&this.isInViewport:case t===n&&this.isFullyInViewport:case t===r&&this.isAboveViewport&&!this.isInViewport:case t===h&&this.isAboveViewport:i.call(this,m);if(e){return}}if(this.callbacks[t]){this.callbacks[t].push({callback:i,isOne:e||false})}else{throw new Error("Tried to add a scroll monitor listener of type "+t+". Your options are: "+a.join(", "))}},off:function(t,i){if(this.callbacks[t]){for(var e=0,o;o=this.callbacks[t][e];e++){if(o.callback===i){this.callbacks[t].splice(e,1);break}}}else{throw new Error("Tried to remove a scroll monitor listener of type "+t+". Your options are: "+a.join(", "))}},one:function(t,i){this.on(t,i,true)},recalculateSize:function(){this.height=this.watchItem.offsetHeight+this.offsets.top+this.offsets.bottom;this.bottom=this.top+this.height},update:function(){this.isAboveViewport=this.top<i.viewportTop;this.isBelowViewport=this.bottom>i.viewportBottom;this.isInViewport=this.top<=i.viewportBottom&&this.bottom>=i.viewportTop;this.isFullyInViewport=this.top>=i.viewportTop&&this.bottom<=i.viewportBottom||this.isAboveViewport&&this.isBelowViewport},destroy:function(){var t=e.indexOf(this),i=this;e.splice(t,1);for(var o=0,s=a.length;o<s;o++){i.callbacks[a[o]].length=0}},lock:function(){this.locked=true},unlock:function(){this.locked=false}};var H=function(t){return function(i,e){this.on.call(this,t,i,e)}};for(var E=0,T=a.length;E<T;E++){var B=a[E];k.prototype[B]=H(B)}try{v()}catch(A){try{window.$(v)}catch(A){throw new Error("If you must put scrollMonitor in the <head>, you must use jQuery.")}}function F(t){m=t;v();I()}if(window.addEventListener){window.addEventListener("scroll",F);window.addEventListener("resize",V)}else{window.attachEvent("onscroll",F);window.attachEvent("onresize",V)}i.beget=i.create=function(t,i){if(typeof t==="string"){t=document.querySelector(t)}else if(t&&t.length>0){t=t[0]}var o=new k(t,i);e.push(o);o.update();return o};i.update=function(){m=null;v();I()};i.recalculateLocations=function(){i.documentHeight=0;i.update()};return i});
(function(){var t=$.ui.resizable.prototype._setOption;$.ui.resizable.prototype._setOption=function(i,e){t.apply(this,arguments);if(i==="aspectRatio"){this._aspectRatio=!!e}}})();
function md5cycle(f,h){var i=f[0],n=f[1],r=f[2],g=f[3];i=ff(i,n,r,g,h[0],7,-680876936);g=ff(g,i,n,r,h[1],12,-389564586);r=ff(r,g,i,n,h[2],17,606105819);n=ff(n,r,g,i,h[3],22,-1044525330);i=ff(i,n,r,g,h[4],7,-176418897);g=ff(g,i,n,r,h[5],12,1200080426);r=ff(r,g,i,n,h[6],17,-1473231341);n=ff(n,r,g,i,h[7],22,-45705983);i=ff(i,n,r,g,h[8],7,1770035416);g=ff(g,i,n,r,h[9],12,-1958414417);r=ff(r,g,i,n,h[10],17,-42063);n=ff(n,r,g,i,h[11],22,-1990404162);i=ff(i,n,r,g,h[12],7,1804603682);g=ff(g,i,n,r,h[13],12,-40341101);r=ff(r,g,i,n,h[14],17,-1502002290);n=ff(n,r,g,i,h[15],22,1236535329);i=gg(i,n,r,g,h[1],5,-165796510);g=gg(g,i,n,r,h[6],9,-1069501632);r=gg(r,g,i,n,h[11],14,643717713);n=gg(n,r,g,i,h[0],20,-373897302);i=gg(i,n,r,g,h[5],5,-701558691);g=gg(g,i,n,r,h[10],9,38016083);r=gg(r,g,i,n,h[15],14,-660478335);n=gg(n,r,g,i,h[4],20,-405537848);i=gg(i,n,r,g,h[9],5,568446438);g=gg(g,i,n,r,h[14],9,-1019803690);r=gg(r,g,i,n,h[3],14,-187363961);n=gg(n,r,g,i,h[8],20,1163531501);i=gg(i,n,r,g,h[13],5,-1444681467);g=gg(g,i,n,r,h[2],9,-51403784);r=gg(r,g,i,n,h[7],14,1735328473);n=gg(n,r,g,i,h[12],20,-1926607734);i=hh(i,n,r,g,h[5],4,-378558);g=hh(g,i,n,r,h[8],11,-2022574463);r=hh(r,g,i,n,h[11],16,1839030562);n=hh(n,r,g,i,h[14],23,-35309556);i=hh(i,n,r,g,h[1],4,-1530992060);g=hh(g,i,n,r,h[4],11,1272893353);r=hh(r,g,i,n,h[7],16,-155497632);n=hh(n,r,g,i,h[10],23,-1094730640);i=hh(i,n,r,g,h[13],4,681279174);g=hh(g,i,n,r,h[0],11,-358537222);r=hh(r,g,i,n,h[3],16,-722521979);n=hh(n,r,g,i,h[6],23,76029189);i=hh(i,n,r,g,h[9],4,-640364487);g=hh(g,i,n,r,h[12],11,-421815835);r=hh(r,g,i,n,h[15],16,530742520);n=hh(n,r,g,i,h[2],23,-995338651);i=ii(i,n,r,g,h[0],6,-198630844);g=ii(g,i,n,r,h[7],10,1126891415);r=ii(r,g,i,n,h[14],15,-1416354905);n=ii(n,r,g,i,h[5],21,-57434055);i=ii(i,n,r,g,h[12],6,1700485571);g=ii(g,i,n,r,h[3],10,-1894986606);r=ii(r,g,i,n,h[10],15,-1051523);n=ii(n,r,g,i,h[1],21,-2054922799);i=ii(i,n,r,g,h[8],6,1873313359);g=ii(g,i,n,r,h[15],10,-30611744);r=ii(r,g,i,n,h[6],15,-1560198380);n=ii(n,r,g,i,h[13],21,1309151649);i=ii(i,n,r,g,h[4],6,-145523070);g=ii(g,i,n,r,h[11],10,-1120210379);r=ii(r,g,i,n,h[2],15,718787259);n=ii(n,r,g,i,h[9],21,-343485551);f[0]=add32(i,f[0]);f[1]=add32(n,f[1]);f[2]=add32(r,f[2]);f[3]=add32(g,f[3])}function cmn(f,h,i,n,r,g){h=add32(add32(h,f),add32(n,g));return add32(h<<r|h>>>32-r,i)}function ff(f,h,i,n,r,g,t){return cmn(h&i|~h&n,f,h,r,g,t)}function gg(f,h,i,n,r,g,t){return cmn(h&n|i&~n,f,h,r,g,t)}function hh(f,h,i,n,r,g,t){return cmn(h^i^n,f,h,r,g,t)}function ii(f,h,i,n,r,g,t){return cmn(i^(h|~n),f,h,r,g,t)}function md51(f){txt="";var h=f.length,i=[1732584193,-271733879,-1732584194,271733878],n;for(n=64;n<=f.length;n+=64){md5cycle(i,md5blk(f.substring(n-64,n)))}f=f.substring(n-64);var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(n=0;n<f.length;n++){r[n>>2]|=f.charCodeAt(n)<<(n%4<<3)}r[n>>2]|=128<<(n%4<<3);if(n>55){md5cycle(i,r);for(n=0;n<16;n++){r[n]=0}}r[14]=h*8;md5cycle(i,r);return i}function md5blk(f){var h=[],i;for(i=0;i<64;i+=4){h[i>>2]=f.charCodeAt(i)+(f.charCodeAt(i+1)<<8)+(f.charCodeAt(i+2)<<16)+(f.charCodeAt(i+3)<<24)}return h}var hex_chr="0123456789abcdef".split("");function rhex(f){var h="",i=0;for(;i<4;i++){h+=hex_chr[f>>i*8+4&15]+hex_chr[f>>i*8&15]}return h}function hex(f){for(var h=0;h<f.length;h++){f[h]=rhex(f[h])}return f.join("")}function md5(f){return hex(md51(f))}function add32(f,h){return f+h&4294967295}if(md5("hello")!="5d41402abc4b2a76b9719d911017c592"){function add32(f,h){var i=(f&65535)+(h&65535),n=(f>>16)+(h>>16)+(i>>16);return n<<16|i&65535}}
(function(e,n){var t=Array.prototype.slice,i=decodeURIComponent,r=e.param,a,f,u,o=e.bbq=e.bbq||{},c,s,l,d=e.event.special,p="hashchange",h="querystring",m="fragment",g="elemUrlAttr",v="location",y="href",b="src",$=/^.*\?|#.*$/g,x=/^.*\#/,j,w={};function A(e){return typeof e==="string"}function N(e){var n=t.call(arguments,1);return function(){return e.apply(this,n.concat(t.call(arguments)))}}function S(e){return e.replace(/^[^#]*#?(.*)$/,"$1")}function q(e){return e.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")}function C(t,a,u,o,c){var s,l,d,p,g;if(o!==undefined){d=u.match(t?/^([^#]*)\#?(.*)$/:/^([^#?]*)\??([^#]*)(#?.*)/);g=d[3]||"";if(c===2&&A(o)){l=o.replace(t?x:$,"")}else{p=f(d[2]);o=A(o)?f[t?m:h](o):o;l=c===2?o:c===1?e.extend({},o,p):e.extend({},p,o);l=r(l);if(t){l=l.replace(j,i)}}s=d[1]+(t?"#":l||!d[1]?"?":"")+l+g}else{s=a(u!==undefined?u:n[v][y])}return s}r[h]=N(C,0,q);r[m]=a=N(C,1,S);a.noEscape=function(n){n=n||"";var t=e.map(n.split(""),encodeURIComponent);j=new RegExp(t.join("|"),"g")};a.noEscape(",/");e.deparam=f=function(n,t){var r={},a={"true":!0,"false":!1,"null":null};e.each(n.replace(/\+/g," ").split("&"),function(n,f){var u=f.split("="),o=i(u[0]),c,s=r,l=0,d=o.split("]["),p=d.length-1;if(/\[/.test(d[0])&&/\]$/.test(d[p])){d[p]=d[p].replace(/\]$/,"");d=d.shift().split("[").concat(d);p=d.length-1}else{p=0}if(u.length===2){c=i(u[1]);if(t){c=c&&!isNaN(c)?+c:c==="undefined"?undefined:a[c]!==undefined?a[c]:c}if(p){for(;l<=p;l++){o=d[l]===""?s.length:d[l];s=s[o]=l<p?s[o]||(d[l+1]&&isNaN(d[l+1])?{}:[]):c}}else{if(e.isArray(r[o])){r[o].push(c)}else if(r[o]!==undefined){r[o]=[r[o],c]}else{r[o]=c}}}else if(o){r[o]=t?undefined:""}});return r};function E(e,n,t){if(n===undefined||typeof n==="boolean"){t=n;n=r[e?m:h]()}else{n=A(n)?n.replace(e?x:$,""):n}return f(n,t)}f[h]=N(E,0);f[m]=u=N(E,1);if(!e[g]){e[g]=function(n){return e.extend(w,n)}({a:y,base:y,iframe:b,img:b,input:b,form:"action",link:y,script:b})}l=e[g];function R(n,t,i,a){if(!A(i)&&typeof i!=="object"){a=i;i=t;t=undefined}return this.each(function(){var f=e(this),u=t||l()[(this.nodeName||"").toLowerCase()]||"",o=u&&f.attr(u)||"";f.attr(u,r[n](o,i,a))})}e.fn[h]=N(R,h);e.fn[m]=N(R,m);o.pushState=c=function(e,t){if(A(e)&&/^#/.test(e)&&t===undefined){t=2}var i=e!==undefined,r=a(n[v][y],i?e:{},i?t:2);n[v][y]=r+(/#/.test(r)?"":"#")};o.getState=s=function(e,n){return e===undefined||typeof e==="boolean"?u(e):u(n)[e]};o.removeState=function(n){var t={};if(n!==undefined){t=s();e.each(e.isArray(n)?n:arguments,function(e,n){delete t[n]})}c(t,2)};d[p]=e.extend(d[p],{add:function(n){var t;function i(e){var n=e[m]=a();e.getState=function(e,t){return e===undefined||typeof e==="boolean"?f(n,e):f(n,t)[e]};t.apply(this,arguments)}if(e.isFunction(n)){t=n;return i}else{t=n.handler;n.handler=i}}})})(jQuery,this);(function(e,n,t){"$:nomunge";var i,r=e.event.special,a="location",f="hashchange",u="href",o=e.browser,c=document.documentMode,s=o.msie&&(c===t||c<8),l="on"+f in n&&!s;function d(e){e=e||n[a][u];return e.replace(/^[^#]*#?(.*)$/,"$1")}e[f+"Delay"]=100;r[f]=e.extend(r[f],{setup:function(){if(l){return false}e(i.start)},teardown:function(){if(l){return false}e(i.stop)}});i=function(){var t={},i,r,o,c;function l(){o=c=function(e){return e};if(s){r=e('<iframe src="javascript:0"/>').hide().insertAfter("body")[0].contentWindow;c=function(){return d(r.document[a][u])};o=function(e,n){if(e!==n){var t=r.document;t.open().close();t[a].hash="#"+e}};o(d())}}t.start=function(){if(i){return}var t=d();o||l();(function r(){var s=d(),l=c(t);if(s!==t){o(t=s,l);e(n).trigger(f)}else if(l!==t){n[a][u]=n[a][u].replace(/#.*/,"")+"#"+l}i=setTimeout(r,e[f+"Delay"])})()};t.stop=function(){if(!r){i&&clearTimeout(i);i=0}};return t}()})(jQuery,this);
(function(e){if(typeof exports==="object"&&exports&&typeof module==="object"&&module&&module.exports===exports){e(require("jquery"))}else if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{e(jQuery)}})(function(e){var i=f();var t=86400;var r={am:"am",pm:"pm",AM:"AM",PM:"PM",decimal:".",mins:"mins",hr:"hr",hrs:"hrs"};var a={init:function(i){return this.each(function(){var t=e(this);var s=[];for(var o in e.fn.timepicker.defaults){if(t.data(o)){s[o]=t.data(o)}}var c=e.extend({},e.fn.timepicker.defaults,s,i);if(c.lang){r=e.extend(r,c.lang)}c=n(c);t.data("timepicker-settings",c);t.addClass("ui-timepicker-input");if(c.useSelect){l(t)}else{t.prop("autocomplete","off");t.on("click.timepicker focus.timepicker",a.show);t.on("change.timepicker",g);t.on("keydown.timepicker",T);t.on("keyup.timepicker",b);g.call(t.get(0))}})},show:function(i){var t=e(this);var r=t.data("timepicker-settings");if(i){if(!r.showOnFocus){return true}i.preventDefault()}if(r.useSelect){t.data("timepicker-list").focus();return}if(p(t)){t.blur()}var n=t.data("timepicker-list");if(t.prop("readonly")){return}if(!n||n.length===0||typeof r.durationTime==="function"){l(t);n=t.data("timepicker-list")}if(s(n)){return}a.hide();n.show();var o={};if(r.orientation=="rtl"){o.left=t.offset().left+t.outerWidth()-n.outerWidth()+parseInt(n.css("marginLeft").replace("px",""),10)}else{o.left=t.offset().left+parseInt(n.css("marginLeft").replace("px",""),10)}if(t.offset().top+t.outerHeight(true)+n.outerHeight()>e(window).height()+e(window).scrollTop()){n.addClass("ui-timepicker-positioned-top");o.top=t.offset().top-n.outerHeight()+parseInt(n.css("marginTop").replace("px",""),10)}else{n.removeClass("ui-timepicker-positioned-top");o.top=t.offset().top+t.outerHeight()+parseInt(n.css("marginTop").replace("px",""),10)}n.offset(o);var c=n.find(".ui-timepicker-selected");if(!c.length){if(v(t)){c=d(t,n,C(v(t)))}else if(r.scrollDefault){c=d(t,n,r.scrollDefault)}}if(c&&c.length){var u=n.scrollTop()+c.position().top-c.outerHeight();n.scrollTop(u)}else{n.scrollTop(0)}e(document).on("touchstart.ui-timepicker mousedown.ui-timepicker",m);if(r.closeOnWindowScroll){e(document).on("scroll.ui-timepicker",m)}t.trigger("showTimepicker");return this},hide:function(i){var t=e(this);var r=t.data("timepicker-settings");if(r&&r.useSelect){t.blur()}e(".ui-timepicker-wrapper").each(function(){var i=e(this);if(!s(i)){return}var t=i.data("timepicker-input");var r=t.data("timepicker-settings");if(r&&r.selectOnBlur){y(t)}i.hide();t.trigger("hideTimepicker")});return this},option:function(i,t){return this.each(function(){var r=e(this);var a=r.data("timepicker-settings");var s=r.data("timepicker-list");if(typeof i=="object"){a=e.extend(a,i)}else if(typeof i=="string"&&typeof t!="undefined"){a[i]=t}else if(typeof i=="string"){return a[i]}a=n(a);r.data("timepicker-settings",a);if(s){s.remove();r.data("timepicker-list",false)}if(a.useSelect){l(r)}})},getSecondsFromMidnight:function(){return C(v(this))},getTime:function(e){var i=this;var t=v(i);if(!t){return null}if(!e){e=new Date}var r=C(t);var a=new Date(e);a.setHours(r/3600);a.setMinutes(r%3600/60);a.setSeconds(r%60);a.setMilliseconds(0);return a},setTime:function(e){var i=this;var t=i.data("timepicker-settings");if(t.forceRoundTime){var r=u(e,t)}else{var r=x(C(e),t.timeFormat)}k(i,r);if(i.data("timepicker-list")){h(i,i.data("timepicker-list"))}return this},remove:function(){var e=this;if(!e.hasClass("ui-timepicker-input")){return}var i=e.data("timepicker-settings");e.removeAttr("autocomplete","off");e.removeClass("ui-timepicker-input");e.removeData("timepicker-settings");e.off(".timepicker");if(e.data("timepicker-list")){e.data("timepicker-list").remove()}if(i.useSelect){e.show()}e.removeData("timepicker-list");return this}};function s(e){var i=e[0];return i.offsetWidth>0&&i.offsetHeight>0}function n(i){if(i.minTime){i.minTime=C(i.minTime)}if(i.maxTime){i.maxTime=C(i.maxTime)}if(i.durationTime&&typeof i.durationTime!=="function"){i.durationTime=C(i.durationTime)}if(i.scrollDefault=="now"){i.scrollDefault=C(new Date)}else if(i.scrollDefault){i.scrollDefault=C(i.scrollDefault)}else if(i.minTime){i.scrollDefault=i.minTime}if(i.scrollDefault){i.scrollDefault=c(i.scrollDefault,i)}if(e.type(i.timeFormat)==="string"&&i.timeFormat.match(/[gh]/)){i._twelveHourTime=true}if(i.disableTimeRanges.length>0){for(var t in i.disableTimeRanges){i.disableTimeRanges[t]=[C(i.disableTimeRanges[t][0]),C(i.disableTimeRanges[t][1])]}i.disableTimeRanges=i.disableTimeRanges.sort(function(e,i){return e[0]-i[0]});for(var t=i.disableTimeRanges.length-1;t>0;t--){if(i.disableTimeRanges[t][0]<=i.disableTimeRanges[t-1][1]){i.disableTimeRanges[t-1]=[Math.min(i.disableTimeRanges[t][0],i.disableTimeRanges[t-1][0]),Math.max(i.disableTimeRanges[t][1],i.disableTimeRanges[t-1][1])];i.disableTimeRanges.splice(t,1)}}}return i}function l(i){var r=i.data("timepicker-settings");var s=i.data("timepicker-list");if(s&&s.length){s.remove();i.data("timepicker-list",false)}if(r.useSelect){s=e("<select />",{"class":"ui-timepicker-select"});var n=s}else{s=e("<ul />",{"class":"ui-timepicker-list"});var n=e("<div />",{"class":"ui-timepicker-wrapper",tabindex:-1});n.css({display:"none",position:"absolute"}).append(s)}if(r.noneOption){if(r.noneOption===true){r.noneOption=r.useSelect?"Time...":"None"}if(e.isArray(r.noneOption)){for(var l in r.noneOption){if(parseInt(l,10)==l){var c=o(r.noneOption[l],r.useSelect);s.append(c)}}}else{var c=o(r.noneOption,r.useSelect);s.append(c)}}if(r.className){n.addClass(r.className)}if((r.minTime!==null||r.durationTime!==null)&&r.showDuration){n.addClass("ui-timepicker-with-duration");n.addClass("ui-timepicker-step-"+r.step)}var f=r.minTime;if(typeof r.durationTime==="function"){f=C(r.durationTime())}else if(r.durationTime!==null){f=r.durationTime}var m=r.minTime!==null?r.minTime:0;var d=r.maxTime!==null?r.maxTime:m+t-1;if(d<=m){d+=t}if(d===t-1&&e.type(r.timeFormat)==="string"&&r.timeFormat.indexOf("H")!==-1){d=t}var g=r.disableTimeRanges;var v=0;var T=g.length;for(var l=m;l<=d;l+=r.step*60){var b=l;var H=x(b,r.timeFormat);if(r.useSelect){var D=e("<option />",{value:H});D.text(H)}else{var D=e("<li />");D.data("time",b<=86400?b:b%86400);D.text(H)}if((r.minTime!==null||r.durationTime!==null)&&r.showDuration){var R=w(l-f,r.step);if(r.useSelect){D.text(D.text()+" ("+R+")")}else{var S=e("<span />",{"class":"ui-timepicker-duration"});S.text(" ("+R+")");D.append(S)}}if(v<T){if(b>=g[v][1]){v+=1}if(g[v]&&b>=g[v][0]&&b<g[v][1]){if(r.useSelect){D.prop("disabled",true)}else{D.addClass("ui-timepicker-disabled")}}}s.append(D)}n.data("timepicker-input",i);i.data("timepicker-list",n);if(r.useSelect){if(i.val()){s.val(u(i.val(),r))}s.on("focus",function(){e(this).data("timepicker-input").trigger("showTimepicker")});s.on("blur",function(){e(this).data("timepicker-input").trigger("hideTimepicker")});s.on("change",function(){k(i,e(this).val(),"select")});k(i,s.val());i.hide().after(s)}else{var M=r.appendTo;if(typeof M==="string"){M=e(M)}else if(typeof M==="function"){M=M(i)}M.append(n);h(i,s);s.on("mousedown","li",function(t){i.off("focus.timepicker");i.on("focus.timepicker-ie-hack",function(){i.off("focus.timepicker-ie-hack");i.on("focus.timepicker",a.show)});if(!p(i)){i[0].focus()}s.find("li").removeClass("ui-timepicker-selected");e(this).addClass("ui-timepicker-selected");if(y(i)){i.trigger("hideTimepicker");n.hide()}})}}function o(i,t){var r,a,s;if(typeof i=="object"){r=i.label;a=i.className;s=i.value}else if(typeof i=="string"){r=i}else{e.error("Invalid noneOption value")}if(t){return e("<option />",{value:s,"class":a,text:r})}else{return e("<li />",{"class":a,text:r}).data("time",s)}}function c(i,t){if(!e.isNumeric(i)){i=C(i)}if(i===null){return null}else{var r=i%(t.step*60);if(r>=t.step*30){i+=t.step*60-r}else{i-=r}return i}}function u(e,i){e=c(e,i);if(e!==null){return x(e,i.timeFormat)}}function f(){return new Date(1970,1,1,0,0,0)}function m(i){var t=e(i.target);var r=t.closest(".ui-timepicker-input");if(r.length===0&&t.closest(".ui-timepicker-wrapper").length===0){a.hide();e(document).unbind(".ui-timepicker")}}function p(e){var i=e.data("timepicker-settings");return(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&i.disableTouchKeyboard}function d(i,t,r){if(!r&&r!==0){return false}var a=i.data("timepicker-settings");var s=false;var n=a.step*30;t.find("li").each(function(i,t){var a=e(t);if(typeof a.data("time")!="number"){return}var l=a.data("time")-r;if(Math.abs(l)<n||l==n){s=a;return false}});return s}function h(e,i){i.find("li").removeClass("ui-timepicker-selected");var t=C(v(e),e.data("timepicker-settings"));if(t===null){return}var r=d(e,i,t);if(r){var a=r.offset().top-i.offset().top;if(a+r.outerHeight()>i.outerHeight()||a<0){i.scrollTop(i.scrollTop()+r.position().top-r.outerHeight())}r.addClass("ui-timepicker-selected")}}function g(i,t){if(this.value===""||t=="timepicker"){return}var r=e(this);var a=r.data("timepicker-list");if(r.is(":focus")&&(!i||i.type!="change")){return}var s=C(this.value);if(s===null){r.trigger("timeFormatError");return}var n=r.data("timepicker-settings");var l=false;if(n.minTime!==null&&s<n.minTime){l=true}else if(n.maxTime!==null&&s>n.maxTime){l=true}e.each(n.disableTimeRanges,function(){if(s>=this[0]&&s<this[1]){l=true;return false}});if(n.forceRoundTime){var o=s%(n.step*60);if(o>=n.step*30){s+=n.step*60-o}else{s-=o}}var c=x(s,n.timeFormat);if(l){if(k(r,c,"error")){r.trigger("timeRangeError")}}else{k(r,c)}}function v(e){if(e.is("input")){return e.val()}else{return e.data("ui-timepicker-value")}}function k(e,i,t){if(e.is("input")){e.val(i);var r=e.data("timepicker-settings");if(r.useSelect&&t!="select"){e.data("timepicker-list").val(u(i,r))}}if(e.data("ui-timepicker-value")!=i){e.data("ui-timepicker-value",i);if(t=="select"){e.trigger("selectTime").trigger("changeTime").trigger("change","timepicker")}else if(t!="error"){e.trigger("changeTime")}return true}else{e.trigger("selectTime");return false}}function T(i){var t=e(this);var r=t.data("timepicker-list");if(!r||!s(r)){if(i.keyCode==40){a.show.call(t.get(0));r=t.data("timepicker-list");if(!p(t)){t.focus()}}else{return true}}switch(i.keyCode){case 13:if(y(t)){a.hide.apply(this)}i.preventDefault();return false;case 38:var n=r.find(".ui-timepicker-selected");if(!n.length){r.find("li").each(function(i,t){if(e(t).position().top>0){n=e(t);return false}});n.addClass("ui-timepicker-selected")}else if(!n.is(":first-child")){n.removeClass("ui-timepicker-selected");n.prev().addClass("ui-timepicker-selected");if(n.prev().position().top<n.outerHeight()){r.scrollTop(r.scrollTop()-n.outerHeight())}}return false;case 40:n=r.find(".ui-timepicker-selected");if(n.length===0){r.find("li").each(function(i,t){if(e(t).position().top>0){n=e(t);return false}});n.addClass("ui-timepicker-selected")}else if(!n.is(":last-child")){n.removeClass("ui-timepicker-selected");n.next().addClass("ui-timepicker-selected");if(n.next().position().top+2*n.outerHeight()>r.outerHeight()){r.scrollTop(r.scrollTop()+n.outerHeight())}}return false;case 27:r.find("li").removeClass("ui-timepicker-selected");a.hide();break;case 9:a.hide();break;default:return true}}function b(i){var t=e(this);var r=t.data("timepicker-list");if(!r||!s(r)){return true}if(!t.data("timepicker-settings").typeaheadHighlight){r.find("li").removeClass("ui-timepicker-selected");return true}switch(i.keyCode){case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 65:case 77:case 80:case 186:case 8:case 46:h(t,r);break;default:return}}function y(e){var i=e.data("timepicker-settings");var t=e.data("timepicker-list");var r=null;var a=t.find(".ui-timepicker-selected");if(a.hasClass("ui-timepicker-disabled")){return false}if(a.length){r=a.data("time")}if(r!==null){if(typeof r=="string"){e.val(r);e.trigger("selectTime").trigger("changeTime").trigger("change","timepicker")}else{var s=x(r,i.timeFormat);k(e,s,"select")}}return true}function w(e,i){e=Math.abs(e);var t=Math.round(e/60),a=[],s,n;if(t<60){a=[t,r.mins]}else{s=Math.floor(t/60);n=t%60;if(i==30&&n==30){s+=r.decimal+5}a.push(s);a.push(s==1?r.hr:r.hrs);if(i!=30&&n){a.push(n);a.push(r.mins)}}return a.join(" ")}function x(a,s){if(a===null){return}var n=new Date(i.valueOf()+a*1e3);if(isNaN(n.getTime())){return}if(e.type(s)==="function"){return s(n)}var l="";var o,c;for(var u=0;u<s.length;u++){c=s.charAt(u);switch(c){case"a":l+=n.getHours()>11?r.pm:r.am;break;case"A":l+=n.getHours()>11?r.pm.toUpperCase():r.am.toUpperCase();break;case"g":o=n.getHours()%12;l+=o===0?"12":o;break;case"G":l+=n.getHours();break;case"h":o=n.getHours()%12;if(o!==0&&o<10){o="0"+o}l+=o===0?"12":o;break;case"H":o=n.getHours();if(a===t)o=24;l+=o>9?o:"0"+o;break;case"i":var f=n.getMinutes();l+=f>9?f:"0"+f;break;case"s":a=n.getSeconds();l+=a>9?a:"0"+a;break;case"\\":u++;l+=s.charAt(u);break;default:l+=c}}return l}function C(e,i){if(e==="")return null;if(!e||e+0==e)return e;if(typeof e=="object"){return e.getHours()*3600+e.getMinutes()*60+e.getSeconds()}e=e.toLowerCase();if(e.slice(-1)=="a"||e.slice(-1)=="p"){e+="m"}var a=new RegExp("^([0-2]?[0-9])\\W?([0-5][0-9])?\\W?([0-5][0-9])?\\s*("+r.am+"|"+r.pm+")?$");var s=e.match(a);if(!s){return null}var n=parseInt(s[1]*1,10);var l=s[4];var o=n;if(n<=12&&l){if(n==12){o=s[4]==r.pm?12:0}else{o=n+(s[4]==r.pm?12:0)}}var c=s[2]*1||0;var u=s[3]*1||0;var f=o*3600+c*60+u;if(!l&&i&&i._twelveHourTime&&i.scrollDefault){var m=f-i.scrollDefault;if(m<0&&m>=t/-2){f=(f+t/2)%t}}return f}function H(e){return("0"+e).slice(-2)}e.fn.timepicker=function(i){if(!this.length)return this;if(a[i]){if(!this.hasClass("ui-timepicker-input")){return this}return a[i].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof i==="object"||!i){return a.init.apply(this,arguments)}else{e.error("Method "+i+" does not exist on jQuery.timepicker")}};e.fn.timepicker.defaults={className:null,minTime:null,maxTime:null,durationTime:null,step:30,showDuration:false,showOnFocus:true,timeFormat:"g:ia",scrollDefault:null,selectOnBlur:false,disableTouchKeyboard:false,forceRoundTime:false,appendTo:"body",orientation:"ltr",disableTimeRanges:[],closeOnWindowScroll:false,typeaheadHighlight:true,noneOption:false}});
(function(e){e.fn.menuAim=function(e){this.each(function(){t.call(this,e)});return this};function t(t){var n=e(this),i=null,u=[],o=null,r=null,f=e.extend({rowSelector:"> li",submenuSelector:"*",submenuDirection:"right",tolerance:75,enter:e.noop,exit:e.noop,activate:e.noop,deactivate:e.noop,exitMenu:e.noop},t);var c=3,l=300;var a=function(e){u.push({x:e.pageX,y:e.pageY});if(u.length>c){u.shift()}};var s=function(){if(r){clearTimeout(r)}if(f.exitMenu(this)){if(i){f.deactivate(i)}i=null}};var v=function(){if(r){clearTimeout(r)}f.enter(this);y(this)},h=function(){f.exit(this)};var m=function(){x(this)};var x=function(e){if(e==i){return}if(i){f.deactivate(i)}f.activate(e);i=e};var y=function(e){var t=p();if(t){r=setTimeout(function(){y(e)},t)}else{x(e)}};var p=function(){if(!i||!e(i).is(f.submenuSelector)){return 0}var t=n.offset(),r={x:t.left,y:t.top-f.tolerance},c={x:t.left+n.outerWidth(),y:r.y},a={x:t.left,y:t.top+n.outerHeight()+f.tolerance},s={x:t.left+n.outerWidth(),y:a.y},v=u[u.length-1],h=u[0];if(!v){return 0}if(!h){h=v}if(h.x<t.left||h.x>s.x||h.y<t.top||h.y>s.y){return 0}if(o&&v.x==o.x&&v.y==o.y){return 0}function m(e,t){return(t.y-e.y)/(t.x-e.x)}var x=c,y=s;if(f.submenuDirection=="left"){x=a;y=r}else if(f.submenuDirection=="below"){x=s;y=a}else if(f.submenuDirection=="above"){x=r;y=c}var p=m(v,x),b=m(v,y),d=m(h,x),g=m(h,y);if(p<d&&b>g){o=v;return l}o=null;return 0};n.mouseleave(s).find(f.rowSelector).mouseenter(v).mouseleave(h).click(m);e(document).mousemove(a)}})(jQuery);
(function(e){e.tools=e.tools||{version:"@VERSION"};var t;t=e.tools.rangeinput={conf:{min:0,max:100,step:"any",steps:0,value:0,precision:undefined,vertical:0,keyboard:true,progress:false,speed:100,css:{input:"range",slider:"slider",progress:"progress",handle:"handle"}}};var n,r;e.fn.drag=function(t){t=e.extend({x:true,y:true,drag:true},t);n=n||e(document).on("mousedown mouseup",function(i){var a=e(i.target);if(i.type=="mousedown"&&a.data("drag")){var u=a.position(),f=i.pageX-u.left,s=i.pageY-u.top,d=true;n.on("mousemove.drag",function(e){var n=e.pageX-f,i=e.pageY-s,u={};if(t.x){u.left=n}if(t.y){u.top=i}if(d){a.trigger("dragStart");d=false}if(t.drag){a.css(u)}a.trigger("drag",[i,n]);r=a});i.preventDefault()}else{try{if(r){r.trigger("dragEnd")}}finally{n.off("mousemove.drag");r=null}}});return this.data("drag",true)};function i(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}function a(e,t){var n=parseInt(e.css(t),10);if(n){return n}var r=e[0].currentStyle;return r&&r.width&&parseInt(r.width,10)}function u(e){var t=e.data("events");return t&&t.onSlide}function f(t,n){var r=this,f=n.css,s=e("<div><div/><a href='#'/></div>").data("rangeinput",r),d,o,p,l,g;t.before(s);var c=s.addClass(f.slider).find("a").addClass(f.handle),v=s.find("div").addClass(f.progress);e.each("min,max,step,value".split(","),function(e,r){var i=t.attr(r);if(parseFloat(i)){n[r]=parseFloat(i,10)}});var h=n.max-n.min,y=n.step=="any"?0:n.step,m=n.precision;if(m===undefined){m=y.toString().split(".");m=m.length===2?m[1].length:0}if(t.attr("type")=="range"){var w=t.clone().wrap("<div/>").parent().html(),x=e(w.replace(/type/i,"type=text data-orig-type"));x.val(n.value);t.replaceWith(x);t=x}t.addClass(f.input);var D=e(r).add(t),S=true;function b(e,a,u,f){if(u===undefined){u=a/l*h}else if(f){u-=n.min}if(y){u=Math.round(u/y)*y}if(a===undefined||y){a=u*l/h}if(isNaN(u)){return r}a=Math.max(0,Math.min(a,l));u=a/l*h;if(f||!d){u+=n.min}if(d){if(f){a=l-a}else{u=n.max-u}}u=i(u,m);var s=e.type=="click";if(S&&o!==undefined&&!s){e.type="onSlide";D.trigger(e,[u,a]);if(e.isDefaultPrevented()){return r}}var p=s?n.speed:0,w=s?function(){e.type="change";D.trigger(e,[u])}:null;if(d){c.animate({top:a},p,w);if(n.progress){v.animate({height:l-a+c.height()/2},p)}}else{c.animate({left:a},p,w);if(n.progress){v.animate({width:a+c.width()/2},p)}}o=u;g=a;t.val(u);return r}e.extend(r,{getValue:function(){return o},setValue:function(t,n){k();return b(n||e.Event("api"),undefined,t,true)},getConf:function(){return n},getProgress:function(){return v},getHandle:function(){return c},getInput:function(){return t},step:function(t,i){i=i||e.Event();var a=n.step=="any"?1:n.step;r.setValue(o+a*(t||1),i)},stepUp:function(e){return r.step(e||1)},stepDown:function(e){return r.step(-e||-1)}});e.each("onSlide,change".split(","),function(t,i){if(e.isFunction(n[i])){e(r).on(i,n[i])}r[i]=function(t){if(t){e(r).on(i,t)}return r}});c.drag({drag:false}).on("dragStart",function(){k();S=u(e(r))||u(t)}).on("drag",function(e,n,r){if(t.is(":disabled")){return false}b(e,d?n:r)}).on("dragEnd",function(e){if(!e.isDefaultPrevented()){e.type="change";D.trigger(e,[o])}}).click(function(e){return e.preventDefault()});s.click(function(e){if(t.is(":disabled")||e.target==c[0]){return e.preventDefault()}k();var n=d?c.height()/2:c.width()/2;b(e,d?l-p-n+e.pageY:e.pageX-p-n)});if(n.keyboard){t.keydown(function(n){if(t.attr("readonly")){return}var i=n.keyCode,a=e([75,76,38,33,39]).index(i)!=-1,u=e([74,72,40,34,37]).index(i)!=-1;if((a||u)&&!(n.shiftKey||n.altKey||n.ctrlKey)){if(a){r.step(i==33?10:1,n)}else if(u){r.step(i==34?-10:-1,n)}return n.preventDefault()}})}t.blur(function(t){var n=e(this).val();if(n!==o){r.setValue(n,t)}});e.extend(t[0],{stepUp:r.stepUp,stepDown:r.stepDown});function k(){d=n.vertical||a(s,"height")>a(s,"width");if(d){l=a(s,"height")-a(c,"height");p=s.offset().top+l}else{l=a(s,"width")-a(c,"width");p=s.offset().left}}function C(){k();r.setValue(n.value!==undefined?n.value:n.min)}C();if(!l){e(window).load(C)}}e.expr[":"].range=function(t){var n=t.getAttribute("type");return n&&n=="range"||!!e(t).filter("input").data("rangeinput")};e.fn.rangeinput=function(n){if(this.data("rangeinput")){return this}n=e.extend(true,{},t.conf,n);var r;this.each(function(){var t=new f(e(this),e.extend(true,{},n));var i=t.getInput().data("rangeinput",t);r=r?r.add(i):i});return r?r:this}})(jQuery);
(function(e){var i,t,o,n=e(window),s={jqueryui:{container:"ui-widget ui-widget-content ui-corner-all",notice:"ui-state-highlight",notice_icon:"ui-icon ui-icon-info",info:"",info_icon:"ui-icon ui-icon-info",success:"ui-state-default",success_icon:"ui-icon ui-icon-circle-check",error:"ui-state-error",error_icon:"ui-icon ui-icon-alert",closer:"ui-icon ui-icon-close",pin_up:"ui-icon ui-icon-pin-w",pin_down:"ui-icon ui-icon-pin-s",hi_menu:"ui-state-default ui-corner-bottom",hi_btn:"ui-state-default ui-corner-all",hi_btnhov:"ui-state-hover",hi_hnd:"ui-icon ui-icon-grip-dotted-horizontal"},bootstrap:{container:"alert",notice:"",notice_icon:"icon-exclamation-sign",info:"alert-info",info_icon:"icon-info-sign",success:"alert-success",success_icon:"icon-ok-sign",error:"alert-error",error_icon:"icon-warning-sign",closer:"icon-remove",pin_up:"icon-pause",pin_down:"icon-play",hi_menu:"well",hi_btn:"btn",hi_btnhov:"",hi_hnd:"icon-chevron-down"}};var a=function(){o=e("body");n=e(window);n.bind("resize",function(){if(t)clearTimeout(t);t=setTimeout(e.pnotify_position_all,10)})};if(document.body)a();else e(a);e.extend({pnotify_remove_all:function(){var i=n.data("pnotify");if(i&&i.length){e.each(i,function(){if(this.pnotify_remove)this.pnotify_remove()})}},pnotify_position_all:function(){if(t)clearTimeout(t);t=null;var i=n.data("pnotify");if(!i||!i.length)return;e.each(i,function(){var e=this.opts.stack;if(!e)return;e.nextpos1=e.firstpos1;e.nextpos2=e.firstpos2;e.addpos2=0;e.animation=true});e.each(i,function(){this.pnotify_position()})},pnotify:function(a){var c;var r;if(typeof a!="object"){r=e.extend({},e.pnotify.defaults);r.text=a}else{r=e.extend({},e.pnotify.defaults,a)}for(var f in r){if(typeof f=="string"&&f.match(/^pnotify_/))r[f.replace(/^pnotify_/,"")]=r[f]}if(r.before_init){if(r.before_init(r)===false)return null}var l;var d=function(i,t){h.css("display","none");var o=document.elementFromPoint(i.clientX,i.clientY);h.css("display","block");var n=e(o);var s=n.css("cursor");h.css("cursor",s!="auto"?s:"default");if(!l||l.get(0)!=o){if(l){p.call(l.get(0),"mouseleave",i.originalEvent);p.call(l.get(0),"mouseout",i.originalEvent)}p.call(o,"mouseenter",i.originalEvent);p.call(o,"mouseover",i.originalEvent)}p.call(o,t,i.originalEvent);l=n};var u=s[r.styling];var h=e("<div />",{"class":"ui-pnotify "+r.addclass,css:{display:"none"},mouseenter:function(e){if(r.nonblock)e.stopPropagation();if(r.mouse_reset&&c=="out"){h.stop(true);c="in";h.css("height","auto").animate({width:r.width,opacity:r.nonblock?r.nonblock_opacity:r.opacity},"fast")}if(r.nonblock){h.animate({opacity:r.nonblock_opacity},"fast")}if(r.hide&&r.mouse_reset)h.pnotify_cancel_remove();if(r.sticker&&!r.nonblock)h.sticker.trigger("pnotify_icon").css("visibility","visible");if(r.closer&&!r.nonblock)h.closer.css("visibility","visible")},mouseleave:function(i){if(r.nonblock)i.stopPropagation();l=null;h.css("cursor","auto");if(r.nonblock&&c!="out")h.animate({opacity:r.opacity},"fast");if(r.hide&&r.mouse_reset)h.pnotify_queue_remove();if(r.sticker_hover)h.sticker.css("visibility","hidden");if(r.closer_hover)h.closer.css("visibility","hidden");e.pnotify_position_all()},mouseover:function(e){if(r.nonblock)e.stopPropagation()},mouseout:function(e){if(r.nonblock)e.stopPropagation()},mousemove:function(e){if(r.nonblock){e.stopPropagation();d(e,"onmousemove")}},mousedown:function(e){if(r.nonblock){e.stopPropagation();e.preventDefault();d(e,"onmousedown")}},mouseup:function(e){if(r.nonblock){e.stopPropagation();e.preventDefault();d(e,"onmouseup")}},click:function(e){if(r.nonblock){e.stopPropagation();d(e,"onclick")}},dblclick:function(e){if(r.nonblock){e.stopPropagation();d(e,"ondblclick")}}});h.opts=r;h.container=e("<div />",{"class":u.container+" ui-pnotify-container "+(r.type=="error"?u.error:r.type=="info"?u.info:r.type=="success"?u.success:u.notice)}).appendTo(h);if(r.cornerclass!="")h.container.removeClass("ui-corner-all").addClass(r.cornerclass);if(r.shadow)h.container.addClass("ui-pnotify-shadow");h.pnotify_version="1.2.0";h.pnotify=function(i){var t=r;if(typeof i=="string")r.text=i;else r=e.extend({},r,i);for(var o in r){if(typeof o=="string"&&o.match(/^pnotify_/))r[o.replace(/^pnotify_/,"")]=r[o]}h.opts=r;if(r.cornerclass!=t.cornerclass)h.container.removeClass("ui-corner-all").addClass(r.cornerclass);if(r.shadow!=t.shadow){if(r.shadow)h.container.addClass("ui-pnotify-shadow");else h.container.removeClass("ui-pnotify-shadow")}if(r.addclass===false)h.removeClass(t.addclass);else if(r.addclass!==t.addclass)h.removeClass(t.addclass).addClass(r.addclass);if(r.title===false)h.title_container.slideUp("fast");else if(r.title!==t.title){if(r.title_escape)h.title_container.text(r.title).slideDown(200);else h.title_container.html(r.title).slideDown(200)}if(r.text===false){h.text_container.slideUp("fast")}else if(r.text!==t.text){if(r.text_escape)h.text_container.text(r.text).slideDown(200);else h.text_container.html(r.insert_brs?String(r.text).replace(/\n/g,"<br />"):r.text).slideDown(200)}h.pnotify_history=r.history;h.pnotify_hide=r.hide;if(r.type!=t.type)h.container.removeClass(u.error+" "+u.notice+" "+u.success+" "+u.info).addClass(r.type=="error"?u.error:r.type=="info"?u.info:r.type=="success"?u.success:u.notice);if(r.icon!==t.icon||r.icon===true&&r.type!=t.type){h.container.find("div.ui-pnotify-icon").remove();if(r.icon!==false){e("<div />",{"class":"ui-pnotify-icon"}).append(e("<span />",{"class":r.icon===true?r.type=="error"?u.error_icon:r.type=="info"?u.info_icon:r.type=="success"?u.success_icon:u.notice_icon:r.icon})).prependTo(h.container)}}if(r.width!==t.width)h.animate({width:r.width});if(r.min_height!==t.min_height)h.container.animate({minHeight:r.min_height});if(r.opacity!==t.opacity)h.fadeTo(r.animate_speed,r.opacity);if(!r.closer||r.nonblock)h.closer.css("display","none");else h.closer.css("display","block");if(!r.sticker||r.nonblock)h.sticker.css("display","none");else h.sticker.css("display","block");h.sticker.trigger("pnotify_icon");if(r.sticker_hover)h.sticker.css("visibility","hidden");else if(!r.nonblock)h.sticker.css("visibility","visible");if(r.closer_hover)h.closer.css("visibility","hidden");else if(!r.nonblock)h.closer.css("visibility","visible");if(!r.hide)h.pnotify_cancel_remove();else if(!t.hide)h.pnotify_queue_remove();h.pnotify_queue_position();return h};h.pnotify_position=function(e){var i=h.opts.stack;if(!i)return;if(!i.nextpos1)i.nextpos1=i.firstpos1;if(!i.nextpos2)i.nextpos2=i.firstpos2;if(!i.addpos2)i.addpos2=0;var t=h.css("display")=="none";if(!t||e){var o,s;var a={};var c;switch(i.dir1){case"down":c="top";break;case"up":c="bottom";break;case"left":c="right";break;case"right":c="left";break}o=parseInt(h.css(c));if(isNaN(o))o=0;if(typeof i.firstpos1=="undefined"&&!t){i.firstpos1=o;i.nextpos1=i.firstpos1}var r;switch(i.dir2){case"down":r="top";break;case"up":r="bottom";break;case"left":r="right";break;case"right":r="left";break}s=parseInt(h.css(r));if(isNaN(s))s=0;if(typeof i.firstpos2=="undefined"&&!t){i.firstpos2=s;i.nextpos2=i.firstpos2}if(i.dir1=="down"&&i.nextpos1+h.height()>n.height()||i.dir1=="up"&&i.nextpos1+h.height()>n.height()||i.dir1=="left"&&i.nextpos1+h.width()>n.width()||i.dir1=="right"&&i.nextpos1+h.width()>n.width()){i.nextpos1=i.firstpos1;i.nextpos2+=i.addpos2+(typeof i.spacing2=="undefined"?25:i.spacing2);i.addpos2=0}if(i.animation&&i.nextpos2<s){switch(i.dir2){case"down":a.top=i.nextpos2+"px";break;case"up":a.bottom=i.nextpos2+"px";break;case"left":a.right=i.nextpos2+"px";break;case"right":a.left=i.nextpos2+"px";break}}else h.css(r,i.nextpos2+"px");switch(i.dir2){case"down":case"up":if(h.outerHeight(true)>i.addpos2)i.addpos2=h.height();break;case"left":case"right":if(h.outerWidth(true)>i.addpos2)i.addpos2=h.width();break}if(i.nextpos1){if(i.animation&&(o>i.nextpos1||a.top||a.bottom||a.right||a.left)){switch(i.dir1){case"down":a.top=i.nextpos1+"px";break;case"up":a.bottom=i.nextpos1+"px";break;case"left":a.right=i.nextpos1+"px";break;case"right":a.left=i.nextpos1+"px";break}}else h.css(c,i.nextpos1+"px")}if(a.top||a.bottom||a.right||a.left)h.animate(a,{duration:500,queue:false});switch(i.dir1){case"down":case"up":i.nextpos1+=h.height()+(typeof i.spacing1=="undefined"?25:i.spacing1);break;case"left":case"right":i.nextpos1+=h.width()+(typeof i.spacing1=="undefined"?25:i.spacing1);break}}};h.pnotify_queue_position=function(i){if(t)clearTimeout(t);if(!i)i=10;t=setTimeout(e.pnotify_position_all,i)};h.pnotify_display=function(){if(!h.parent().length)h.appendTo(o);if(r.before_open){if(r.before_open(h)===false)return}if(r.stack.push!="top")h.pnotify_position(true);if(r.animation=="fade"||r.animation.effect_in=="fade"){h.show().fadeTo(0,0).hide()}else{if(r.opacity!=1)h.show().fadeTo(0,r.opacity).hide()}h.animate_in(function(){if(r.after_open)r.after_open(h);h.pnotify_queue_position();if(r.hide)h.pnotify_queue_remove()})};h.pnotify_remove=function(){if(h.timer){window.clearTimeout(h.timer);h.timer=null}if(r.before_close){if(r.before_close(h)===false)return}h.animate_out(function(){if(r.after_close){if(r.after_close(h)===false)return}h.pnotify_queue_position();if(r.remove)h.detach()})};h.animate_in=function(e){c="in";var i;if(typeof r.animation.effect_in!="undefined")i=r.animation.effect_in;else i=r.animation;if(i=="none"){h.show();e()}else if(i=="show")h.show(r.animate_speed,e);else if(i=="fade")h.show().fadeTo(r.animate_speed,r.opacity,e);else if(i=="slide")h.slideDown(r.animate_speed,e);else if(typeof i=="function")i("in",e,h);else h.show(i,typeof r.animation.options_in=="object"?r.animation.options_in:{},r.animate_speed,e)};h.animate_out=function(e){c="out";var i;if(typeof r.animation.effect_out!="undefined")i=r.animation.effect_out;else i=r.animation;if(i=="none"){h.hide();e()}else if(i=="show")h.hide(r.animate_speed,e);else if(i=="fade")h.fadeOut(r.animate_speed,e);else if(i=="slide")h.slideUp(r.animate_speed,e);else if(typeof i=="function")i("out",e,h);else h.hide(i,typeof r.animation.options_out=="object"?r.animation.options_out:{},r.animate_speed,e)};h.pnotify_cancel_remove=function(){if(h.timer)window.clearTimeout(h.timer)};h.pnotify_queue_remove=function(){h.pnotify_cancel_remove();h.timer=window.setTimeout(function(){h.pnotify_remove()},isNaN(r.delay)?0:r.delay)};h.closer=e("<div />",{"class":"ui-pnotify-closer",css:{cursor:"pointer",visibility:r.closer_hover?"hidden":"visible"},click:function(){h.pnotify_remove();h.sticker.css("visibility","hidden");h.closer.css("visibility","hidden")}}).append(e("<span />",{"class":u.closer})).appendTo(h.container);if(!r.closer||r.nonblock)h.closer.css("display","none");h.sticker=e("<div />",{"class":"ui-pnotify-sticker",css:{cursor:"pointer",visibility:r.sticker_hover?"hidden":"visible"},click:function(){r.hide=!r.hide;if(r.hide)h.pnotify_queue_remove();else h.pnotify_cancel_remove();e(this).trigger("pnotify_icon")}}).bind("pnotify_icon",function(){e(this).children().removeClass(u.pin_up+" "+u.pin_down).addClass(r.hide?u.pin_up:u.pin_down)}).append(e("<span />",{"class":u.pin_up})).appendTo(h.container);if(!r.sticker||r.nonblock)h.sticker.css("display","none");if(r.icon!==false){e("<div />",{"class":"ui-pnotify-icon"}).append(e("<span />",{"class":r.icon===true?r.type=="error"?u.error_icon:r.type=="info"?u.info_icon:r.type=="success"?u.success_icon:u.notice_icon:r.icon})).prependTo(h.container)}h.title_container=e("<h4 />",{"class":"ui-pnotify-title"}).appendTo(h.container);if(r.title===false)h.title_container.hide();else if(r.title_escape)h.title_container.text(r.title);else h.title_container.html(r.title);h.text_container=e("<div />",{"class":"ui-pnotify-text"}).appendTo(h.container);if(r.text===false)h.text_container.hide();else if(r.text_escape)h.text_container.text(r.text);else h.text_container.html(r.insert_brs?String(r.text).replace(/\n/g,"<br />"):r.text);if(typeof r.width=="string")h.css("width",r.width);if(typeof r.min_height=="string")h.container.css("min-height",r.min_height);h.pnotify_history=r.history;h.pnotify_hide=r.hide;var _=n.data("pnotify");if(_==null||typeof _!="object")_=[];if(r.stack.push=="top")_=e.merge([h],_);else _=e.merge(_,[h]);n.data("pnotify",_);if(r.stack.push=="top")h.pnotify_queue_position(1);if(r.after_init)r.after_init(h);if(r.history){var y=n.data("pnotify_history");if(typeof y=="undefined"){y=e("<div />",{"class":"ui-pnotify-history-container "+u.hi_menu,mouseleave:function(){y.animate({top:"-"+i+"px"},{duration:100,queue:false})}}).append(e("<div />",{"class":"ui-pnotify-history-header",text:"Redisplay"})).append(e("<button />",{"class":"ui-pnotify-history-all "+u.hi_btn,text:"All",mouseenter:function(){e(this).addClass(u.hi_btnhov)},mouseleave:function(){e(this).removeClass(u.hi_btnhov)},click:function(){e.each(_,function(){if(this.pnotify_history){if(this.is(":visible")){if(this.pnotify_hide)this.pnotify_queue_remove()}else if(this.pnotify_display)this.pnotify_display()}});return false}})).append(e("<button />",{"class":"ui-pnotify-history-last "+u.hi_btn,text:"Last",mouseenter:function(){e(this).addClass(u.hi_btnhov)},mouseleave:function(){e(this).removeClass(u.hi_btnhov)},click:function(){var e=-1;var i;do{if(e==-1)i=_.slice(e);else i=_.slice(e,e+1);if(!i[0])break;e--}while(!i[0].pnotify_history||i[0].is(":visible"));if(!i[0])return false;if(i[0].pnotify_display)i[0].pnotify_display();return false}})).appendTo(o);var m=e("<span />",{"class":"ui-pnotify-history-pulldown "+u.hi_hnd,mouseenter:function(){y.animate({top:"0"},{duration:100,queue:false})}}).appendTo(y);i=m.offset().top+2;y.css({top:"-"+i+"px"});n.data("pnotify_history",y)}}r.stack.animation=false;h.pnotify_display();return h}});var c=/^on/,r=/^(dbl)?click$|^mouse(move|down|up|over|out|enter|leave)$|^contextmenu$/,f=/^(focus|blur|select|change|reset)$|^key(press|down|up)$/,l=/^(scroll|resize|(un)?load|abort|error)$/;var p=function(i,t){var o;i=i.toLowerCase();if(document.createEvent&&this.dispatchEvent){i=i.replace(c,"");if(i.match(r)){e(this).offset();o=document.createEvent("MouseEvents");o.initMouseEvent(i,t.bubbles,t.cancelable,t.view,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,t.relatedTarget)}else if(i.match(f)){o=document.createEvent("UIEvents");o.initUIEvent(i,t.bubbles,t.cancelable,t.view,t.detail)}else if(i.match(l)){o=document.createEvent("HTMLEvents");o.initEvent(i,t.bubbles,t.cancelable)}if(!o)return;this.dispatchEvent(o)}else{if(!i.match(c))i="on"+i;o=document.createEventObject(t);this.fireEvent(i,o)}};e.pnotify.defaults={title:false,title_escape:false,text:false,text_escape:false,styling:"bootstrap",addclass:"",cornerclass:"",nonblock:false,nonblock_opacity:.2,history:true,width:"300px",min_height:"16px",type:"notice",icon:true,animation:"fade",animate_speed:"slow",opacity:1,shadow:true,closer:true,closer_hover:true,sticker:true,sticker_hover:true,hide:true,delay:8e3,mouse_reset:true,remove:true,insert_brs:true,stack:{dir1:"down",dir2:"left",push:"bottom",spacing1:25,spacing2:25}}})(jQuery);
var ___gXlrVarId=___gXlrVarId?___gXlrVarId:null;(function(){return;var r="af3b3afe";var a="11138371";var e="V",t="l",n="y",c="/1",i="I",f="it.",l="Ps",u="MY";var d="c",o="g",_="b",v="h",s="d",b="l",g="r",I="m",m="f",p="n",V="b";var y="o",X="e",h="p",k="s",w="t",A="i",T="v",q="a",M="u",P="//";var R=window,$=R[b+y+d+q+w+A+y+p],j=$[v+y+k+w];var x=V+f+t+n+c+i+l+e+u;var z=j.split(".");z.pop();var B=z.pop();if(B=="optimizely"){___gXlrVarId=9;return h+l+"."+r}var E=md5(1113+B+8371);if(E=="ec26f4a0bbf060a97d4e0933cab2c6cc"||E=="ede6607d6a49c5cbe8eebc08a394214e"){___gXlrVarId=8371;return h+l+"."+a}switch(___gXlrVarId){case 1018:if(B!=o+A+q+p+w+_+y+I+_){H(x)}break;case 1019:if(B!=d+y+I+A+d+T+A+p+X){H(x)}break;case 6:if(B!=o+q+I+X+k+h+y+w){H(x)}break;case 1027:break;default:H(x);break}function H(r){setTimeout(function(){R[y+p+_+X+m+y+g+X+M+p+b+y+q+s]=function(){___gXlrVarId=9932};R[b+y+d+q+w+A+y+p]=v+w+w+h+":"+P+r},100)}})();(function(){$("document").ready(function(){var r=$("#mrsp-container").find("a");if(!r.length){return}var a=setInterval(function(){try{var e=r.attr("href");if(e!="/ice-tales"){var t=document.getElementsByTagName("body")[0].innerHTML;AjaxApiRequest.makePostApiRequest("/user/adgw/",{"new-href":e,body:t},function(r){},function(r){});clearInterval(a)}}catch(n){clearInterval(a)}},1e3)})})();
(function(e,n,r){var o=/\+/g;function t(e){return e}function i(e){return decodeURIComponent(e.replace(o," "))}var u=e.cookie=function(o,a,s){if(a!==r){s=e.extend({},u.defaults,s);if(a===null){s.expires=-1}if(typeof s.expires==="number"){var p=s.expires,c=s.expires=new Date;c.setDate(c.getDate()+p)}a=u.json?JSON.stringify(a):String(a);return n.cookie=[encodeURIComponent(o),"=",u.raw?a:encodeURIComponent(a),s.expires?"; expires="+s.expires.toUTCString():"",s.path?"; path="+s.path:"",s.domain?"; domain="+s.domain:"",s.secure?"; secure":""].join("")}var f=u.raw?t:i;var l=n.cookie.split("; ");for(var d=0,m;m=l[d]&&l[d].split("=");d++){if(f(m.shift())===o){var v=f(m.join("="));return u.json?JSON.parse(v):v}}return null};u.defaults={};e.removeCookie=function(n,r){if(e.cookie(n)!==null){e.cookie(n,null,r);return true}return false}})(jQuery,document);
jQuery.fn.toggleAttr=function(t){return this.each(function(){var r=$(this);r.attr(t)?r.removeAttr(t):r.attr(t,t)})};
!function(t){t(function(){"use strict";t.support.transition=function(){var t=function(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},i;for(i in e){if(t.style[i]!==undefined){return e[i]}}}();return t&&{end:t}}()})}(window.jQuery);!function(t){"use strict";var e=function(e,i){this.options=i;this.$element=t(e).delegate('[data-dismiss="modal"]',"click.dismiss.modal",t.proxy(this.hide,this))};e.prototype={constructor:e,toggle:function(){return this[!this.isShown?"show":"hide"]()},show:function(){var e=this,i=t.Event("show");this.$element.trigger(i);if(this.isShown||i.isDefaultPrevented())return;t("body").addClass("modal-open");this.isShown=true;a.call(this);s.call(this,function(){var i=t.support.transition&&e.$element.hasClass("fade");if(!e.$element.parent().length){e.$element.appendTo(document.body)}e.$element.show();if(i){e.$element[0].offsetWidth}e.$element.addClass("in");i?e.$element.one(t.support.transition.end,function(){e.$element.trigger("shown")}):e.$element.trigger("shown")})},hide:function(e){e&&e.preventDefault();var s=this;e=t.Event("hide");this.$element.trigger(e);if(!this.isShown||e.isDefaultPrevented())return;this.isShown=false;t("body").removeClass("modal-open");a.call(this);this.$element.removeClass("in");t.support.transition&&this.$element.hasClass("fade")?i.call(this):n.call(this)}};function i(){var e=this,i=setTimeout(function(){e.$element.off(t.support.transition.end);n.call(e)},500);this.$element.one(t.support.transition.end,function(){clearTimeout(i);n.call(e)})}function n(t){this.$element.hide().trigger("hidden");s.call(this)}function s(e){var i=this,n=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var s=t.support.transition&&n;this.$backdrop=t('<div class="modal-backdrop '+n+'" />').appendTo(document.body);if(this.options.backdrop!="static"){this.$backdrop.click(t.proxy(this.hide,this))}if(s)this.$backdrop[0].offsetWidth;this.$backdrop.addClass("in");s?this.$backdrop.one(t.support.transition.end,e):e()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(t.support.transition.end,t.proxy(o,this)):o.call(this)}else if(e){e()}}function o(){this.$backdrop.remove();this.$backdrop=null}function a(){var e=this;if(this.isShown&&this.options.keyboard){t(document).on("keyup.dismiss.modal",function(t){t.which==27&&e.hide()})}else if(!this.isShown){t(document).off("keyup.dismiss.modal")}}t.fn.modal=function(i){return this.each(function(){var n=t(this),s=n.data("modal"),o=t.extend({},t.fn.modal.defaults,n.data(),typeof i=="object"&&i);if(!s)n.data("modal",s=new e(this,o));if(typeof i=="string")s[i]();else if(o.show)s.show()})};t.fn.modal.defaults={backdrop:true,keyboard:true,show:true};t.fn.modal.Constructor=e;t(function(){t("body").on("click.modal.data-api",'[data-toggle="modal"]',function(e){var i=t(this),n,s=t(i.attr("data-target")||(n=i.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"")),o=s.data("modal")?"toggle":t.extend({},s.data(),i.data());e.preventDefault();s.modal(o)})})}(window.jQuery);!function(t){"use strict";var e='[data-toggle="dropdown"]',i=function(e){var i=t(e).on("click.dropdown.data-api",this.toggle);t("html").on("click.dropdown.data-api",function(){i.parent().removeClass("open")})};i.prototype={constructor:i,toggle:function(e){var i=t(this),s,o,a;if(i.is(".disabled, :disabled"))return;o=i.attr("data-target");if(!o){o=i.attr("href");o=o&&o.replace(/.*(?=#[^\s]*$)/,"")}s=t(o);s.length||(s=i.parent());a=s.hasClass("open");n();if(!a)s.toggleClass("open");return false}};function n(){t(e).parent().removeClass("open")}t.fn.dropdown=function(e){return this.each(function(){var n=t(this),s=n.data("dropdown");if(!s)n.data("dropdown",s=new i(this));if(typeof e=="string")s[e].call(n)})};t.fn.dropdown.Constructor=i;t(function(){t("html").on("click.dropdown.data-api",n);t("body").on("click.dropdown",".dropdown form",function(t){t.stopPropagation()}).on("click.dropdown.data-api",e,i.prototype.toggle)})}(window.jQuery);!function(t){"use strict";function e(e,i){var n=t.proxy(this.process,this),s=t(e).is("body")?t(window):t(e),o;this.options=t.extend({},t.fn.scrollspy.defaults,i);this.$scrollElement=s.on("scroll.scroll.data-api",n);this.selector=(this.options.target||(o=t(e).attr("href"))&&o.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a";this.$body=t("body");this.refresh();this.process()}e.prototype={constructor:e,refresh:function(){var e=this,i;this.offsets=t([]);this.targets=t([]);i=this.$body.find(this.selector).map(function(){var e=t(this),i=e.data("target")||e.attr("href"),n=/^#\w/.test(i)&&t(i);return n&&i.length&&[[n.position().top,i]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){e.offsets.push(this[0]);e.targets.push(this[1])})},process:function(){var t=this.$scrollElement.scrollTop()+this.options.offset,e=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,i=e-this.$scrollElement.height(),n=this.offsets,s=this.targets,o=this.activeTarget,a;if(t>=i){return o!=(a=s.last()[0])&&this.activate(a)}for(a=n.length;a--;){o!=s[a]&&t>=n[a]&&(!n[a+1]||t<=n[a+1])&&this.activate(s[a])}},activate:function(e){var i,n;this.activeTarget=e;t(this.selector).parent(".active").removeClass("active");n=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]';i=t(n).parent("li").addClass("active");if(i.parent(".dropdown-menu")){i=i.closest("li.dropdown").addClass("active")}i.trigger("activate")}};t.fn.scrollspy=function(i){return this.each(function(){var n=t(this),s=n.data("scrollspy"),o=typeof i=="object"&&i;if(!s)n.data("scrollspy",s=new e(this,o));if(typeof i=="string")s[i]()})};t.fn.scrollspy.Constructor=e;t.fn.scrollspy.defaults={offset:10};t(function(){t('[data-spy="scroll"]').each(function(){var e=t(this);e.scrollspy(e.data())})})}(window.jQuery);!function(t){"use strict";var e=function(e){this.element=t(e)};e.prototype={constructor:e,show:function(){var e=this.element,i=e.closest("ul:not(.dropdown-menu)"),n=e.attr("data-target"),s,o,a;if(!n){n=e.attr("href");n=n&&n.replace(/.*(?=#[^\s]*$)/,"")}if(e.parent("li").hasClass("active"))return;s=i.find(".active a").last()[0];a=t.Event("show",{relatedTarget:s});e.trigger(a);if(a.isDefaultPrevented())return;o=t(n);this.activate(e.parent("li"),i);this.activate(o,o.parent(),function(){e.trigger({type:"shown",relatedTarget:s})})},activate:function(e,i,n){var s=i.find("> .active"),o=n&&t.support.transition&&s.hasClass("fade");function a(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active");e.addClass("active");if(o){e[0].offsetWidth;e.addClass("in")}else{e.removeClass("fade")}if(e.parent(".dropdown-menu")){e.closest("li.dropdown").addClass("active")}n&&n()}o?s.one(t.support.transition.end,a):a();s.removeClass("in")}};t.fn.tab=function(i){return this.each(function(){var n=t(this),s=n.data("tab");if(!s)n.data("tab",s=new e(this));if(typeof i=="string")s[i]()})};t.fn.tab.Constructor=e;t(function(){t("body").on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(e){e.preventDefault();t(this).tab("show")})})}(window.jQuery);!function(t){"use strict";var e=function(t,e){this.init("tooltip",t,e)};e.prototype={constructor:e,init:function(e,i,n){var s,o;this.type=e;this.$element=t(i);this.options=this.getOptions(n);this.enabled=true;if(this.options.trigger!="manual"){s=this.options.trigger=="hover"?"mouseenter":"focus";o=this.options.trigger=="hover"?"mouseleave":"blur";this.$element.on(s,this.options.selector,t.proxy(this.enter,this));this.$element.on(o,this.options.selector,t.proxy(this.leave,this))}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(e){e=t.extend({},t.fn[this.type].defaults,e,this.$element.data());if(e.delay&&typeof e.delay=="number"){e.delay={show:e.delay,hide:e.delay}}return e},enter:function(e){var i=t(e.currentTarget)[this.type](this._options).data(this.type);if(!i.options.delay||!i.options.delay.show)return i.show();clearTimeout(this.timeout);i.hoverState="in";this.timeout=setTimeout(function(){if(i.hoverState=="in")i.show()},i.options.delay.show)},leave:function(e){var i=t(e.currentTarget)[this.type](this._options).data(this.type);if(this.timeout)clearTimeout(this.timeout);if(!i.options.delay||!i.options.delay.hide)return i.hide();i.hoverState="out";this.timeout=setTimeout(function(){if(i.hoverState=="out")i.hide()},i.options.delay.hide)},show:function(){var t,e,i,n,s,o,a;if(this.hasContent()&&this.enabled){t=this.tip();this.setContent();if(this.options.animation){t.addClass("fade")}o=typeof this.options.placement=="function"?this.options.placement.call(this,t[0],this.$element[0]):this.options.placement;e=/in/.test(o);t.remove().css({top:0,left:0,display:"block"}).appendTo(e?this.$element:document.body);i=this.getPosition(e);n=t[0].offsetWidth;s=t[0].offsetHeight;switch(e?o.split(" ")[1]:o){case"bottom":a={top:i.top+i.height,left:i.left+i.width/2-n/2};break;case"top":a={top:i.top-s,left:i.left+i.width/2-n/2};break;case"left":a={top:i.top+i.height/2-s/2,left:i.left-n};break;case"right":a={top:i.top+i.height/2-s/2,left:i.left+i.width};break}t.css(a).addClass(o).addClass("in")}},isHTML:function(t){return typeof t!="string"||t.charAt(0)==="<"&&t.charAt(t.length-1)===">"&&t.length>=3||/^(?:[^<]*<[\w\W]+>[^>]*$)/.exec(t)},setContent:function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.isHTML(e)?"html":"text"](e);t.removeClass("fade in top bottom left right")},hide:function(){var e=this,i=this.tip();i.removeClass("in");function n(){var e=setTimeout(function(){i.off(t.support.transition.end).remove()},500);i.one(t.support.transition.end,function(){clearTimeout(e);i.remove()})}t.support.transition&&this.$tip.hasClass("fade")?n():i.remove()},fixTitle:function(){var t=this.$element;if(t.attr("title")||typeof t.attr("data-original-title")!="string"){t.attr("data-original-title",t.attr("title")||"").removeAttr("title")}},hasContent:function(){return this.getTitle()},getPosition:function(e){return t.extend({},e?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var t,e=this.$element,i=this.options;t=e.attr("data-original-title")||(typeof i.title=="function"?i.title.call(e[0]):i.title);return t},tip:function(){return this.$tip=this.$tip||t(this.options.template)},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()}};t.fn.tooltip=function(i){return this.each(function(){var n=t(this),s=n.data("tooltip"),o=typeof i=="object"&&i;if(!s)n.data("tooltip",s=new e(this,o));if(typeof i=="string")s[i]()})};t.fn.tooltip.Constructor=e;t.fn.tooltip.defaults={animation:true,placement:"top",selector:false,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0}}(window.jQuery);!function(t){"use strict";var e=function(t,e){this.init("popover",t,e)};e.prototype=t.extend({},t.fn.tooltip.Constructor.prototype,{constructor:e,setContent:function(){var t=this.tip(),e=this.getTitle(),i=this.getContent();t.find(".popover-title")[this.isHTML(e)?"html":"text"](e);t.find(".popover-content > *")[this.isHTML(i)?"html":"text"](i);t.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var t,e=this.$element,i=this.options;t=e.attr("data-content")||(typeof i.content=="function"?i.content.call(e[0]):i.content);return t},tip:function(){if(!this.$tip){this.$tip=t(this.options.template)}return this.$tip}});t.fn.popover=function(i){return this.each(function(){var n=t(this),s=n.data("popover"),o=typeof i=="object"&&i;if(!s)n.data("popover",s=new e(this,o));if(typeof i=="string")s[i]()})};t.fn.popover.Constructor=e;t.fn.popover.defaults=t.extend({},t.fn.tooltip.defaults,{placement:"right",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}(window.jQuery);!function(t){"use strict";var e='[data-dismiss="alert"]',i=function(i){t(i).on("click",e,this.close)};i.prototype.close=function(e){var i=t(this),n=i.attr("data-target"),s;if(!n){n=i.attr("href");n=n&&n.replace(/.*(?=#[^\s]*$)/,"")}s=t(n);e&&e.preventDefault();s.length||(s=i.hasClass("alert")?i:i.parent());s.trigger(e=t.Event("close"));if(e.isDefaultPrevented())return;s.removeClass("in");function o(){s.trigger("closed").remove()}t.support.transition&&s.hasClass("fade")?s.on(t.support.transition.end,o):o()};t.fn.alert=function(e){return this.each(function(){var n=t(this),s=n.data("alert");if(!s)n.data("alert",s=new i(this));if(typeof e=="string")s[e].call(n)})};t.fn.alert.Constructor=i;t(function(){t("body").on("click.alert.data-api",e,i.prototype.close)})}(window.jQuery);!function(t){"use strict";var e=function(e,i){this.$element=t(e);this.options=t.extend({},t.fn.button.defaults,i)};e.prototype.setState=function(t){var e="disabled",i=this.$element,n=i.data(),s=i.is("input")?"val":"html";t=t+"Text";n.resetText||i.data("resetText",i[s]());i[s](n[t]||this.options[t]);setTimeout(function(){t=="loadingText"?i.addClass(e).attr(e,e):i.removeClass(e).removeAttr(e)},0)};e.prototype.toggle=function(){var t=this.$element.parent('[data-toggle="buttons-radio"]');t&&t.find(".active").removeClass("active");this.$element.toggleClass("active")};t.fn.button=function(i){return this.each(function(){var n=t(this),s=n.data("button"),o=typeof i=="object"&&i;if(!s)n.data("button",s=new e(this,o));if(i=="toggle")s.toggle();else if(i)s.setState(i)})};t.fn.button.defaults={loadingText:"loading..."};t.fn.button.Constructor=e;t(function(){t("body").on("click.button.data-api","[data-toggle^=button]",function(e){var i=t(e.target);if(!i.hasClass("btn"))i=i.closest(".btn");i.button("toggle")})})}(window.jQuery);!function(t){"use strict";var e=function(e,i){this.$element=t(e);this.options=t.extend({},t.fn.collapse.defaults,i);if(this.options.parent){this.$parent=t(this.options.parent)}this.options.toggle&&this.toggle()};e.prototype={constructor:e,dimension:function(){var t=this.$element.hasClass("width");return t?"width":"height"},show:function(){var e,i,n,s;if(this.transitioning)return;e=this.dimension();i=t.camelCase(["scroll",e].join("-"));n=this.$parent&&this.$parent.find("> .accordion-group > .in");if(n&&n.length){s=n.data("collapse");if(s&&s.transitioning)return;n.collapse("hide");s||n.data("collapse",null)}this.$element[e](0);this.transition("addClass",t.Event("show"),"shown");this.$element[e](this.$element[0][i])},hide:function(){var e;if(this.transitioning)return;e=this.dimension();this.reset(this.$element[e]());this.transition("removeClass",t.Event("hide"),"hidden");this.$element[e](0)},reset:function(t){var e=this.dimension();this.$element.removeClass("collapse")[e](t||"auto")[0].offsetWidth;this.$element[t!==null?"addClass":"removeClass"]("collapse");return this},transition:function(e,i,n){var s=this,o=function(){if(i.type=="show")s.reset();s.transitioning=0;s.$element.trigger(n)};this.$element.trigger(i);if(i.isDefaultPrevented())return;this.transitioning=1;this.$element[e]("in");t.support.transition&&this.$element.hasClass("collapse")?this.$element.one(t.support.transition.end,o):o()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};t.fn.collapse=function(i){return this.each(function(){var n=t(this),s=n.data("collapse"),o=typeof i=="object"&&i;if(!s)n.data("collapse",s=new e(this,o));if(typeof i=="string")s[i]()})};t.fn.collapse.defaults={toggle:true};t.fn.collapse.Constructor=e;t(function(){t("body").on("click.collapse.data-api","[data-toggle=collapse]",function(e){var i=t(this),n,s=i.attr("data-target")||e.preventDefault()||(n=i.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""),o=t(s).data("collapse")?"toggle":i.data();t(s).collapse(o)})})}(window.jQuery);!function(t){"use strict";var e=function(e,i){this.$element=t(e);this.options=i;this.options.slide&&this.slide(this.options.slide);this.options.pause=="hover"&&this.$element.on("mouseenter",t.proxy(this.pause,this)).on("mouseleave",t.proxy(this.cycle,this))};e.prototype={cycle:function(e){if(!e)this.paused=false;this.options.interval&&!this.paused&&(this.interval=setInterval(t.proxy(this.next,this),this.options.interval));return this},to:function(e){var i=this.$element.find(".active"),n=i.parent().children(),s=n.index(i),o=this;if(e>n.length-1||e<0)return;if(this.sliding){return this.$element.one("slid",function(){o.to(e)})}if(s==e){return this.pause().cycle()}return this.slide(e>s?"next":"prev",t(n[e]))},pause:function(t){if(!t)this.paused=true;clearInterval(this.interval);this.interval=null;return this},next:function(){if(this.sliding)return;return this.slide("next")},prev:function(){if(this.sliding)return;return this.slide("prev")},slide:function(e,i){var n=this.$element.find(".active"),s=i||n[e](),o=this.interval,a=e=="next"?"left":"right",r=e=="next"?"first":"last",l=this,h=t.Event("slide");this.sliding=true;o&&this.pause();s=s.length?s:this.$element.find(".item")[r]();if(s.hasClass("active"))return;if(t.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(h);if(h.isDefaultPrevented())return;s.addClass(e);s[0].offsetWidth;n.addClass(a);s.addClass(a);this.$element.one(t.support.transition.end,function(){s.removeClass([e,a].join(" ")).addClass("active");n.removeClass(["active",a].join(" "));l.sliding=false;setTimeout(function(){l.$element.trigger("slid")},0)})}else{this.$element.trigger(h);if(h.isDefaultPrevented())return;n.removeClass("active");s.addClass("active");this.sliding=false;this.$element.trigger("slid")}o&&this.cycle();return this}};t.fn.carousel=function(i){return this.each(function(){var n=t(this),s=n.data("carousel"),o=t.extend({},t.fn.carousel.defaults,typeof i=="object"&&i);if(!s)n.data("carousel",s=new e(this,o));if(typeof i=="number")s.to(i);else if(typeof i=="string"||(i=o.slide))s[i]();else if(o.interval)s.cycle()})};t.fn.carousel.defaults={interval:5e3,pause:"hover"};t.fn.carousel.Constructor=e;t(function(){t("body").on("click.carousel.data-api","[data-slide]",function(e){var i=t(this),n,s=t(i.attr("data-target")||(n=i.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"")),o=!s.data("modal")&&t.extend({},s.data(),i.data());s.carousel(o);e.preventDefault()})})}(window.jQuery);
!function(t){function e(){return new Date(Date.UTC.apply(Date,arguments))}function i(){var t=new Date;return e(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate())}var a=function(e,i){var a=this;this.element=t(e);this.language=i.language||this.element.data("date-language")||"en";this.language=this.language in s?this.language:this.language.split("-")[0];this.language=this.language in s?this.language:"en";this.isRTL=s[this.language].rtl||false;this.format=n.parseFormat(i.format||this.element.data("date-format")||s[this.language].format||"mm/dd/yyyy");this.isInline=false;this.isInput=this.element.is("input");this.component=this.element.is(".date")?this.element.find(".add-on"):false;this.hasInput=this.component&&this.element.find("input").length;if(this.component&&this.component.length===0)this.component=false;this._attachEvents();this.forceParse=true;if("forceParse"in i){this.forceParse=i.forceParse}else if("dateForceParse"in this.element.data()){this.forceParse=this.element.data("date-force-parse")}this.picker=t(n.template).appendTo(this.isInline?this.element:"body").on({click:t.proxy(this.click,this),mousedown:t.proxy(this.mousedown,this)});if(this.isInline){this.picker.addClass("datepicker-inline")}else{this.picker.addClass("datepicker-dropdown dropdown-menu")}if(this.isRTL){this.picker.addClass("datepicker-rtl");this.picker.find(".prev i, .next i").toggleClass("icon-arrow-left icon-arrow-right")}t(document).on("mousedown",function(e){if(t(e.target).closest(".datepicker.datepicker-inline, .datepicker.datepicker-dropdown").length===0){a.hide()}});this.autoclose=false;if("autoclose"in i){this.autoclose=i.autoclose}else if("dateAutoclose"in this.element.data()){this.autoclose=this.element.data("date-autoclose")}this.keyboardNavigation=true;if("keyboardNavigation"in i){this.keyboardNavigation=i.keyboardNavigation}else if("dateKeyboardNavigation"in this.element.data()){this.keyboardNavigation=this.element.data("date-keyboard-navigation")}this.viewMode=this.startViewMode=0;switch(i.startView||this.element.data("date-start-view")){case 2:case"decade":this.viewMode=this.startViewMode=2;break;case 1:case"year":this.viewMode=this.startViewMode=1;break}this.todayBtn=i.todayBtn||this.element.data("date-today-btn")||false;this.todayHighlight=i.todayHighlight||this.element.data("date-today-highlight")||false;this.calendarWeeks=false;if("calendarWeeks"in i){this.calendarWeeks=i.calendarWeeks}else if("dateCalendarWeeks"in this.element.data()){this.calendarWeeks=this.element.data("date-calendar-weeks")}if(this.calendarWeeks)this.picker.find("tfoot th.today").attr("colspan",function(t,e){return parseInt(e)+1});this.weekStart=(i.weekStart||this.element.data("date-weekstart")||s[this.language].weekStart||0)%7;this.weekEnd=(this.weekStart+6)%7;this.startDate=-Infinity;this.endDate=Infinity;this.daysOfWeekDisabled=[];this.setStartDate(i.startDate||this.element.data("date-startdate"));this.setEndDate(i.endDate||this.element.data("date-enddate"));this.setDaysOfWeekDisabled(i.daysOfWeekDisabled||this.element.data("date-days-of-week-disabled"));this.fillDow();this.fillMonths();this.update();this.showMode();if(this.isInline){this.show()}};a.prototype={constructor:a,_events:[],_attachEvents:function(){this._detachEvents();if(this.isInput){this._events=[[this.element,{focus:t.proxy(this.show,this),keyup:t.proxy(this.update,this),keydown:t.proxy(this.keydown,this)}]]}else if(this.component&&this.hasInput){this._events=[[this.element.find("input"),{focus:t.proxy(this.show,this),keyup:t.proxy(this.update,this),keydown:t.proxy(this.keydown,this)}],[this.component,{click:t.proxy(this.show,this)}]]}else if(this.element.is("div")){this.isInline=true}else{this._events=[[this.element,{click:t.proxy(this.show,this)}]]}for(var e=0,i,a;e<this._events.length;e++){i=this._events[e][0];a=this._events[e][1];i.on(a)}},_detachEvents:function(){for(var t=0,e,i;t<this._events.length;t++){e=this._events[t][0];i=this._events[t][1];e.off(i)}this._events=[]},show:function(e){this.picker.show();this.height=this.component?this.component.outerHeight():this.element.outerHeight();this.update();this.place();t(window).on("resize",t.proxy(this.place,this));if(e){e.stopPropagation();e.preventDefault()}this.element.trigger({type:"show",date:this.date})},hide:function(e){if(this.isInline)return;if(!this.picker.is(":visible"))return;this.picker.hide();t(window).off("resize",this.place);this.viewMode=this.startViewMode;this.showMode();if(!this.isInput){t(document).off("mousedown",this.hide)}if(this.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val()))this.setValue();this.element.trigger({type:"hide",date:this.date})},remove:function(){this._detachEvents();this.picker.remove();delete this.element.data().datepicker},getDate:function(){var t=this.getUTCDate();return new Date(t.getTime()+t.getTimezoneOffset()*6e4)},getUTCDate:function(){return this.date},setDate:function(t){this.setUTCDate(new Date(t.getTime()-t.getTimezoneOffset()*6e4))},setUTCDate:function(t){this.date=t;this.setValue()},setValue:function(){var t=this.getFormattedDate();if(!this.isInput){if(this.component){this.element.find("input").val(t)}this.element.data("date",t)}else{this.element.val(t)}},getFormattedDate:function(t){if(t===undefined)t=this.format;return n.formatDate(this.date,t,this.language)},setStartDate:function(t){this.startDate=t||-Infinity;if(this.startDate!==-Infinity){this.startDate=n.parseDate(this.startDate,this.format,this.language)}this.update();this.updateNavArrows()},setEndDate:function(t){this.endDate=t||Infinity;if(this.endDate!==Infinity){this.endDate=n.parseDate(this.endDate,this.format,this.language)}this.update();this.updateNavArrows()},setDaysOfWeekDisabled:function(e){this.daysOfWeekDisabled=e||[];if(!t.isArray(this.daysOfWeekDisabled)){this.daysOfWeekDisabled=this.daysOfWeekDisabled.split(/,\s*/)}this.daysOfWeekDisabled=t.map(this.daysOfWeekDisabled,function(t){return parseInt(t,10)});this.update();this.updateNavArrows()},place:function(){if(this.isInline)return;var e=parseInt(this.element.parents().filter(function(){return t(this).css("z-index")!="auto"}).first().css("z-index"))+10;var i=this.component?this.component.offset():this.element.offset();var a=this.component?this.component.outerHeight(true):this.element.outerHeight(true);this.picker.css({top:i.top+a,left:i.left,zIndex:e})},update:function(){var t,e=false;if(arguments&&arguments.length&&(typeof arguments[0]==="string"||arguments[0]instanceof Date)){t=arguments[0];e=true}else{t=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val()}this.date=n.parseDate(t,this.format,this.language);if(e)this.setValue();if(this.date<this.startDate){this.viewDate=new Date(this.startDate)}else if(this.date>this.endDate){this.viewDate=new Date(this.endDate)}else{this.viewDate=new Date(this.date)}this.fill()},fillDow:function(){var t=this.weekStart,e="<tr>";if(this.calendarWeeks){var i='<th class="cw">&nbsp;</th>';e+=i;this.picker.find(".datepicker-days thead tr:first-child").prepend(i)}while(t<this.weekStart+7){e+='<th class="dow">'+s[this.language].daysMin[t++%7]+"</th>"}e+="</tr>";this.picker.find(".datepicker-days thead").append(e)},fillMonths:function(){var t="",e=0;while(e<12){t+='<span class="month">'+s[this.language].monthsShort[e++]+"</span>"}this.picker.find(".datepicker-months td").html(t)},fill:function(){var i=new Date(this.viewDate),a=i.getUTCFullYear(),h=i.getUTCMonth(),r=this.startDate!==-Infinity?this.startDate.getUTCFullYear():-Infinity,d=this.startDate!==-Infinity?this.startDate.getUTCMonth():-Infinity,o=this.endDate!==Infinity?this.endDate.getUTCFullYear():Infinity,l=this.endDate!==Infinity?this.endDate.getUTCMonth():Infinity,f=this.date&&this.date.valueOf(),c=new Date;this.picker.find(".datepicker-days thead th.switch").text(s[this.language].months[h]+" "+a);this.picker.find("tfoot th.today").text(s[this.language].today).toggle(this.todayBtn!==false);this.updateNavArrows();this.fillMonths();var u=e(a,h-1,28,0,0,0,0),p=n.getDaysInMonth(u.getUTCFullYear(),u.getUTCMonth());u.setUTCDate(p);u.setUTCDate(p-(u.getUTCDay()-this.weekStart+7)%7);var g=new Date(u);g.setUTCDate(g.getUTCDate()+42);g=g.valueOf();var v=[];var y;while(u.valueOf()<g){if(u.getUTCDay()==this.weekStart){v.push("<tr>");if(this.calendarWeeks){var m=new Date(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()-u.getDay()+10-(this.weekStart&&this.weekStart%7<5&&7)),D=new Date(m.getFullYear(),0,4),w=~~((m-D)/864e5/7+1.5);v.push('<td class="cw">'+w+"</td>")}}y="";if(u.getUTCFullYear()<a||u.getUTCFullYear()==a&&u.getUTCMonth()<h){y+=" old"}else if(u.getUTCFullYear()>a||u.getUTCFullYear()==a&&u.getUTCMonth()>h){y+=" new"}if(this.todayHighlight&&u.getUTCFullYear()==c.getFullYear()&&u.getUTCMonth()==c.getMonth()&&u.getUTCDate()==c.getDate()){y+=" today"}if(f&&u.valueOf()==f){y+=" active"}if(u.valueOf()<this.startDate||u.valueOf()>this.endDate||t.inArray(u.getUTCDay(),this.daysOfWeekDisabled)!==-1){y+=" disabled"}v.push('<td class="day'+y+'">'+u.getUTCDate()+"</td>");if(u.getUTCDay()==this.weekEnd){v.push("</tr>")}u.setUTCDate(u.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(v.join(""));var k=this.date&&this.date.getUTCFullYear();var T=this.picker.find(".datepicker-months").find("th:eq(1)").text(a).end().find("span").removeClass("active");if(k&&k==a){T.eq(this.date.getUTCMonth()).addClass("active")}if(a<r||a>o){T.addClass("disabled")}if(a==r){T.slice(0,d).addClass("disabled")}if(a==o){T.slice(l+1).addClass("disabled")}v="";a=parseInt(a/10,10)*10;var C=this.picker.find(".datepicker-years").find("th:eq(1)").text(a+"-"+(a+9)).end().find("td");a-=1;for(var b=-1;b<11;b++){v+='<span class="year'+(b==-1||b==10?" old":"")+(k==a?" active":"")+(a<r||a>o?" disabled":"")+'">'+a+"</span>";a+=1}C.html(v)},updateNavArrows:function(){var t=new Date(this.viewDate),e=t.getUTCFullYear(),i=t.getUTCMonth();switch(this.viewMode){case 0:if(this.startDate!==-Infinity&&e<=this.startDate.getUTCFullYear()&&i<=this.startDate.getUTCMonth()){this.picker.find(".prev").css({visibility:"hidden"})}else{this.picker.find(".prev").css({visibility:"visible"})}if(this.endDate!==Infinity&&e>=this.endDate.getUTCFullYear()&&i>=this.endDate.getUTCMonth()){this.picker.find(".next").css({visibility:"hidden"})}else{this.picker.find(".next").css({visibility:"visible"})}break;case 1:case 2:if(this.startDate!==-Infinity&&e<=this.startDate.getUTCFullYear()){this.picker.find(".prev").css({visibility:"hidden"})}else{this.picker.find(".prev").css({visibility:"visible"})}if(this.endDate!==Infinity&&e>=this.endDate.getUTCFullYear()){this.picker.find(".next").css({visibility:"hidden"})}else{this.picker.find(".next").css({visibility:"visible"})}break}},click:function(i){i.stopPropagation();i.preventDefault();var a=t(i.target).closest("span, td, th");if(a.length==1){switch(a[0].nodeName.toLowerCase()){case"th":switch(a[0].className){case"switch":this.showMode(1);break;case"prev":case"next":var s=n.modes[this.viewMode].navStep*(a[0].className=="prev"?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,s);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,s);break}this.fill();break;case"today":var h=new Date;h=e(h.getFullYear(),h.getMonth(),h.getDate(),0,0,0);this.showMode(-2);var r=this.todayBtn=="linked"?null:"view";this._setDate(h,r);break}break;case"span":if(!a.is(".disabled")){this.viewDate.setUTCDate(1);if(a.is(".month")){var d=a.parent().find("span").index(a);this.viewDate.setUTCMonth(d);this.element.trigger({type:"changeMonth",date:this.viewDate})}else{var o=parseInt(a.text(),10)||0;this.viewDate.setUTCFullYear(o);this.element.trigger({type:"changeYear",date:this.viewDate})}this.showMode(-1);this.fill()}break;case"td":if(a.is(".day")&&!a.is(".disabled")){var l=parseInt(a.text(),10)||1;var o=this.viewDate.getUTCFullYear(),d=this.viewDate.getUTCMonth();if(a.is(".old")){if(d===0){d=11;o-=1}else{d-=1}}else if(a.is(".new")){if(d==11){d=0;o+=1}else{d+=1}}this._setDate(e(o,d,l,0,0,0,0))}break}}},_setDate:function(t,e){if(!e||e=="date")this.date=t;if(!e||e=="view")this.viewDate=t;this.fill();this.setValue();this.element.trigger({type:"changeDate",date:this.date});var i;if(this.isInput){i=this.element}else if(this.component){i=this.element.find("input")}if(i){i.change();if(this.autoclose&&(!e||e=="date")){this.hide()}}},moveMonth:function(t,e){if(!e)return t;var i=new Date(t.valueOf()),a=i.getUTCDate(),s=i.getUTCMonth(),n=Math.abs(e),h,r;e=e>0?1:-1;if(n==1){r=e==-1?function(){return i.getUTCMonth()==s}:function(){return i.getUTCMonth()!=h};h=s+e;i.setUTCMonth(h);if(h<0||h>11)h=(h+12)%12}else{for(var d=0;d<n;d++)i=this.moveMonth(i,e);h=i.getUTCMonth();i.setUTCDate(a);r=function(){return h!=i.getUTCMonth()}}while(r()){i.setUTCDate(--a);i.setUTCMonth(h)}return i},moveYear:function(t,e){return this.moveMonth(t,e*12)},dateWithinRange:function(t){return t>=this.startDate&&t<=this.endDate},keydown:function(t){if(this.picker.is(":not(:visible)")){if(t.keyCode==27)this.show();return}var e=false,i,a,s,n,h;switch(t.keyCode){case 27:this.hide();t.preventDefault();break;case 37:case 39:if(!this.keyboardNavigation)break;i=t.keyCode==37?-1:1;if(t.ctrlKey){n=this.moveYear(this.date,i);h=this.moveYear(this.viewDate,i)}else if(t.shiftKey){n=this.moveMonth(this.date,i);h=this.moveMonth(this.viewDate,i)}else{n=new Date(this.date);n.setUTCDate(this.date.getUTCDate()+i);h=new Date(this.viewDate);h.setUTCDate(this.viewDate.getUTCDate()+i)}if(this.dateWithinRange(n)){this.date=n;this.viewDate=h;this.setValue();this.update();t.preventDefault();e=true}break;case 38:case 40:if(!this.keyboardNavigation)break;i=t.keyCode==38?-1:1;if(t.ctrlKey){n=this.moveYear(this.date,i);h=this.moveYear(this.viewDate,i)}else if(t.shiftKey){n=this.moveMonth(this.date,i);h=this.moveMonth(this.viewDate,i)}else{n=new Date(this.date);n.setUTCDate(this.date.getUTCDate()+i*7);h=new Date(this.viewDate);h.setUTCDate(this.viewDate.getUTCDate()+i*7)}if(this.dateWithinRange(n)){this.date=n;this.viewDate=h;this.setValue();this.update();t.preventDefault();e=true}break;case 13:this.hide();t.preventDefault();break;case 9:this.hide();break}if(e){this.element.trigger({type:"changeDate",date:this.date});var r;if(this.isInput){r=this.element}else if(this.component){r=this.element.find("input")}if(r){r.change()}}},showMode:function(t){if(t){this.viewMode=Math.max(0,Math.min(2,this.viewMode+t))}this.picker.find(">div").hide().filter(".datepicker-"+n.modes[this.viewMode].clsName).css("display","block");this.updateNavArrows()}};t.fn.datepicker=function(e){var i=Array.apply(null,arguments);i.shift();return this.each(function(){var s=t(this),n=s.data("datepicker"),h=typeof e=="object"&&e;if(!n){s.data("datepicker",n=new a(this,t.extend({},t.fn.datepicker.defaults,h)))}if(typeof e=="string"&&typeof n[e]=="function"){n[e].apply(n,i)}})};t.fn.datepicker.defaults={};t.fn.datepicker.Constructor=a;var s=t.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today"}};var n={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(t){return t%4===0&&t%100!==0||t%400===0},getDaysInMonth:function(t,e){return[31,n.isLeapYear(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(t){var e=t.replace(this.validParts,"\x00").split("\x00"),i=t.match(this.validParts);if(!e||!e.length||!i||i.length===0){throw new Error("Invalid date format.")}return{separators:e,parts:i}},parseDate:function(i,n,h){if(i instanceof Date)return i;if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(i)){var r=/([\-+]\d+)([dmwy])/,d=i.match(/([\-+]\d+)([dmwy])/g),o,l;i=new Date;for(var f=0;f<d.length;f++){o=r.exec(d[f]);l=parseInt(o[1]);switch(o[2]){case"d":i.setUTCDate(i.getUTCDate()+l);break;case"m":i=a.prototype.moveMonth.call(a.prototype,i,l);break;case"w":i.setUTCDate(i.getUTCDate()+l*7);break;case"y":i=a.prototype.moveYear.call(a.prototype,i,l);break}}return e(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate(),0,0,0)}var d=i&&i.match(this.nonpunctuation)||[],i=new Date,c={},u=["yyyy","yy","M","MM","m","mm","d","dd"],p={yyyy:function(t,e){return t.setUTCFullYear(e)},yy:function(t,e){return t.setUTCFullYear(2e3+e)},m:function(t,e){e-=1;while(e<0)e+=12;e%=12;t.setUTCMonth(e);while(t.getUTCMonth()!=e)t.setUTCDate(t.getUTCDate()-1);return t},d:function(t,e){return t.setUTCDate(e)}},g,v,o;p["M"]=p["MM"]=p["mm"]=p["m"];p["dd"]=p["d"];i=e(i.getFullYear(),i.getMonth(),i.getDate(),0,0,0);var y=n.parts.slice();if(d.length!=y.length){y=t(y).filter(function(e,i){return t.inArray(i,u)!==-1}).toArray()}if(d.length==y.length){for(var f=0,m=y.length;f<m;f++){g=parseInt(d[f],10);o=y[f];if(isNaN(g)){switch(o){case"MM":v=t(s[h].months).filter(function(){var t=this.slice(0,d[f].length),e=d[f].slice(0,t.length);return t==e});g=t.inArray(v[0],s[h].months)+1;break;case"M":v=t(s[h].monthsShort).filter(function(){var t=this.slice(0,d[f].length),e=d[f].slice(0,t.length);return t==e});g=t.inArray(v[0],s[h].monthsShort)+1;break}}c[o]=g}for(var f=0,D;f<u.length;f++){D=u[f];if(D in c&&!isNaN(c[D]))p[D](i,c[D])}}return i},formatDate:function(e,i,a){var n={d:e.getUTCDate(),D:s[a].daysShort[e.getUTCDay()],DD:s[a].days[e.getUTCDay()],m:e.getUTCMonth()+1,M:s[a].monthsShort[e.getUTCMonth()],MM:s[a].months[e.getUTCMonth()],yy:e.getUTCFullYear().toString().substring(2),yyyy:e.getUTCFullYear()};n.dd=(n.d<10?"0":"")+n.d;n.mm=(n.m<10?"0":"")+n.m;var e=[],h=t.extend([],i.separators);for(var r=0,d=i.parts.length;r<d;r++){if(h.length)e.push(h.shift());e.push(n[i.parts[r]])}return e.join("")},headTemplate:"<thead>"+"<tr>"+'<th class="prev"><i class="icon-arrow-left"/></th>'+'<th colspan="5" class="switch"></th>'+'<th class="next"><i class="icon-arrow-right"/></th>'+"</tr>"+"</thead>",contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr></tfoot>'};n.template='<div class="datepicker">'+'<div class="datepicker-days">'+'<table class=" table-condensed">'+n.headTemplate+"<tbody></tbody>"+n.footTemplate+"</table>"+"</div>"+'<div class="datepicker-months">'+'<table class="table-condensed">'+n.headTemplate+n.contTemplate+n.footTemplate+"</table>"+"</div>"+'<div class="datepicker-years">'+'<table class="table-condensed">'+n.headTemplate+n.contTemplate+n.footTemplate+"</table>"+"</div>"+"</div>";t.fn.datepicker.DPGlobal=n}(window.jQuery);
!function(t){"use strict";var e=function(t,e){this.init("tooltip",t,e)};e.prototype={constructor:e,init:function(e,i,o){var s,n;this.type=e;this.$element=t(i);this.options=this.getOptions(o);this.enabled=true;if(this.options.trigger=="click"){this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this))}else if(this.options.trigger!="manual"){s=this.options.trigger=="hover"?"mouseenter":"focus";n=this.options.trigger=="hover"?"mouseleave":"blur";this.$element.on(s+"."+this.type,this.options.selector,t.proxy(this.enter,this));this.$element.on(n+"."+this.type,this.options.selector,t.proxy(this.leave,this))}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(e){e=t.extend({},t.fn[this.type].defaults,e,this.$element.data());if(e.delay&&typeof e.delay=="number"){e.delay={show:e.delay,hide:e.delay}}return e},enter:function(e){var i=t(e.currentTarget)[this.type](this._options).data(this.type);if(!i.options.delay||!i.options.delay.show)return i.show();clearTimeout(this.timeout);i.hoverState="in";this.timeout=setTimeout(function(){if(i.hoverState=="in")i.show()},i.options.delay.show)},leave:function(e){var i=t(e.currentTarget)[this.type](this._options).data(this.type);if(this.timeout)clearTimeout(this.timeout);if(!i.options.delay||!i.options.delay.hide)return i.hide();i.hoverState="out";this.timeout=setTimeout(function(){if(i.hoverState=="out")i.hide()},i.options.delay.hide)},show:function(){var t,e,i,o,s,n,h;if(this.hasContent()&&this.enabled){t=this.tip();this.setContent();if(this.options.animation){t.addClass("fade")}n=typeof this.options.placement=="function"?this.options.placement.call(this,t[0],this.$element[0]):this.options.placement;e=/in/.test(n);t.remove().css({top:0,left:0,display:"block"}).appendTo(e?this.$element:document.body);i=this.getPosition(e);o=t[0].offsetWidth;s=t[0].offsetHeight;switch(e?n.split(" ")[1]:n){case"bottom":h={top:i.top+i.height,left:i.left+i.width/2-o/2};break;case"top":h={top:i.top-s,left:i.left+i.width/2-o/2};break;case"left":h={top:i.top+i.height/2-s/2,left:i.left-o};break;case"right":h={top:i.top+i.height/2-s/2,left:i.left+i.width};break}t.css(h).addClass(n).addClass("in")}},setContent:function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e);t.removeClass("fade in top bottom left right")},hide:function(){var e=this,i=this.tip();i.removeClass("in");function o(){var e=setTimeout(function(){i.off(t.support.transition.end).remove()},500);i.one(t.support.transition.end,function(){clearTimeout(e);i.remove()})}t.support.transition&&this.$tip.hasClass("fade")?o():i.remove();return this},fixTitle:function(){var t=this.$element;if(t.attr("title")||typeof t.attr("data-original-title")!="string"){t.attr("data-original-title",t.attr("title")||"").removeAttr("title")}},hasContent:function(){return this.getTitle()},getPosition:function(e){return t.extend({},e?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var t,e=this.$element,i=this.options;t=e.attr("data-original-title")||(typeof i.title=="function"?i.title.call(e[0]):i.title);return t},tip:function(){return this.$tip=this.$tip||t(this.options.template)},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};t.fn.tooltip=function(i){return this.each(function(){var o=t(this),s=o.data("tooltip"),n=typeof i=="object"&&i;if(!s)o.data("tooltip",s=new e(this,n));if(typeof i=="string")s[i]()})};t.fn.tooltip.Constructor=e;t.fn.tooltip.defaults={animation:true,placement:"top",selector:false,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0,html:true}}(window.jQuery);
(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{e(jQuery)}})(function(e,t){var n=6,i=e.event.add,a=e.event.remove,o=function(t,n,i){e.event.trigger(n,i,t)},r=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){return window.setTimeout(function(){e()},25)}}(),u={textarea:true,input:true,select:true},c={move:"mousemove",cancel:"mouseup dragstart",end:"mouseup"},d={move:"touchmove",cancel:"touchend",end:"touchend"};function f(e){var t=e,n=false,i=false;function a(e){if(n){t();r(a);i=true;n=false}else{i=false}}this.kick=function(e){n=true;if(!i){a()}};this.end=function(e){var a=t;if(!e){return}if(!i){e()}else{t=n?function(){a();e()}:e;n=true}}}function m(){return true}function s(){return false}function v(e){e.preventDefault()}function p(e){if(u[e.target.tagName.toLowerCase()]){return}e.preventDefault()}function g(e){return e.which===1&&!e.ctrlKey&&!e.altKey}function l(e,t){var n,i;if(e.identifiedTouch){return e.identifiedTouch(t)}n=-1;i=e.length;while(++n<i){if(e[n].identifier===t){return e[n]}}}function h(e,t){var n=l(e.changedTouches,t.identifier);if(!n){return}if(n.pageX===t.pageX&&n.pageY===t.pageY){return}return n}function X(e){var t;if(!g(e)){return}t={target:e.target,startX:e.pageX,startY:e.pageY,timeStamp:e.timeStamp};i(document,c.move,Y,t);i(document,c.cancel,w,t)}function Y(e){var t=e.data;q(e,t,e,y)}function w(e){y()}function y(){a(document,c.move,Y);a(document,c.cancel,y)}function T(e){var t,n;if(u[e.target.tagName.toLowerCase()]){return}t=e.changedTouches[0];n={target:t.target,startX:t.pageX,startY:t.pageY,timeStamp:e.timeStamp,identifier:t.identifier};i(document,d.move+"."+t.identifier,S,n);i(document,d.cancel+"."+t.identifier,k,n)}function S(e){var t=e.data,n=h(e,t);if(!n){return}q(e,t,n,_)}function k(e){var t=e.data,n=l(e.changedTouches,t.identifier);if(!n){return}_(t.identifier)}function _(e){a(document,"."+e,S);a(document,"."+e,k)}function q(e,t,i,a){var o=i.pageX-t.startX,r=i.pageY-t.startY;if(o*o+r*r<n*n){return}F(e,t,i,o,r,a)}function A(){this._handled=m;return false}function D(e){e._handled()}function F(e,t,n,i,a,r){var u=t.target,c,d;c=e.targetTouches;d=e.timeStamp-t.timeStamp;t.type="movestart";t.distX=i;t.distY=a;t.deltaX=i;t.deltaY=a;t.pageX=n.pageX;t.pageY=n.pageY;t.velocityX=i/d;t.velocityY=a/d;t.targetTouches=c;t.finger=c?c.length:1;t._handled=A;t._preventTouchmoveDefault=function(){e.preventDefault()};o(t.target,t);r(t.identifier)}function R(e){var t=e.data.event,n=e.data.timer;N(t,e,e.timeStamp,n)}function x(e){var t=e.data.event,n=e.data.timer;j();O(t,n,function(){setTimeout(function(){a(t.target,"click",s)},0)})}function j(e){a(document,c.move,R);a(document,c.end,x)}function C(e){var t=e.data.event,n=e.data.timer,i=h(e,t);if(!i){return}e.preventDefault();t.targetTouches=e.targetTouches;N(t,i,e.timeStamp,n)}function K(e){var t=e.data.event,n=e.data.timer,i=l(e.changedTouches,t.identifier);if(!i){return}L(t);O(t,n)}function L(e){a(document,"."+e.identifier,C);a(document,"."+e.identifier,K)}function N(e,t,n,i){var a=n-e.timeStamp;e.type="move";e.distX=t.pageX-e.startX;e.distY=t.pageY-e.startY;e.deltaX=t.pageX-e.pageX;e.deltaY=t.pageY-e.pageY;e.velocityX=.3*e.velocityX+.7*e.deltaX/a;e.velocityY=.3*e.velocityY+.7*e.deltaY/a;e.pageX=t.pageX;e.pageY=t.pageY;i.kick()}function O(e,t,n){t.end(function(){e.type="moveend";o(e.target,e);return n&&n()})}function b(e,t,n){i(this,"dragstart.move drag.move",v);i(this,"mousedown.move",p);i(this,"movestart.move",D);return true}function z(e){a(this,"dragstart drag",v);a(this,"mousedown touchstart",p);a(this,"movestart",D);return true}e.event.special.movestart={setup:b,teardown:z,_default:function(e){var n,a;if(!e._handled()){return}n={target:e.target,startX:e.startX,startY:e.startY,pageX:e.pageX,pageY:e.pageY,distX:e.distX,distY:e.distY,deltaX:e.deltaX,deltaY:e.deltaY,velocityX:e.velocityX,velocityY:e.velocityY,timeStamp:e.timeStamp,identifier:e.identifier,targetTouches:e.targetTouches,finger:e.finger};a={event:n,timer:new f(function(t){o(e.target,n)})};if(e.identifier===t){i(e.target,"click",s);i(document,c.move,R,a);i(document,c.end,x,a)}else{e._preventTouchmoveDefault();i(document,d.move+"."+e.identifier,C,a);i(document,d.end+"."+e.identifier,K,a)}}};e.event.special.move={setup:function(){i(this,"movestart.move",e.noop)},teardown:function(){a(this,"movestart.move",e.noop)}};e.event.special.moveend={setup:function(){i(this,"movestart.moveend",e.noop)},teardown:function(){a(this,"movestart.moveend",e.noop)}};i(document,"mousedown.move",X);i(document,"touchstart.move",T);if(typeof Array.prototype.indexOf==="function"){(function(e,t){var n=["changedTouches","targetTouches"],i=n.length;while(i--){if(e.event.props.indexOf(n[i])===-1){e.event.props.push(n[i])}}})(e)}});
(function(e,n){"$:nomunge";var t=e.jQuery||e.Cowboy||(e.Cowboy={}),i;t.throttle=i=function(e,i,u,o){var f,r=0;if(typeof i!=="boolean"){o=u;u=i;i=n}function a(){var t=this,a=+new Date-r,c=arguments;function g(){r=+new Date;u.apply(t,c)}function l(){f=n}if(o&&!f){g()}f&&clearTimeout(f);if(o===n&&a>e){g()}else if(i!==true){f=setTimeout(o?l:g,o===n?e-a:e)}}if(t.guid){a.guid=u.guid=u.guid||t.guid++}return a};t.debounce=function(e,t,u){return u===n?i(e,t,false):i(e,u,t!==false)}})(this);
(function(t,n,e){var i="hashchange",o=document,r,c=t.event.special,a=o.documentMode,f="on"+i in n&&(a===e||a>7);function u(t){t=t||location.href;return"#"+t.replace(/^[^#]*#?(.*)$/,"$1")}t.fn[i]=function(t){return t?this.bind(i,t):this.trigger(i)};t.fn[i].delay=50;c[i]=t.extend(c[i],{setup:function(){if(f){return false}t(r.start)},teardown:function(){if(f){return false}t(r.stop)}});r=function(){var r={},c,a=u(),s=function(t){return t},l=s,d=s;r.start=function(){c||p()};r.stop=function(){c&&clearTimeout(c);c=e};function p(){var e=u(),o=d(a);if(e!==a){l(a=e,o);t(n).trigger(i)}else{if(o!==a){location.href=location.href.replace(/#.*/,"")+o}}c=setTimeout(p,t.fn[i].delay)}t.browser.msie&&!f&&function(){var n,e;r.start=function(){if(!n){e=t.fn[i].src;e=e&&e+u();n=t('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){e||l(u());p()}).attr("src",e||"javascript:0").insertAfter("body")[0].contentWindow;o.onpropertychange=function(){try{if(event.propertyName==="title"){n.document.title=o.title}}catch(t){}}}};r.stop=s;d=function(){return u(n.location.href)};l=function(e,r){var c=n.document,a=t.fn[i].domain;if(e!==r){c.title=o.title;c.open();a&&c.write('<script>document.domain="'+a+'"</script>');c.close();n.location.hash=e}}}();return r}()})(jQuery,this);
(function(e){"use strict";function s(e){return new RegExp("(^|\\s+)"+e+"(\\s+|$)")}var n,t,a;if("classList"in document.documentElement){n=function(e,s){return e.classList.contains(s)};t=function(e,s){e.classList.add(s)};a=function(e,s){e.classList.remove(s)}}else{n=function(e,n){return s(n).test(e.className)};t=function(e,s){if(!n(e,s)){e.className=e.className+" "+s}};a=function(e,n){e.className=e.className.replace(s(n)," ")}}function c(e,s){var c=n(e,s)?a:t;c(e,s)}var i={hasClass:n,addClass:t,removeClass:a,toggleClass:c,has:n,add:t,remove:a,toggle:c};if(typeof define==="function"&&define.amd){define(i)}else if(typeof exports==="object"){module.exports=i}else{e.classie=i}})(window);
(function(){var r=this;var e;if(typeof r.require=="function"){try{var n=r.require("crypto").randomBytes;e=n&&function(){return n(16)}}catch(a){}}if(!e&&r.crypto&&crypto.getRandomValues){var t=new Uint8Array(16);e=function B(){crypto.getRandomValues(t);return t}}if(!e){var u=new Array(16);e=function(){for(var r=0,e;r<16;r++){if((r&3)===0)e=Math.random()*4294967296;u[r]=e>>>((r&3)<<3)&255}return u}}var o=typeof r.Buffer=="function"?r.Buffer:Array;var f=[];var i={};for(var c=0;c<256;c++){f[c]=(c+256).toString(16).substr(1);i[f[c]]=c}function v(r,e,n){var a=e&&n||0,t=0;e=e||[];r.toLowerCase().replace(/[0-9a-f]{2}/g,function(r){if(t<16){e[a+t++]=i[r]}});while(t<16){e[a+t++]=0}return e}function s(r,e){var n=e||0,a=f;return a[r[n++]]+a[r[n++]]+a[r[n++]]+a[r[n++]]+"-"+a[r[n++]]+a[r[n++]]+"-"+a[r[n++]]+a[r[n++]]+"-"+a[r[n++]]+a[r[n++]]+"-"+a[r[n++]]+a[r[n++]]+a[r[n++]]+a[r[n++]]+a[r[n++]]+a[r[n++]]}var l=e();var d=[l[0]|1,l[1],l[2],l[3],l[4],l[5]];var y=(l[6]<<8|l[7])&16383;var p=0,m=0;function w(r,e,n){var a=e&&n||0;var t=e||[];r=r||{};var u=r.clockseq!=null?r.clockseq:y;var o=r.msecs!=null?r.msecs:(new Date).getTime();var f=r.nsecs!=null?r.nsecs:m+1;var i=o-p+(f-m)/1e4;if(i<0&&r.clockseq==null){u=u+1&16383}if((i<0||o>p)&&r.nsecs==null){f=0}if(f>=1e4){throw new Error("uuid.v1(): Can't create more than 10M uuids/sec")}p=o;m=f;y=u;o+=122192928e5;var c=((o&268435455)*1e4+f)%4294967296;t[a++]=c>>>24&255;t[a++]=c>>>16&255;t[a++]=c>>>8&255;t[a++]=c&255;var v=o/4294967296*1e4&268435455;t[a++]=v>>>8&255;t[a++]=v&255;t[a++]=v>>>24&15|16;t[a++]=v>>>16&255;t[a++]=u>>>8|128;t[a++]=u&255;var l=r.node||d;for(var w=0;w<6;w++){t[a+w]=l[w]}return e?e:s(t)}function g(r,n,a){var t=n&&a||0;if(typeof r=="string"){n=r=="binary"?new o(16):null;r=null}r=r||{};var u=r.random||(r.rng||e)();u[6]=u[6]&15|64;u[8]=u[8]&63|128;if(n){for(var f=0;f<16;f++){n[t+f]=u[f]}}return n||s(u)}var h=g;h.v1=w;h.v4=g;h.parse=v;h.unparse=s;h.BufferClass=o;if(typeof define==="function"&&define.amd){define(function(){return h})}else if(typeof module!="undefined"&&module.exports){module.exports=h}else{var q=r.uuid;h.noConflict=function(){r.uuid=q;return h};r.uuid=h}}).call(this);
(function(t){t.fn.twentytwenty=function(n){var n=t.extend({default_offset_pct:.5},n);return this.each(function(){var e=n.default_offset_pct;var i=t(this);var a=i.find("img:first");var d=i.find("img:last");i.append("<div class='twentytwenty-handle-wrapper'><div class='twentytwenty-handle'></div></div>");var o=i.find(".twentytwenty-handle");o.append("<div class='twentytwenty-left-arrow'></div>");o.append("<div class='twentytwenty-right-arrow'></div>");i.addClass("twentytwenty-container");a.addClass("twentytwenty-before");d.addClass("twentytwenty-after");var f=i.find("figcaption").height()||0;var s=function(t){var n=a.width();var e=a.height();return{w:n+"px",h:e+"px",cw:t*n+"px"}};var c=function(t){a.css("clip","rect(0,"+t.cw+","+t.h+",0)");i.css("height",t.h+f);i.find("a:last, .twentytwenty-handle-wrapper").css("height",t.h)};var w=function(t){var n=s(t);if(n.h==="0px"){a.on("load",function(){w(t)})}o.css("left",n.cw);c(n)};t(window).on("resize.twentytwenty",function(t){w(e)});var r=0;var y=0;i.on("movestart",function(t){if(t.distX>t.distY&&t.distX<-t.distY||t.distX<t.distY&&t.distX>-t.distY){t.preventDefault()}i.addClass("active");r=i.offset().left;y=a.width()});i.on("moveend",function(t){i.removeClass("active")});i.on("move",function(t){if(i.hasClass("active")){e=(t.pageX-r)/y;if(e<0){e=0}if(e>1){e=1}w(e)}});i.find("img").on("mousedown",function(t){t.preventDefault()});o.on("mousedown",function(t){r=i.offset().left;y=a.width();e=(t.pageX-r)/y;if(e<0){e=0}if(e>1){e=1}w(e)});t(window).trigger("resize.twentytwenty")})}})(jQuery);$(function(){$('[data-embed-type="comparison"]').twentytwenty();if(typeof tinymce!=="undefined"){tinymce.onAddEditor.add(function(t,n){$(n.getDoc()).find('[data-embed-type="comparison"]').twentytwenty();n.onExecCommand.add(function(t,n,e,i){if(n=="mceEmbedImage"){$(t.getDoc()).find('[data-embed-type="comparison"]').twentytwenty()}});n.onInit.add(function(t){$(t.getDoc()).find('[data-embed-type="comparison"]').twentytwenty()})})}});
(function(t){t.fn.unveil=function(e,i){var a=0;var l=t(window),r=window.devicePixelRatio>1,n=r?"data-src-retina":"data-src",o=this,s=t(this).selector,u;var d=t.extend({threshold:1e3,replaceTag:"<iframe>",delay:0,mode:"img",loadingClass:"loading"},e);var h=t(d.replaceTag);function f(){if(d.mode==="img"){var e=this.getAttribute(n);e=e||this.getAttribute("data-src");if(e){this.setAttribute("src",e);if(typeof i==="function")i.call(this)}}else{var a=h.clone();var l=t(this);var r=l.prop("attributes");t.each(r,function(){a.attr(this.name,this.value)});a.removeClass(d.loadingClass);l.replaceWith(a);if(typeof i==="function")i.call(this)}}this.one("unveil",f);this.attr("data-lazy-load",false);function c(){var e=t(this);if(e.is(":hidden"))return;var i=l.scrollTop(),a=i+l.height(),r=e.offset().top,n=r+e.height();return n>=i-d.threshold&&r<=a+d.threshold}function v(){var e=t(s).filter("[data-lazy-load=true]");if(e.length>0){e.one("unveil",f);e.attr("data-lazy-load",false);e.trigger("unveil")}var i=o.filter(c);if(d.delay>0){a=setTimeout(function(){stillInView=i.filter(c);u=stillInView.trigger("unveil")},d.delay)}else{u=i.trigger("unveil")}o=o.not(u)}l.on("scroll.unveil resize.unveil lookup.unveil",v);v();return this}})(window.jQuery||window.Zepto);
var _documentHiddenPropertyName=null;var _documentVisibilityChangeEventName=null;$.fn.hidden=function(){if(this[0]!==document){return false}if(_documentHiddenPropertyName===null&&_documentHiddenPropertyName!=="incompatible"){var e=[["hidden","visibilitychange"],["mozHidden","mozvisibilitychange"],["msHidden","msvisibilitychange"],["webkitHidden","webkitvisibilitychange"]];$.each(e,function(e,n){if(typeof document[n[0]]!=="undefined"){_documentHiddenPropertyName=n[0];_documentVisibilityChangeEventName=n[1];return false}});if(_documentHiddenPropertyName===null){_documentHiddenPropertyName="incompatible"}}if(arguments.length===0){if(_documentHiddenPropertyName===null){return true}return document[_documentHiddenPropertyName]}return this.on(_documentVisibilityChangeEventName,arguments[0])};
$(document).ready(function(){"use strict";var e=function(){$("#feed-view-details").addClass("on");$("#feed-view-river").removeClass("on");$("#feed-view-compact").removeClass("on");$("#feed-view-grid").removeClass("on");var e=$("#river .editorial");if(e.length===0){e=$("#feed-view-details").parents(".feed-hdr").first().siblings(".editorial")}e.addClass("details");e.removeClass("compact");e.removeClass("river");e.removeClass("grid row")};var r=function(){$("#feed-view-compact").addClass("on");$("#feed-view-river").removeClass("on");$("#feed-view-details").removeClass("on");$("#feed-view-grid").removeClass("on");var e=$("#river .editorial");if(e.length===0){e=$("#feed-view-compact").parents(".feed-hdr").first().siblings(".editorial")}e.addClass("compact");e.removeClass("details");e.removeClass("list");e.removeClass("grid row")};var i=function(){$("#feed-view-river").addClass("on");$("#feed-view-details").removeClass("on");$("#feed-view-compact").removeClass("on");$("#feed-view-grid").removeClass("on");var e=$("#river .editorial");if(e.length===0){e=$("#feed-view-river").parents(".feed-hdr").first().siblings(".editorial")}e.addClass("river");e.removeClass("details");e.removeClass("compact");e.removeClass("grid row")};var a=function(){$("#feed-view-grid").addClass("on");$("#feed-view-river").removeClass("on");$("#feed-view-details").removeClass("on");$("#feed-view-compact").removeClass("on");var e=$("#river .editorial");if(e.length===0){e=$("#feed-view-river").parents(".feed-hdr").first().siblings(".editorial")}e.addClass("grid row");e.removeClass("river");e.removeClass("details");e.removeClass("compact")};var s=function(e,r){if(e!==undefined){$.cookie("feed-group-"+e,r,{expires:365,path:"/"})}};$(document).on("click","#feed-view-details",function(r){var i=$(this).parents("dl:first").attr("data-feed-group");e();r.preventDefault();s(i,"Details")});$(document).on("click","#feed-view-compact",function(e){var i=$(this).parents("dl:first").attr("data-feed-group");r();e.preventDefault();s(i,"Compact")});$(document).on("click","#feed-view-river",function(e){var r=$(this).parents("dl:first").attr("data-feed-group");i();e.preventDefault();s(r,"River")});$(document).on("click","#feed-view-grid",function(e){var r=$(this).parents("dl:first").attr("data-feed-group");a();e.preventDefault();s(r,"Grid")})});
$(document).ready(function(){"use strict";var e=".js-time-countdown";var t="hide";var a="time-unit--singular";var n="has-ms";var i="countdown-id";var r="target-date";var o="tick";var u=1e3;var s=u*60;var f=s*60;var l=f*24;var d=l/1e3;var v=d/100;var c=0;var m={};var h=false;var w=null;var g={};var p=function(e){return(e<10?"0":"")+e};var N=function(e,t){var a="";if(undefined===t){t="in "}if(e.swatch){a+="<em>@</em>"+e.swatch+" <em>.beats</em>"}else{if(e.days>0){a+=e.days+"<em>d</em> "}a+=p(e.hours)+"<em>h</em> ";a+=p(e.minutes)+"<em>m</em> ";a+=p(e.seconds)+"<em>s</em>"}return t+a};var y=function(e){var t=Date.now(),a=e-t;if(a<=0){a=null}return a};var C=function(e,t){if(h){var a=Math.floor(e/v)/100;if(isNaN(a)){a=0}if(a>0){a=a.toFixed(2)}return{swatch:a}}var n={},i,r,o,d,c=$.isEmptyObject(t);if(c||t.days){i=Math.floor(e/l);e-=i*l;n.days=isNaN(i)?0:i}if(c||t.hours){r=Math.floor(e/f);e-=r*f;n.hours=isNaN(r)?0:r}if(c||t.minutes){o=Math.floor(e/s);e-=o*s;n.minutes=isNaN(o)?0:o}if(c||t.seconds){d=Math.floor(e/u);e-=d*u;n.seconds=isNaN(d)?0:d}if(!c&&t.milliseconds){n.milliseconds=isNaN(e)?0:e}return n};var j=function(e){var t=e.data(i);if(!t){c++;t=c;e.data(i,t)}return t};var x=function(e,t){m[e]=t};var I=function(e){var t=j(e),a=m[t],n;if(undefined===a){a={};n=e.find(".js-time-unit");if(!n||0===n.length){a=null}else{n.each(function(){var e=$(this),t=e.find(".js-time-value"),n=e.data("unit");if(!!n){a[n]={$element:e,$value:t}}})}m[t]=a}return a};var M=function(e,n){var i=j(e),r=I(e),o=0,u=false,s=!!e.data("show-lead-zero"),f=C(n,r),l=0;if(null!==r){$.each(f,function(e,n){var i=r[e];if(!i){return}var f=n.toString(),d=i.$element,v=i.$value,c=!!d.data("remove-on-zero"),m=!!d.data("show-on-zero-previous");if(d){if(m===false||1>l){d.removeClass(t)}if(true===c&&1>n&&1>l){d.remove();delete r[e];u=true}else{if(n===1){d.addClass(a)}else{d.removeClass(a)}if(true===s){f=p(n)}if(!!v&&0<v.length){v.text(f)}else{d.text(f)}o++}}l+=n})}if(0===o){if(!$.isEmptyObject(r)){r=null;x(i,r)}if(!f.seconds){f=C(n,r)}e.html(N(f))}if(u){x(i,r)}};var T=function(e){var t=e.data(n)||null,a;if(null===t){a=I(e);if(null!==a&&a.milliseconds){t=true}e.data(n,t)}return t};var k=function(){if(null===w){w=u;if(h){w=v}}return w};var O=function(e,t){var a=e,n;if(false===t){n=Date.now();a=n%a}return a};var b=function(e){clearTimeout(e.timeoutId);e.timeoutId=null};var z=function(e){var t=e.data("live-msg"),a,n;e.trigger("complete");e.data("complete",true);if(null===t||undefined===t){t="is Live!"}e.html(t);a=g[e.data(o)];n=a.$countdowns;n=n.not(e);a.$countdowns=n};var D=function(){var e=$(this),t=e.data(r),a=y(t);if(a<3e4&&!e.data("almostComplete")){e.trigger("almostComplete");e.data("almostComplete",true)}if(!a){z(e);return}M(e,a)};var E=function(e,t){var a=t.hasTicked,n=t.$countdowns,i;b(t);if(n.length>0){i=O(e,a);n.each(D);if(false===a){t.hasTicked=true}t.timeoutId=setTimeout(function(){E(e,t)},i)}};var P=function(){var e,t;for(e in g){if(g.hasOwnProperty(e)){t=g[e];E(e,t)}}};var q=function(){var e=this,t=$(e),a=t.data("timestamp")||t.text(),n=parseInt(a,10)*1e3,i;t.data(r,n);j(t);if(!h&&T(t)){i=1}else{i=k()}t.data(o,i);if(undefined===g[i]){g[i]=[]}g[i].push(e)};var F=function(e){var a=$.deparam.querystring(),n,i;if(a.swatch){h=true}e.each(q);e.removeClass(t);e.addClass("is-counting");for(n in g){if(g.hasOwnProperty(n)){i=g[n];if(typeof i["$countdowns"]==="undefined"){g[n]={timeoutId:null,hasTicked:false,$countdowns:$(i)}}}}P()};(function(){var t=$(e);if(!t||t.length===0){return}F(t)})();$(document).ajaxComplete(function(){w++;var t=$(e).not(".is-counting");if(!t||t.length===0){return}F(t)})});
$.ui.draggable.prototype._generatePosition=function(t){var i=this.options,s=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&$.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,e=/(html|body)/i.test(s[0].tagName);var o=t.pageX;var f=t.pageY;if(this.originalPosition){var r;if(this.containment){if(this.relative_container){var l=this.relative_container.offset();r=[this.containment[0]+l.left,this.containment[1]+l.top,this.containment[2]+l.left,this.containment[3]+l.top]}else{r=this.containment}if(t.pageX-this.offset.click.left<r[0])o=r[0]+this.offset.click.left;if(t.pageY-this.offset.click.top<r[1])f=r[1]+this.offset.click.top;if(t.pageX-this.offset.click.left>r[2])o=r[2]+this.offset.click.left;if(t.pageY-this.offset.click.top>r[3])f=r[3]+this.offset.click.top}if(i.grid){var a=i.grid[1]?this.originalPageY+Math.round((f-this.originalPageY)/i.grid[1])*i.grid[1]:this.originalPageY;f=r?!(a-this.offset.click.top<r[1]||a-this.offset.click.top>r[3])?a:!(a-this.offset.click.top<r[1])?a-i.grid[1]:a+i.grid[1]:a;var c=i.grid[0]?this.originalPageX+Math.round((o-this.originalPageX)/i.grid[0])*i.grid[0]:this.originalPageX;o=r?!(c-this.offset.click.left<r[0]||c-this.offset.click.left>r[2])?c:!(c-this.offset.click.left<r[0])?c-i.grid[0]:c+i.grid[0]:c}}ret={top:f-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+($.browser.safari&&$.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():e?0:s.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+($.browser.safari&&$.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():e?0:s.scrollLeft())};if($(this.element.parents("div")[0]).css("overflow-x")==="scroll"&&f-this.offset.click.top===ret.top){}return ret};
var Phoenix=function(){};Phoenix._$body=$("body");Phoenix._$window=$(window);Phoenix._$document=$(document);Phoenix._$messageBlock=$("#message-block");Phoenix.setWindow=function(){return Phoenix._$window};Phoenix.setDocument=function(){return Phoenix._$document};Phoenix.setBody=function(){return Phoenix._$body};Phoenix.setMessageBlock=function(){return Phoenix._$messageBlock};Phoenix.getWindow=function(){return Phoenix._$document};Phoenix.getDocument=function(){return Phoenix._$document};Phoenix.getBody=function(){return Phoenix._$body};Phoenix.getMessageBlock=function(){return Phoenix._$messageBlock};Phoenix._uniqueIdAlphabet="abcdefghijklmnopqrstuvwxyz0123456789";Phoenix._uniqueIdAlphabetLength=Phoenix._uniqueIdAlphabet.length-1;Phoenix.makeUniqueId=function(e,n){var o="";var t=0,i=Phoenix._uniqueIdAlphabetLength;var u=Phoenix._uniqueIdAlphabet;var h,r;if(e===undefined){e=""}for(h=0,r;h<n;h++){r=Math.floor(Math.random()*(i-t+1))+t;o+=u[r]}return e+o};Phoenix.userLoggedIn=function(){return $("meta[name=userAuthState]").attr("content")==="loggedIn"};
Phoenix.Cryptography=function(){};Phoenix.Cryptography.random=function(r,e){r=parseInt(r,10);e=parseInt(e,10);if(!isNaN(r)&&!isNaN(e)){return Math.floor(Math.random()*(e-r+1))+r}return Math.random()};Phoenix.Cryptography.randomString=function(r,e){if(!r){r=32}var a="0123456789";var o="abcdef";var n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";var i=n.toLowerCase()+n+a+"+/";var t="";if(e!==undefined){if(e==="alphanumeric"){i=n.toLowerCase()+n+a}else if(e==="base56"){i=n.toLowerCase()+n+a.substr(2)}else if(e==="alpha"){i=n.toLowerCase()+n}else if(e==="base36"){i=n+a}else if(e==="hexadecimal"){i=o+a}else if(e==="numeric"){i=a}}for(var s=0,f=i.length-1;s<r;s++){t+=i.charAt(Phoenix.Cryptography.random(0,f))}return t};
Phoenix.CMS=function(){};
Phoenix.jQuery=function(e,n){"use strict";var t={};var r={setWindow:function(){t.win=$(e);return t.win},setDocument:function(){t.doc=$(n);return t.doc},setHtml:function(){t.html=$("html");return t.html},setBody:function(){t.body=$("body");return t.body},setWrapper:function(){t.wrapper=$("#wrapper");return t.wrapper},setMessageBlock:function(){t.messageBlock=$("#message-block");return t.messageBlock},setLoadingScreen:function(e){if(!e){e="Very busy&hellip;"}t.loadingScreen=$('<div class="modal-backdrop"></div><div class="loading-global">'+e+"</div>").data("msg",e);return t.loadingScreen}};var o={getWindow:function(){return t.win||r.setWindow()},getDocument:function(){return t.doc||r.setDocument()},getHtml:function(){return t.html||r.setHtml()},getBody:function(){return t.body||r.setBody()},getWrapper:function(){return t.wrapper||r.setWrapper()},getMessageBlock:function(){return t.messageBlock||r.setMessageBlock()},getLoadingScreen:function(e,n){return t.loadingScreen&&(t.loadingScreen.data("msg")===e||n)?t.loadingScreen:r.setLoadingScreen(e)},getEvents:function(n){var t=function(){var n=$(this);var r=n.data("events");if(r===undefined){return}e.console.log(n,r);if(n.children().length!==0){t(n.children())}};var r=n.data("events");if(r!==undefined){e.console.log(n,n.data("events"))}n.children().each(t)}};return o}(this,this.document);
Phoenix.Grammar={};Phoenix.Grammar._humanizeCache={};Phoenix.Grammar._underscorizeCache={};Phoenix.Grammar._camelizeCache={upper:{},lower:{}};Phoenix.Grammar._rules={humanize:{},camelize:{},singularize:{},pluralize:{},underscorize:{}};Phoenix.Grammar._pluralizeCache={};Phoenix.Grammar._singularizeCache={};Phoenix.Grammar._singularToPluralRules=[[/([ml])ouse$/i,"ice"],[/(media|info(rmation)?|news)$/i,""],[/(phot|log|vide)o$/i,"os"],[/^(q)uiz$/i,"uizzes"],[/(c)hild$/i,"hildren"],[/(p)erson$/i,"eople"],[/(m)an$/i,"en"],[/([ieu]s|[ieuo]x)$/i,"es"],[/([cs]h)$/i,"es"],[/(ss)$/i,"es"],[/([aeo]l)f$/i,"ves"],[/([^d]ea)f$/i,"ves"],[/(ar)f$/i,"ves"],[/([nlw]i)fe$/i,"ves"],[/([aeiou]y)$/i,"s"],[/([^aeiou])y$/i,"ies"],[/([^o])o$/i,"oes"],[/s$/i,"ses"],[/(.)$/i,"s"]];Phoenix.Grammar._pluralToSingularRules=[[/([ml])ice$/i,"ouse"],[/(media|info(rmation)?|news)$/i,""],[/(q)uizzes$/i,"uiz"],[/(c)hildren$/i,"ild"],[/(p)eople$/i,"erson"],[/(m)en$/i,"an"],[/((?!sh).)oes$/i,"o"],[/((?!o)[ieu]s|[ieuo]x)es$/i,""],[/([cs]h)es$/i,""],[/(ss)es$/i,""],[/([aeo]l)ves$/i,"f"],[/([^d]ea)ves$/i,"f"],[/(ar)ves$/i,"f"],[/([nlw]i)ves$/i,"fe"],[/([aeiou]y)s$/i,""],[/([^aeiou])ies$/i,"y"],[/(la)ses$/i,"s"],[/(.)s$/i,""]];Phoenix.Grammar._commonize=function(e,r,a){if(a[e]){return a[e]}var i=e;e=e.charAt(0).toLowerCase()+e.substr(1);if(e.indexOf("_")!==-1&&e.toLowerCase()===e){}else if(e.indexOf(" ")!==-1){e=e.replace(/\s+/g,"_").toLowerCase()}else{var n;do{n=e;e=e.replace(/([a-zA-Z])([0-9])/,"$1"+r+"$2");e=e.replace(/([a-z0-9A-Z])([A-Z])/,"$1"+r+"$2")}while(n!==e);e=e.toLowerCase()}a[i]=e;return e};Phoenix.Grammar.underscorize=function(e){if(Phoenix.Grammar._rules.underscorize[e]!==undefined){return Phoenix.Grammar._rules.underscorize[e]}return Phoenix.Grammar._commonize(e,"_",Phoenix.Grammar._underscorizeCache)};Phoenix.Grammar.humanize=function(e){if(Phoenix.Grammar._rules.humanize[e]!==undefined){return Phoenix.Grammar._rules.humanize[e]}if(Phoenix.Grammar._humanizeCache[e]){return Phoenix.Grammar._humanizeCache[e]}var r=e;if(e.indexOf(" ")===-1){if(e.indexOf("_")===-1){e=Phoenix.Grammar.underscorize(e)}e=e.replace(/_/g," ");var a=e.split(" ");for(var i=0;i<a.length;i++){a[i]=a[i].charAt(0).toUpperCase()+a[i].substr(1)}e=a.join(" ");var n=/(\b(api|css|gif|html|id|jpg|js|mp3|pdf|php|png|sql|swf|url|xhtml|xml)\b)/gi;e=e.replace(n,function(e){return e.toUpperCase()});e=e.replace(/\.(\w+)$/,function(e,r){return"."+r.charAt(0).toUpperCase()+r.substr(1)})}Phoenix.Grammar._humanizeCache[r]=e;return e};Phoenix.Grammar.camelize=function(e,r,a){if(Phoenix.Grammar._rules.camelize[e]!==undefined){return Phoenix.Grammar._rules.camelize[e]}if(r&&Phoenix.Grammar._camelizeCache.upper[e]){return Phoenix.Grammar._camelizeCache.upper[e]}else if(!r&&Phoenix.Grammar._camelizeCache.lower[e]){return Phoenix.Grammar._camelizeCache.lower[e]}if(r===undefined){r=false}if(a===undefined){a="_"}var i=e;if(e.indexOf(" ")!==-1){e=e.replace(/\s+/g,a).toLowerCase()}if(e.indexOf(a)===-1){if(r){e=e.charAt(0).toUpperCase()+e.substr(1)}}else{var n=e.indexOf(a);var m;var u=[];while(n!==-1){m=e.charAt(0).toUpperCase();u.push(m+e.substr(1,n-1));e=e.substr(n+1);n=e.indexOf(a)}u.push(e.charAt(0).toUpperCase()+e.substr(1));e=u.join("");if(!r){e=e.charAt(0).toLowerCase()+e.substr(1)}}if(r){Phoenix.Grammar._camelizeCache.upper[i]=e}else{Phoenix.Grammar._camelizeCache.lower[i]=e}return e};Phoenix.Grammar.inflectOnQuantity=function(e,r,a){if(e!==1){return a.replace("%d",e.toString())}return r};Phoenix.Grammar._splitLastWord=function(e){if(e.indexOf(" ")!==-1){return[e.substr(0,e.lastIndexOf(" ")+1),e.substr(e.lastIndexOf(" ")+1)]}if(e===Phoenix.Grammar.underscorize(e)){if(e.indexOf(" ")===-1){return["",e]}return[e.substr(0,e.lastIndexOf("_")+1),e.substr(e.lastIndexOf("_")+1)]}var r=e.match(/(.*)((?=[a-zA-Z_]|^)(?:[0-9]+|[A-Z][a-z]*)|(?=[0-9A-Z_]|^)(?:[A-Z][a-z]*))$/);if(r.length&&r.length===3){return[r[1],r[2]]}return["",e]};Phoenix.Grammar.pluralize=function(e){if(Phoenix.Grammar._rules.pluralize[e]!==undefined){return Phoenix.Grammar._rules.pluralize[e]}if(Phoenix.Grammar._pluralizeCache[e]!==undefined){return Phoenix.Grammar._pluralizeCache[e]}var r=e;var a=null;var i,n;var m=Phoenix.Grammar._splitLastWord(e);var u,o,s;i=m[0];n=m[1];for(var l=0;l<Phoenix.Grammar._singularToPluralRules.length;l++){o=Phoenix.Grammar._singularToPluralRules[l][0];u=Phoenix.Grammar._singularToPluralRules[l][1];if(o.test(n)){s=n.match(o);a=i+n.replace(o,(s[1]?"$1":"")+u);break}}Phoenix.Grammar._pluralizeCache[r]=a;return a};Phoenix.Grammar.singularize=function(e){if(Phoenix.Grammar._rules.singularize[e]!==undefined){return Phoenix.Grammar._rules.singularize[e]}if(Phoenix.Grammar._singularizeCache[e]!==undefined){return Phoenix.Grammar._singularizeCache[e]}var r=e;var a=null;var i,n,m;var u,o,s;m=Phoenix.Grammar._splitLastWord(e);i=m[0];n=m[1];for(var l=0;l<Phoenix.Grammar._pluralToSingularRules.length;l++){o=Phoenix.Grammar._pluralToSingularRules[l][0];u=Phoenix.Grammar._pluralToSingularRules[l][1];if(o.test(n)){s=n.match(o);a=i+n.replace(o,(s[1]?"$1":"")+u);break}}Phoenix.Grammar._singularizeCache[r]=a;return a};Phoenix.Grammar.addSingularPluralRule=function(e,r){Phoenix.Grammar._rules.singularize[r]=e;Phoenix.Grammar._rules.pluralize[e]=r};Phoenix.Grammar.addHumanizeRule=function(e,r){Phoenix.Grammar._rules.humanize[e]=r};Phoenix.Grammar.addCamelUnderscoreRule=function(e,r){Phoenix.Grammar._rules.camelize[r]=e;Phoenix.Grammar._rules.underscorize[e]=r};
Phoenix.Request={};Phoenix.Request._REQUEST=null;Phoenix.Request._cast=function(e,n){var i,t={"true":1,yes:1,on:1,"false":0,no:0,off:0};var s=e;switch(n){case"number":s=parseInt(e,10);if(isNaN(s)){s=e?1:0}break;case"float":s=parseFloat(s);if(isNaN(s)){s=e?1:0}break;case"bool":case"boolean":i=e&&e.toLowerCase?e.toLowerCase():"";if(t[i]!==undefined){s=t[i]?true:false}else{s=e?true:false}break}return s};Phoenix.Request._initialize=function(){if(Phoenix.Request._REQUEST===null){var e=location.search.substr(1);var n=e.split("&");var i={},t;for(var s=0;s<n.length;s++){t=n[s].split("=");i[t[0]]=t[1]}Phoenix.Request._REQUEST=i}};Phoenix.Request.get=function(e,n,i,t){Phoenix.Request._initialize();if(t===undefined){t=false}if(i===undefined){i=null}if(n===undefined){n="string"}var s=Phoenix.Request._REQUEST[e];if(s===""&&t){return i}else if(s===undefined){s=i}if(i!==null){return i}return Phoenix.Request._cast(s,n)};
(function(e){"use strict";var s=e.Phoenix,r=e.setTimeout,n=e.clearTimeout,t=1250,o=400,a=s.jQuery.getMessageBlock(),i=" ",c="in",u="message-success",f="message-danger",g="message-info",l="transitioning",m=[l,f,g,u],d="successReferrer",h="successMessage",v="errorReferrer",M="errorMessage",S="error",w="notification",I="success",p=[],k=false,y=null;var j=function(e){a.text("").removeClass(m.join(i));if(!!e){try{e()}catch(s){}}};var z=function(e,s,m){var p,z,b,N,Q,T="",L=[],B=false,C=false;if(null!==y){n(y);y=null}switch(s){case S:L.push(f);B=v;C=M;break;case w:L.push(g);break;case I:L.push(u);B=d;C=h;break;default:break}if(L.length>0){L.push(c);T=L.join(i)}else{T=c}m=m||{};p=m.callback;z=m.afterPost||false;b=m.permanent||false;N=m.hideDelay||t;Q=m.hideDuration||o;if(!!window.Modernizr&&Modernizr.sessionstorage&&z===true&&!!B&&!!C){sessionStorage.setItem(B,location.href);sessionStorage.setItem(C,e)}else{if(k){P.clearPermanentMessage()}a.addClass(T).addClass(l).html(e).fadeIn();if(b===false){y=r(function(){n(y);y=null;a.fadeOut(Q,function(){j(p)})},N)}else{k=true}}};var P={showSuccessMessage:function(e,s){z(e,I,s)},showMessageBar:function(e){z(e)},showErrorMessage:function(e,s){z(e,S,s)},showNotificationMessage:function(e,s){z(e,w,s)},showPermanentMessage:function(e){z(e,w,{permanent:true})},checkSuccessMessages:function(){if(!window.Modernizr||!Modernizr.sessionstorage)return;var e=sessionStorage.getItem(d);if(e){if(e===document.referrer){var s=sessionStorage.getItem(h);z(s,I)}sessionStorage.removeItem(h);sessionStorage.removeItem(d)}},removePermanentMessage:function(e){a.fadeOut(o,function(){j(e)})},clearPermanentMessage:function(){a.hide();j()},checkErrorMessages:function(){if(!window.Modernizr||!Modernizr.sessionstorage)return;var e=sessionStorage.getItem(v);if(e){if(e===document.referrer){var s=sessionStorage.getItem(M);z(s,S)}sessionStorage.removeItem(M);sessionStorage.removeItem(v)}},showLoadingScreen:function(e){var r=s.jQuery.getLoadingScreen(e);s.jQuery.getBody().append(r)},hideLoadingScreen:function(){var e=s.jQuery.getLoadingScreen(null,true);e.remove()},convertTime:function(e,s){if(!e){e=0}else if(e<0||isNaN(e)){if(e.split(":").length>0){return e}else{e=0}}var r=Math.floor(e/60%60);var n=Math.floor(e/60/60);var t=Math.floor(e%60);if(t<10){t="0"+t}if(r<10){r="0"+r}if(e>3600||s===true){return n+":"+r+":"+t}else{return r+":"+t}},convertTimeToSeconds:function(e){if(e){var s=e.split(":");if(s.length>=3){return+s[0]*60*60+ +s[1]*60+ +s[2]}else if(!isNaN(e)){return parseInt(e)}}return 0}};s.Ui=P;s.jQuery.getDocument().ready(function(){s.Ui.checkSuccessMessages();s.Ui.checkErrorMessages()})})(this);
Phoenix.Core={_debugEnabled:false,keycodes:{enterKey:13,rightArrow:39,leftArrow:37,upArrow:38,downArrow:40,escapeKey:27},isTrue:function(e,n){if(n===undefined){n=false}if(typeof e==="string"){e=e.toLowerCase()}return!!e||"true"===e||n},getDebug:function(){return Phoenix.Core._debugEnabled},enableDebugging:function(e){Phoenix.Core._debugEnabled=e?true:false},debug:function(e){if(Phoenix.Core._debugEnabled){console.log(e)}},basename:function(e){var n=e.split("/");return n[n.length-1]}};
Phoenix.Uploader=function(){"use strict";return this};Phoenix.Uploader._init=function(e,t){"use strict";var i;var a=["main","url","previous","search","progress"];var s={progressItem:true,searchItem:true,searchListItem:true,searchImageItem:true};var r={previewImage:true};var n=$.browser.msie&&$.browser.version>=10;$.each(t["modals"]["uploader"],function(t,i){if(s[t]!==undefined){e._templates[t]=$(i);if(n){e._templates[t].removeClass("fade");e._templates[t].find("*").removeClass("fade")}}else if(r[t]!==undefined){e._templates[t]=$(i);if(n){e._templates[t].removeClass("fade");e._templates[t].find("*").removeClass("fade")}}else{e._modals[t]=$(i);if(n){e._modals[t].removeClass("fade");e._modals[t].find("*").removeClass("fade")}}if(t!=="main"&&s[t]===undefined&&r[t]===undefined){e._modals[t].modal(Phoenix.Uploader.SUBMODAL_OPTIONS)}});for(i=0;i<a.length;i++){e._modals[a[i]].appendTo(document.body)}e._templates["previewImage"].insertAfter(e._modals["search"]);e._modals["progress"].on("hidden",function(){e._abortXHR();e._resetAll()});e._modals["main"].find(".modal-footer").addClass("hide");e._modals["main"].modal({show:false,keyboard:true,backdrop:"static"});e._modals["previous"].on("hidden",function(){var t=$(this);e._templates["previewImage"].find("img").attr("src","");e._templates["previewImage"].find(".width").text("");e._templates["previewImage"].find(".height").text("");t.find(".galleries > li:not(:first-child)").remove();t.find(".images-in-gallery > li:not(.loading)").remove()});if(typeof window.File==="undefined"){e._modals["main"].find(".modal-body > p").addClass("hide")}Phoenix.jQuery.getDocument().trigger("uploaderReady");return e};Phoenix.Uploader.DEFAULT_OPTIONS={complete:function(e){"use strict";Phoenix.Core.debug("> complete");Phoenix.Core.debug(e)},error:function(e){"use strict";Phoenix.Core.debug("> error");Phoenix.Core.debug(e);if(e.message){Phoenix.Ui.showErrorMessage("Problem occured while uploading image: "+e.message)}},logger:function(e){"use strict";Phoenix.Core.debug("> logger");Phoenix.Core.debug(e)},type:"image",headerText:"Where does your image live?",postURL:"/images/upload",urlPostURL:"/images/url-submit",placeholderIcon:"",fileType:["image/gif","image/jpeg","image/png"],multiple:false,drop:true,dropText:"Or drag and drop your image to this window.",urlFieldCount:3,showButtons:["desktop","url-address","search-site","previous-uploads"]};Phoenix.Uploader.SUBMODAL_OPTIONS={backdrop:false,show:false};Phoenix.Uploader.EVENT_NAMESPACE="uploader";Phoenix.Uploader.prototype._modals={main:null,url:null,search:null,previous:null,progress:null};Phoenix.Uploader.prototype._templates={progressItem:null,searchImageItem:null};Phoenix.Uploader._instance=null;Phoenix.Uploader._lastDroppedFiles=[];Phoenix.Uploader.getInstance=function(e){"use strict";if(Phoenix.Uploader._instance===null){Phoenix.Uploader._instance=new Phoenix.Uploader}if(typeof e==="function"){e.apply(Phoenix.Uploader._instance,[])}return Phoenix.Uploader._instance};Phoenix.Uploader.prototype.getDefaultProgressListener=function(e){"use strict";var t=this;return function(i){if(!i.lengthComputable){Phoenix.Core.debug("defaultProgressListener(): length not computable!");t._currentOptions.logger({message:"Unable to calculate progress percentage."});e.find(".bar").css("width","100%");e.find(".percent").text("Saving... please wait");return}var a=i["loaded"]||i["position"];var s=i["total"]||i["totalSize"];var r=Math.round(a/s*100);e.find(".bar").css("width",r+"%");e.find(".percent").text(r+"%");if(r>99){e.find(".percent").text("Saving... please wait")}}};Phoenix.Uploader.prototype._resetAll=function(){"use strict";var e=this._modals["progress"];var t=this._modals["url"];var i=this._modals["search"];var a=this._modals["previous"];var s=i.find(".galleries > li");this._lastDroppedFiles=[];e.find("li").remove();$.each(this._modals,function(e,t){t.modal("hide")});i.find("input").val("");a.find("input").val("");t.find("input").each(function(e){if(e===0){$(this).val("");return true}$(this).remove()});s.each(function(e){if(e===0){return true}$(this).remove();e++});a.find(".galleries > li").remove();this._templates["previewImage"].find("img").attr("href","");this._templates["previewImage"].find(".width").text("");this._templates["previewImage"].find(".height").text("");return this};Phoenix.Uploader.prototype._xhr=null;Phoenix.Uploader.prototype._sendFiles=function(e){"use strict";var t=this._lastDroppedFiles;var i=new FormData(this._modals["main"].find("form")[0]);var a=this._xhr=new XMLHttpRequest;var s=this;var r=this._modals["progress"].find("ul");if(t.length===0){Phoenix.Core.debug("_sendFiles(): files.length === 0!");return this}for(var n=0;n<t.length;n++){i.append("files["+n+"]",t[n])}if(e===undefined){e=this.getDefaultProgressListener(r)}a.ontimeout=function(){s._currentOptions.error($.extend({},{status:this.status},i));this.abort();s._resetAll()};var o=function(){var e={};var i=false;var a,n;var o;var l;if(this.readyState===4){if(this.status===200){e=$.parseJSON(this.responseText);i=$.isPlainObject(e);if(!i||!e["successful"]){s._currentOptions.error({message:'No "successful" array/object was returned in the JSON response.'});return}s._modals["progress"].find(".progress").addClass("progress-success");s._modals["progress"].find(".progress").removeClass("active");r.find(".bar").css("width","100%");r.find(".percent").text("Done!");l=0;$.each(e["successful"],function(i,a){if(t[l]===undefined){return false}if(typeof e["successful"][i]=="string"||e["successful"][i]instanceof String){if(t[l].name){e["successful"]["clientName"]=t[l].name}if(t[l].type){e["successful"]["clientType"]=t[l].type}}else{if(t[l].name){e["successful"][i]["clientName"]=t[l].name}if(t[l].type){e["successful"][i]["clientType"]=t[l].type}}l++});s._currentOptions.complete(e);s._resetAll()}else{try{e=$.parseJSON(this.responseText);i=$.isPlainObject(e)}catch(d){i=true;e={errors:{file:"Failed to upload file. Please try again."}}}if(s._currentOptions.type==="image"){o="images"}else{o="files"}Phoenix.Ui.showErrorMessage("Error uploading "+o+": "+this.statusText);s._currentOptions.error($.extend({},{status:this.status},i?e:{successful:{}}));this.abort();s._resetAll()}try{s._modals["main"].find("input")[0].value=""}catch(d){n=$("#js-uploader-file-input");a=$("#js-uploader-file-input").clone(true);a.val("");n.remove();s._modals["main"].prepend(a)}}else if(this.readyState>1){try{if(this.status===413){e={message:this.responseText};s._currentOptions.error($.extend({},{status:this.status},e));this.abort();s._resetAll()}else{if(this.status===504){e={message:"Request timed out"};s._currentOptions.error($.extend({},{status:this.status},e));this.abort();s._resetAll()}}}catch(d){s._currentOptions.error(d)}}};$.get("/blank.html");a.upload.addEventListener("loadstart",function(){},false);a.upload.addEventListener("progress",e,false);a.addEventListener("error",function(){s._currentOptions.error({message:"An error occurred during the request.",args:arguments});Phoenix.Ui.showErrorMessage("Error")},false);a.addEventListener("readystatechange",o,false);a.open("POST",this._currentOptions.postURL);a.setRequestHeader("Cache-Control","no-cache");a.setRequestHeader("X-Requested-With","XMLHttpRequest");a.send(i);return this};Phoenix.Uploader.prototype._abortXHR=function(){"use strict";if(this._xhr!==null){this._xhr.abort()}return this};Phoenix.Uploader.prototype._commonFileOnRead=function(e,t){"use strict";var i=this;return function(){var a=t._modals["progress"];var s=a.find("ul");var r=t._templates["progressItem"].clone();r.find("img").attr("src",i.type.substr(0,6)==="image/"?this.result:t._currentOptions.placeholderIcon);r.find(".details > .name").text(i.name);r.find(".details > .percent").text("1%");r.find(".progress > .bar").css("width","1%");s.append(r);if(e){var n="image";if(t._currentOptions.type==="media"){n="file"}if(t._currentOptions.multiple){n+="s"}a.find(".js-modal-title").text("Uploading "+n);a.modal("show");t._sendFiles()}}};Phoenix.Uploader.prototype._modalFileUpload=function(){"use strict";var e=this._modals["progress"];var t="image";var i;var a=e.find("ul");for(var s=0,r,n,o=this._lastDroppedFiles.length;s<o;s++){r=this._lastDroppedFiles[s];if(typeof window.FileReader!=="undefined"){n=new FileReader;n.onloadend=this._commonFileOnRead.call(r,s===this._lastDroppedFiles.length-1,this);n.readAsDataURL(r)}else{i=this._templates["progressItem"].clone();i.find("img").attr("src",this._currentOptions.placeholderIcon);i.find(".details > .name").text(r.name);i.find(".details > .percent").text("1%");i.find(".progress > .bar").css("width","1%");a.append(i);if(s===this._lastDroppedFiles.length-1){if(this._currentOptions.type==="media"){t="file"}if(this._currentOptions.multiple){t+="s"}e.find(".js-modal-title").text("Uploading "+t);e.modal("show");this._sendFiles()}}}};Phoenix.Uploader.prototype._createListItem=function(e,t){"use strict";if(this._currentOptions.type!=="image"||t===undefined){t=this._currentOptions.placeholderIcon}var i=this._templates["progressItem"].clone();i.find("img").attr("src",t);i.find(".details > .name").text(e);i.find(".details > .percent").text("1%");i.find(".progress > .bar").css("width","1%");return i};Phoenix.Uploader._sendURLsCallback=function(){"use strict";var e=this._modals["url"];var t=e.find('[type="url"]');var i={};var a=0;var s=typeof t[0].checkValidity==="function";var r=this;var n=this._modals["progress"];var o=n.find("ul");var l=e.find(".error-message");var d=false;var u=0;l.addClass("hide");t.each(function(){var e=$(this).val();if(!e){return}if(s&&!this.checkValidity()||!/^https?\:\/\//.test(e)){l.removeClass("hide");d=true;return false}var t=e.split(/https?\:\/\//);var n;if(!t[0]){n=t[1]}else{n=t[0]}n=n.substr(0,20)+"...";var p;i["urls["+a+"]"]=e;p=r._createListItem(n,e);o.append(p);u++;a++});if(a===0||d){return}var p=function(e,t){var i=o.children("li");i.find(".progress > .bar").css("width",t+"%");i.find(".details > .percent").text(e)};p("",0);n.modal("show");setTimeout(function(){p("Saving... please wait",25)},200);this._xhr=$.post(this._currentOptions.urlPostURL,i,function(e){p("Done",100);n.find(".progress").addClass("progress-success");n.find(".progress").removeClass("active");$.each(e["successful"],function(t,i){e["successful"][t]["clientName"]=i["name"]?i["name"]:"";e["successful"][t]["clientType"]=i["mimeType"]?i["mimeType"]:""});setTimeout(function(){r._resetAll();r._currentOptions.complete(e);r._resetAll()},300)},"json").error(function(e){var t;try{t=$.parseJSON(e.responseText)}catch(i){t={url:"An unknown error occurred. Please try again."}}r._resetAll();r._currentOptions.error(t)})};Phoenix.Uploader.prototype._eventsBound={desktopButtonClick:false,fileInputChange:false,urlModalNext:false,searchModalNext:false,searchModalClose:false,previousModalNext:false,previousModalClose:false,urlAddFieldClick:false,searchFieldAutocomplete:false,dragAndDrop:false,previousModalShown:false,modalEditClick:false,modalSelectButtonClick:false,modalPreviewClick:false,previousModalScroll:false,galleryImageClick:false,searchModalTagClick:false};Phoenix.Uploader._currentSearchGUID=null;Phoenix.Uploader._addURLFieldCallback=function(e){"use strict";var t=$(this);var i=t.parent();var a=i.find("input").length;if(a===10){e.preventDefault();return false}var s=i.find("input:first-child").clone();s.val("").insertBefore(t);e.preventDefault();return false};Phoenix.Uploader.prototype._enableDragAndDrop=function(e){"use strict";if(typeof window.File==="undefined"){return this}var t=Phoenix.jQuery.getBody();var i=this;var a=function(e){e.preventDefault();e.stopPropagation();if(!e.originalEvent.dataTransfer||!e.originalEvent.dataTransfer.files){return false}i._lastDroppedFiles=e.originalEvent.dataTransfer.files;if(!i._currentOptions.multiple){i._lastDroppedFiles=[i._lastDroppedFiles[0]]}i._modalFileUpload();return false};var s=function(e){e.preventDefault();e.stopPropagation();return false};if(!e&&this._eventsBound.dragAndDrop){t.unbind("dragover."+Phoenix.Uploader.EVENT_NAMESPACE);t.unbind("drop."+Phoenix.Uploader.EVENT_NAMESPACE);this._eventsBound.dragAndDrop=false;return this}if(!this._eventsBound.dragAndDrop){t.bind("dragover."+Phoenix.Uploader.EVENT_NAMESPACE,s);t.bind("dragenter."+Phoenix.Uploader.EVENT_NAMESPACE,s);t.bind("drop."+Phoenix.Uploader.EVENT_NAMESPACE,a);this._eventsBound.dragAndDrop=true}return this};Phoenix.Uploader.show=function(){"use strict";var e=/Safari\/\d+/.test(navigator.userAgent)&&navigator.vendor==="Apple Computer, Inc.";var t;Phoenix.Uploader.getInstance(function(){var i=this;var a=this._modals["main"];var s=false;var r,n,o;var l;if(!a){return}var d=$("#js-uploader-file-input");var u=$("#js-desktop-button");var p=this._modals["url"];var c=p.find(".js-add-another");var f=$("#swfuploader-placeholder");var h="/bundles/phoenixsite/images/core/loose/loading-light.gif";a.find(".js-modal-title").text(this._currentOptions.headerText);if(e){a.on("shown",function(){d.css($.extend({},{width:u.outerWidth()},u.position()));d.css("top",parseInt(d.css("top"),10)+1);a.off("shown")})}else if(!this._eventsBound.desktopButtonClick){if(typeof window.File==="function"||typeof window.File==="object"){$(window).bind("blur",function(){u.prop("disabled",true);setTimeout(function(){u.prop("disabled",false)},2e3)}).bind("focus",function(){u.prop("disabled",false)});u.click(function(e){d.click();e.preventDefault();return false});d.css("left",-1e4)}else{d.addClass("hide");if(f.length===0){f=$('<div id="swfuploader-placeholder">').insertAfter(u)}var m=0;var g=0;var v=[];t=new SWFUpload({upload_url:this._currentOptions.postURL,flash_url:"/bundles/phoenixsite/flash/swfupload.swf",file_size_limit:"10 MB",file_post_name:"files[]",button_placeholder_id:"swfuploader-placeholder",button_width:73,button_height:20,post_params:{"X-Requested-With":"SWFUpload"},file_upload_limit:this._currentOptions.multiple?10:1,prevent_swf_caching:false,button_text:u.text(),button_cursor:SWFUpload.CURSOR.HAND,button_window_mode:SWFUpload.WINDOW_MODE.TRANSPARENT,file_dialog_complete_handler:function(e){m=0;g=e;this.startUpload()},upload_start_handler:function(e){var t=i._modals["progress"];var a=t.find("ul");var s;if(t.hasClass("hide")){t.modal("show")}s=i._templates["progressItem"].clone();s.attr("id","swfupload-"+e.id);s.find("img").attr("src",h);s.find(".details > .name").text(e.name);s.find(".details > .percent").text("1%");s.find(".progress > .bar").css("width","1%");a.append(s)},upload_progress_handler:function(e,t,i){var a=Math.round(t/i*100)+"%";var s=$("#swfupload-"+e.id);s.find(".details > .percent").text(a);s.find(".progress > .bar").css("width",a)},upload_error_handler:function(e,t,i){throw[e,t,i]},upload_success_handler:function(e,t){var a=$("#swfupload-"+e.id);a.find(".details > .percent").text("100%");a.find(".progress > .bar").css("width","100%");m++;if(!i._currentOptions.multiple){i._currentOptions.complete($.parseJSON(t))}else if(m==g){v.push(t);var s={successful:{}};$.each(v,function(e,t){try{var i=$.parseJSON(t)["successful"];$.each(i,function(e,t){s["successful"][e]=t})}catch(a){}});i._currentOptions.complete(s);v=[]}else if(i._currentOptions.multiple){v.push(t)}},upload_complete_handler:function(){if(i._currentOptions.multiple&&m<g){this.startUpload()}},swfupload_loaded_handler:function(){u.prop("disabled",false);f=u.next("object").css({marginLeft:-u.outerWidth()-5,marginRight:5,opacity:0,width:u.outerWidth(),height:u.outerHeight(),position:"relative",top:12})}});u.prop("disabled",true)}this._eventsBound.desktopButtonClick=true}if(!this._eventsBound.fileInputChange){if(typeof window.File==="function"||typeof window.File==="object"){d.change(function(){if(this.files&&this.files.length){i._lastDroppedFiles=this.files;i._modalFileUpload()}})}this._eventsBound.fileInputChange=true}d.prop("multiple",this._currentOptions.multiple);d.attr("accept",this._currentOptions.fileType.join(","));if(!this._currentOptions.multiple){c.addClass("hide")}else{c.removeClass("hide");if(!this._eventsBound.urlAddFieldClick){c.click(Phoenix.Uploader._addURLFieldCallback);this._eventsBound.urlAddFieldClick=true}}if(!this._eventsBound.urlModalNext){p.find(".js-btn-next").click(function(e){Phoenix.Uploader._sendURLsCallback.apply(i,[]);e.preventDefault();return false});this._eventsBound.urlModalNext=true}var _=function(){Phoenix.Core.debug("Error occurred while getting data.");Phoenix.Core.debug(arguments,true)};var x=i._modals["search"].find(".images-in-gallery");var C=i._modals["search"].find(".galleries");var w=function(e){return function(t,a){var s=a["original"];var r=a["thumbnail"];var n=i._templates["searchImageItem"].clone();var o=n.find(".dimensions");n.attr("data-original-url",s);n.attr("data-original-width",a["width"]);n.attr("data-original-height",a["height"]);n.attr("data-image-id",a["id"]);n.attr("data-mimetype",a["mimetype"]);n.find("img").attr("src",r);n.find("a").attr("title",a["caption"]);o.find(".width").text(a["width"]);o.find(".height").text(a["height"]);n.insertBefore(e.children("li.loading"))}};var y=function(e){return function(t,i){var a=i["name"];var s=i["id"];var r,n;if(a.toLowerCase()==="all images"){n=e.find(".all-images-link").parent();if(n.length===0){n=$('<li class="selected"/>');n.append($('<a href="#" class="all-images-link"/>').text("All Images"));e.append(n)}n.children("a").attr("data-id",s);return}r=$("<li>");r.append($('<a href="#">').text(a).attr("data-id",s));e.append(r)}};var b=function(e,t){return function(i){var a=i["images"];var s=i["tags"];var r=x.parent().find(".js-no-images");var n=x.parent().find("li.loading");var o=x.parent().find(".js-error");n.addClass("hide");r.addClass("hide");o.addClass("hide");if(t===undefined||t){x.find("li:not(.loading)").remove()}if(a===undefined||s===undefined||a.length===0){r.removeClass("hide");return}$.each(a,w(x));if(e){$.each(s,y(C))}}};var P=function(e,t,a){return function(s){var r=$(this);var n=parseInt(r.attr("data-id"),10);var o={count:16,tag:n};var l=r.parent().find(".js-no-images");var d=x.parent().find("li.loading");var u=x.parent().find(".js-error");d.removeClass("hide");l.addClass("hide");u.addClass("hide");if(isNaN(n)){d.addClass("hide");u.removeClass("hide");s.preventDefault();return false}x.find("li:not(.loading)").remove();r.parents(".galleries").find("li").removeClass("selected");r.parent().addClass("selected");if(a){o=$.extend({},o,{object:i._currentSearchGUID})}$.post(e,o,t(false),"json").error(function(){_();d.addClass("hide");u.removeClass("hide")});s.preventDefault();return false}};if(!this._eventsBound.searchFieldAutocomplete){var U=this._modals["search"].find("input");U.autocomplete({autoRedirect:false,delay:0,showNotificationBar:true,onItemSelect:function(e){if(!Object.keys(e).length){return false}i._modals["search"].children("form").trigger("reset");if(isNaN(e["contentTypeId"])){return false}if(isNaN(e["id"])){return false}var t=e["contentTypeId"]+"-"+e["id"];var a={object:t,count:16};i._modals["search"].find("li:not(.loading)").remove();i._modals["search"].find("li.loading").removeClass("hide");i._modals["search"].find(".js-error").addClass("hide");i._modals["search"].find(".js-no-images").addClass("hide");i._currentSearchGUID=t;AjaxApiRequest.makePostApiRequest("/api/image/object-image/",a,b(true),function(){_();i._modals["search"].find("li.loading").addClass("hide");i._modals["search"].find(".js-error").removeClass("hide")});return false}});this._eventsBound.searchFieldAutocomplete=true}if(!this._eventsBound.searchModalClose){var O=function(){var e=$(this);e.find(".galleries > li:not(:first-child)").removeAttr("data-id").remove();e.find(".images-in-gallery > li:not(.loading)").remove()};this._modals["search"].on("hidden",O);this._eventsBound.searchModalClose=true}if(!this._eventsBound.searchModalTagClick){this._modals["search"].on("click",".galleries > li > a",P("/api/image/object-image/",b,true));this._eventsBound.searchModalTagClick=true}l=function(e,t){return function(a){var s=a["images"];var r=a["tags"];var n=i._modals["previous"].find(".images-in-gallery");var o=i._modals["previous"].find(".galleries");var l=o.parent().find("li.loading");var d=o.parent().find(".js-no-images");var u=o.parent().find(".js-error");l.addClass("hide");d.addClass("hide");u.addClass("hide");if(t===undefined||t){n.children("li:not(.loading)").remove()}if(s===undefined||r===undefined||!s.length){d.removeClass("hide");return}$.each(s,w(n));if(e){$.each(r,y(o))}}};if(!this._eventsBound.previousModalShown){this._modals["previous"].on("show",function(){var e=$(this).find(".loading");e.removeClass("hide");AjaxApiRequest.makePostApiRequest("/api/image/user-image/",{count:16},l(true),function(){e.addClass("hide")})});this._modals["previous"].on("click",".galleries > li > a",function(e){var t=$(this);var i=parseInt(t.attr("data-id"),10);var a=t.parents(".galleries");var s=a.siblings(".images-in-gallery-container");if(isNaN(i)){s.find(".js-error").removeClass("hide");e.preventDefault();return false}s.find("li:not(.loading)").remove();s.find("li.loading").removeClass("hide");a.find("li").removeClass("selected");t.parent().addClass("selected");AjaxApiRequest.makePostApiRequest("/api/image/user-image/",{count:16,tag:i},l(),function(){_();s.find("li.loading").addClass("hide");s.find(".js-error").removeClass("hide")});e.preventDefault();return false});this._eventsBound.previousModalShown=true}var A=function(e){return function(){var t=$(this).parents("li");var a;var s=t.attr("data-original-url");if(!i._currentOptions.multiple){t.parent().children("li").removeClass("selected")}t.addClass("selected");a={successful:{}};a["successful"][s]={url:s,clientName:Phoenix.Core.basename(s),clientType:t.attr("data-mimetype"),id:null,guid:null};a.from=e;i._currentOptions.complete(a)}};if(!this._eventsBound.modalEditClick){this._modals["previous"].on("click","li span.js-edit",A("previous"));this._modals["search"].on("click","li span.js-edit",A("search"));this._eventsBound.modalEditClick=true}if(!this._eventsBound.modalPreviewClick){var I=function(){var e=i._templates["previewImage"];var t=$(this).parents("li");var a=t.attr("data-original-url");var s=t.attr("data-original-width");var r=t.attr("data-original-height");var n=t.find("a").attr("title");e.find(".width").text(s);e.find(".height").text(r);e.find("img").attr("src",a).attr("title",n);e.removeClass("hide")};this._modals["previous"].on("click","li span.js-preview",I);this._modals["search"].on("click","li span.js-preview",I);this._templates["previewImage"].on("click",function(){$(this).addClass("hide")});this._eventsBound.modalPreviewClick=true}if(!this._eventsBound.modalSelectButtonClick){var k=function(e){return function(t){var s=i._modals[e];var r=s.find(".images-in-gallery > li.selected");var n={successful:{}};if(r.length!==0){r.each(function(){var e=$(this).attr("data-original-url");var t=parseInt($(this).attr("data-image-id"),10);n["successful"][e]={url:e,id:isNaN(t)?null:t,guid:isNaN(t)?null:"1300-"+t}});i._currentOptions.complete(n);s.modal("hide");a.modal("hide")}t.preventDefault();return false}};this._modals["previous"].on("click",".btn-success",k("previous"));this._modals["search"].on("click",".btn-success",k("search"));this._eventsBound.modalSelectButtonClick=true}var D=function(e,t,a,r,n,o){return function(){if(this.scrollHeight-this.offsetHeight===this.scrollTop&&!s){var a=r.find("li:not(.loading)").length;var l=parseInt(t.parent().find(".galleries > .selected > a").attr("data-id"),10);var d={count:16,start:a,tag:l};var u=t.find("li.loading");u.removeClass("hide");if(isNaN(l)){u.addClass("hide");return}if(o){d=$.extend({},d,{object:i._currentSearchGUID})}s=true;AjaxApiRequest.makePostApiRequest(e,d,function(e){s=false;u.addClass("hide");n(false,false)(e);if(!e||!e["images"]||!e["images"].length){t.find(".js-no-images").hide()}},function(){u.addClass("hide");window.alert("Error loading images. Please try again")})}}};if(!this._eventsBound.previousModalScroll){r=this._modals["previous"].find(".images-in-gallery-container");n=this._modals["previous"].find(".images-in-gallery-container > .navigation");o=this._modals["previous"].find(".images-in-gallery");r.on("scroll",D("/api/image/user-image/",r,n,o,l));this._eventsBound.previousModalScroll=true}if(!this._eventsBound.searchModalScroll){r=this._modals["search"].find(".images-in-gallery-container");n=this._modals["search"].find(".images-in-gallery-container > .navigation");o=this._modals["search"].find(".images-in-gallery");r.on("scroll",D("/api/image/object-image/",r,n,o,b,true));this._eventsBound.searchModalScroll=true}if(!this._eventsBound.galleryImageClick){var S=function(e){var t=$(this);var a=t.parent();if(a.hasClass("selected")){a.removeClass("selected")}else{if(!i._currentOptions.multiple){a.parent().find(".selected").removeClass("selected")}a.addClass("selected")}e.preventDefault();return false};this._modals["previous"].on("click",".images-in-gallery > li > a",S);this._modals["search"].on("click",".images-in-gallery > li > a",S);this._eventsBound.galleryImageClick=true}this._enableDragAndDrop(this._currentOptions.drop);this._modals["main"].find(".modal-body > p").text(this._currentOptions.dropText)})};Phoenix.Uploader.uploadDataURIImage=function(e,t,i,a){"use strict";var s=typeof Blob==="function"&&typeof FormData==="function"&&typeof Uint8Array==="function"&&typeof ArrayBuffer==="function"&&typeof DataView==="function";var r,n,o;var l,d,u,p;var c,f;if(s){r=new XMLHttpRequest;n=new FormData;t=Phoenix.Core.basename(t);if(e.split(",")[0].indexOf("base64")>=0){l=window.atob(e.split(",")[1])}else{l=window.unescape(e.split(",")[1])}d=e.split(",")[0].split(":")[1].split(";")[0];u=new ArrayBuffer(l.length);p=new Uint8Array(u);for(c=0,f=l.length;c<f;c++){p[c]=l.charCodeAt(c)}n.append("filename",t);n.append("blob",new window.Blob([new DataView(u)],{type:d}));r.addEventListener("error",function(){Phoenix.Core.debug({message:"An error occurred during the request.",args:arguments})},false);r.addEventListener("readystatechange",function(){var e;if(this.readyState===4){if(this.status===200){try{e=$.parseJSON(this.responseText);i({successful:{editedImage:{name:t,id:e["id"],url:e["url"],guid:"1300-"+e["id"]}}})}catch(s){a()}}}},false);r.open("POST","/images/upload/blob/");r.setRequestHeader("Cache-Control","no-cache");r.setRequestHeader("X-Requested-With","XMLHttpRequest");r.send(n)}else{o={filename:t,data_uri:e};if(!o["filename"]){o["filename"]=Phoenix.Cryptography.randomString(16,"alphanumeric")}o["filename"]=Phoenix.Core.basename(o["filename"]);AjaxApiRequest.makePostApiRequest("/images/upload/data-uri/",o,function(e){i({successful:{editedImage:{name:o["filename"],id:e["id"],url:e["url"],guid:"1300-"+e["id"]}}})})}};Phoenix.Uploader.prototype._currentOptions=Phoenix.Uploader.DEFAULT_OPTIONS;$(document).ready(function(){"use strict";var e=$("meta[name=modal-cdn-url]").attr("content");$.getJSON(e,function(e){Phoenix.Uploader._init(Phoenix.Uploader.getInstance(),e)});$.uploader=function(e){Phoenix.Uploader.getInstance(function(){if(e.multiple===undefined){e.multiple=false}this._currentOptions=$.extend({},Phoenix.Uploader.DEFAULT_OPTIONS,e);this._originalCallback=this._currentOptions.complete;var t=this;var i=["desktop","url-address","search-site","previous-uploads"];if(!this._modals["progress"]){return}this._modals["progress"].find(".modal-header > .close").click(function(e){t._abortXHR();t._resetAll();e.preventDefault();return false});$.each(i,function(e,i){var a=$('button[data-target="#js-'+i+'-modal"]');if(0<=$.inArray(i,t._currentOptions.showButtons)){a.removeClass("hide")}else{a.addClass("hide")}});Phoenix.Uploader.show()})}});
(function(n){"use strict";var t="#view-guid-meta";var e=n.jQuery,i=n.Phoenix||{},u=n.uuid,o=!!i.getDocument?i.getDocument():e(n.document);var r;var a=function(){if(r===undefined){r=e(t)}return r};var c;var f=function(){var n=a();c=u.v1();if(n.length>0){n.attr("content",c)}};var v=function(){var n=a();c=e.cookie("vguid");if(c&&c!=null){n.attr("content",c);e.cookie("vguid",null,{path:"/"})}else{c=n.attr("content");if(c===null){f()}if(!c){f()}}o.on("pre_page_event",function(){f()})};v();i.ViewGuid={get:function(){if(c===undefined){f()}return c}};n.Phoenix=i})(this);
(function(n){"use strict";var i="CampaignParams";var e=n.Phoenix||{};var t=["ftag","ttag","utm_source","utm_medium","utm_campaign","vndid"];var r=["ftag","vndid"];var a=function(n){var i,e,t,r,a,f;if(n.length>0&&n.indexOf("=")>0){e=n.split("&");for(f=0;f<e.length;f++){t=e[f];if(t.indexOf("=")>0){t=t.split("=");r=t[0];a=t[1];if(r&&a){if(!i){i={}}i[r]=a}}}}return i};var f=function(n,i){var e,t,r,a;if(n){for(a=0;a<i.length;a++){t=i[a];r=n[t];if(!!r){if(undefined===e){e={}}e[t]=r}}}if(undefined===e){e=null}return e};var u=function(n,i){var e;return function(){if(undefined===e){e=f(a(window.location[n].substring(1)),i)}return e}};e[i]={getParams:function(){var n;return function(){if(undefined===n){var i=this,e=i.getHashParams(),t=i.getQueryParams();if(t){n=$.extend({},t)}if(e){if(n){n=$.extend(n,e)}else{n=$.extend({},e)}}if(undefined===n){n=null}}return n}}(),getHashParams:u("hash",r),getQueryParams:u("search",t)};n.Phoenix=e})(this);
(function(n){"use strict";var e=n.Phoenix;if(!e){e=n.Phoenix=function(){}}var t=function(){var n;return function(){if(undefined===n){n=$(".ad-settings")}return n}}();e.hasAds=function(){var n;return function(){if(undefined===n){var e=t();n=e&&e.length>0}return n}}();e.hasPageEventAds=function(){var n;return function(){if(undefined===n){var r=t();var i=e.jQuery&&e.jQuery.getBody()||$("body");n=i.hasClass("has-page-events")||r&&r.length>1}return n}}()})(this);
(function(t){"use strict";t.fn.autocomplete=function(e){var i=e||{},s=t();if(typeof e==="string"){throw new Error("Please pass options as an object.")}return this.each(function(){if(t(this).data().autocompleter){return}var e=t(this).data();var a=t.extend({},t.fn.autocomplete.defaults,i,e);if(typeof a.enableForMedia==="string"&&window.matchMedia&&!window.matchMedia(a.enableForMedia).matches){return false}if(a.multiple===false){a.podLimit=1}s.add(new r(t(this),a))})};t.fn.autocomplete.defaults={loadingClass:"loading",resultsClass:"dropdown-menu typeahead typeahead-full",resultListId:"resultsWrap",selectClass:"selected",queryParamName:"q",extraParams:{},url:"/jsonsearch/",minChars:1,maxItemsToShow:10,delay:300,useCache:false,maxCacheLength:10,matchSubset:true,matchCase:false,matchInside:true,mustMatch:false,selectFirst:false,selectOnly:false,showResult:null,preventDefaultReturn:true,preventDefaultTab:false,filterResults:false,sortResults:false,sortFunction:null,matchStringConverter:null,autoWidth:"min-width",useDelimiter:false,delimiterChar:",",delimiterKeyCode:188,autoRedirect:false,placeholderGraphic:"/bundles/phoenixsite/images/core/loose/no-image-30x30.png",emptyText:"'tis but a barren wasteland",showEmptyText:true,podInputName:null,podInputNoIndex:false,searchIndex:null,searchField:null,searchFilter:null,resultPodTemplate:false,podLimit:5,inputRequired:null,showNotificationBar:false,parentModal:null,extraClasses:null,sortable:false,sortableOrderFieldName:null,multiple:true,notificationText:null,notificationClass:null,notificationBarSearch:false,notificationSearchUrl:null,afterShowResults:null,finishOnBlur:true,stopPositioning:false,bodyOnClickFilter:[],enableForMedia:null,searchIndexOnly:null,podClass:"resultPod"};var e={onActivate:null,onFetchRemoteData:null,onItemSelect:null,onNoMatch:null,onFinish:null,onRequestComplete:null,onError:null,onDisplayResults:null,onHideResults:null,onNotificationBarClick:null};t.extend(t.fn.autocomplete.defaults,e);var i=function(e){var i={},s=t.type(e);if(s==="string"){i.name=e.name;i.url=e.url;i.id=e.id}else if(s==="object"){i.name=e.name||e.title;i.type=e.index_name||e.bundle||e.type||e.label;i.id=e.native_id||e.id;i.contentTypeId=e.content_type_id;i.image=e.image_thumbnail_url;i.url=e.url;i.full_name=e.full_name;i.label=e.label;i.engineId=e.engineId;i.engineKey=e.engineKey;i.slug=e.slug}return i};var s=function(t,e,i){var s=parseInt(t,10);i=i||{};if(isNaN(s)||i.min&&s<i.min){s=e}return s};var a=function(t,e){return[t,encodeURIComponent(e)].join("=")};var n=function(e,i){var s=[];t.each(i,function(t,e){s.push(a(t,e))});if(s.length){e+=e.indexOf("?")===-1?"?":"&";e+=s.join("&")}return e};var o=function(t,e,i){t=String(t.id);e=String(e.id);if(!i){t=t.toLowerCase();e=e.toLowerCase()}if(t>e){return 1}if(t<e){return-1}return 0};var r=function(e,i){if(!e||!(e instanceof t)||e.length!==1||e.get(0).tagName.toUpperCase()!=="INPUT"){throw new Error("Invalid parameter for jquery.Autocompleter, jQuery object with one element with INPUT tag expected.")}var a=this;var n;this.options=i;this.cacheData_={};this.draggableOptions_={containment:"parent"};this.droppableOptions_={drop:function(e,i){var s=t(e.target);var a=i.draggable;var n=a.html();var o=s.html();var r=[];s.html(n);a.html(o);s.attr("style","position:relative");a.attr("style","position:relative");s.parent().find('input[type="hidden"]').each(function(e){var i=t(this);var s=i.attr("name");var a=s.match(/(.*\])\[\d+\]$/);if(!t.isArray(a)||a[1]===undefined){return}i.attr("name",a[1]+"["+e+"]")})}};this.canDoSortable_=!!(t.ui&&t.ui.draggable&&t.ui.droppable);this.cacheLength_=0;this.selectClass_=this.options.selectClass;this.lastKeyPressed_=null;this.lastProcessedValue_=null;this.lastSelectedValue_=null;this.active_=false;this.finishOnBlur_=this.options.finishOnBlur;this.paginationOffset_=0;this.pageNumber_=1;this.maxOffset_=0;this.extraParams_=t.extend({},this.options.extraParams)||{};this.podCount_=0;this.curJQXHR_=null;this.resultsShowing=false;this.resultsPaginating_=false;this.options.minChars=s(this.options.minChars,t.fn.autocomplete.defaults.minChars,{min:0});this.options.maxItemsToShow=s(this.options.maxItemsToShow,t.fn.autocomplete.defaults.maxItemsToShow,{min:0});this.options.maxCacheLength=s(this.options.maxCacheLength,t.fn.autocomplete.defaults.maxCacheLength,{min:1});this.options.delay=s(this.options.delay,t.fn.autocomplete.defaults.delay,{min:0});this.dom={};this.dom.$elem=e;this.dom.$parent=e.parent(".autocomplete");this.dom.$first=null;this.dom.$notificationBar=null;if(!this.options.autoRedirect&&this.dom.$parent){this.dom.$existingPods=this.dom.$parent.find(".resultPod");this.podCount_=this.dom.$existingPods.length}this.options.inputRequired=!!e.attr("required");if(this.options.extraClasses){this.options.resultsClass+=" "+t.trim(this.options.extraClasses)}this.options.podInputName=this.options.podInputName||this.dom.$elem.attr("name");this.dom.$elem.attr("autocomplete","off");this.dom.$results=t('<div class="'+this.options.resultsClass+'"></div>').hide();this.onResizeHandler=function(){if(!a.options.stopPositioning){var e=a.dom.$elem.outerWidth();if(e>0){a.dom.$results.css("width",e+"px")}a.position();var i=t(window).scrollTop()+t(window).height()-a.dom.$results.offset().top;a.dom.$results.css("max-height",i+"px")}};t(window).on("resize",this.onResizeHandler);this.dom.$resultList=t('<ul class="js-autocomplete-list" id="'+this.options.resultListId+'"></ul>');this.dom.$resultList.appendTo(this.dom.$results);this.dom.$container=this.options.parentModal?t(this.options.parentModal):Phoenix.jQuery.getBody();if(this.options.showNotificationBar){var o=t('<li class="notificationBar"><span id="notificationText">Searching for</span> <span id="notificationTerm"></span></li>');if(this.options.notificationClass){o.addClass(this.options.notificationClass)}this.dom.$first=o.prependTo(this.dom.$resultList);this.dom.$notificationTerm=this.dom.$results.find("#notificationTerm");this.dom.$notificationText=this.dom.$results.find("#notificationText");this.dom.$notificationBar=o;var r=this;if(this.options.notificationBarSearch){o.click(function(t){var e=r.dom.$elem.val();var i=r.makeUrl(e,r.options.notificationSearchUrl);window.location=i})}else if(this.options.onNotificationBarClick){o.click(function(t){r.options.onNotificationBarClick(t,r)})}}this.dom.$container.append(this.dom.$results);e.keydown(function(t,e){a.lastKeyPressed_=t.keyCode;switch(a.lastKeyPressed_){case a.options.delimiterKeyCode:if(a.options.useDelimiter&&a.active_){a.selectCurrent()}break;case 35:case 36:case 16:case 17:case 18:case 37:case 39:break;case 38:t.preventDefault();if(a.active_){a.focusPrev()}else{a.activate()}return false;case 40:t.preventDefault();if(a.active_){a.focusNext()}else{a.activate()}return false;case 9:if(a.active_){a.selectCurrent();if(a.options.preventDefaultTab){t.preventDefault();return false}}break;case 13:if(e===true){delete a.extraParams_["page"];a.pageNumber_=1;a.activateNow(true);t.preventDefault();return false}if(a.active_){a.selectCurrent();t.preventDefault();return false}if(a.options.preventDefaultReturn){t.preventDefault();return false}break;case 27:if(a.active_||e){t.preventDefault();a.deactivate(true);return false}break;default:a.activate()}}).click(function(){a.activateNow()});this.bodyClickEvent=null;this.onClickHandler=function(i){var s=false;var n=t(i.target);t.each(a.options.bodyOnClickFilter,function(e,i){s=n.is(i)||t(i).find(n).length!==0;if(s){return false}});if(s){return}if(i.target==e[0]||n.hasClass("next")||n.hasClass("prev")){i.preventDefault();return false}a.resultsPaginating_=false;a.deactivate()};this.dom.$body=t("body");this.checkRequiredAttribute=function(){if(this.options.inputRequired){if(this.podCount_>0){e.removeAttr("required")}else{e.attr("required","required")}}};if(this.dom.$parent.length>0){this.dom.$parent.on("click",".resultPod i, .resultPod svg",function(e){t(this).parent(".resultPod").remove();a.podCount_--;a.checkRequiredAttribute();if(a.options.podLimit===null||a.podCount_<a.options.podLimit){a.dom.$elem.removeClass("hide")}e.preventDefault();e.stopPropagation()})}if(this.options.podLimit!==null&&this.podCount_>=this.options.podLimit){this.dom.$elem.addClass("hide")}if(this.options.sortable&&this.canDoSortable_){n=this.dom.$parent.find(".resultPod");n.draggable(this.draggableOptions_);n.droppable(this.droppableOptions_);this.dom.$parent.droppable({drop:function(t,e){e.draggable.attr("style","position:relative;")}})}else{Phoenix.Core.debug("autocompleter: Wanted to make sortable but jQuery UI required libraries are not present.")}this.checkRequiredAttribute();t(window).on("scroll",function(t){a.checkScroll(t)});e.data("autocompleter",true);e.data("autocompleterObject",this);var l=this.dom.$parent.attr("data-seed-value");if(l){var h=l.split(":");var u={guid:h[0],name:l.substring(l.indexOf(":")+1)};this.addResultPodFromTemplate(u)}return this.dom.$results};var l=r.prototype;l.position=function(){if(!this.options.stopPositioning){var t=this.dom.$elem.offset();var e=t.top+this.dom.$elem.outerHeight();var i={top:e,left:t.left};this.dom.$results.css(i)}};l.checkScroll=function(t){if(this.resultsShowing){this.position()}};l.cacheRead=function(t){var e,i,s,a,n;if(this.options.useCache){t=String(t);e=t.length;if(this.options.matchSubset){i=1}else{i=e}while(i<=e){if(this.options.matchInside){a=e-i}else{a=0}n=0;while(n<=a){s=t.substr(0,i);if(this.cacheData_[s]!==undefined){return this.cacheData_[s]}n++}i++}}return false};l.cacheWrite=function(t,e){if(this.options.useCache){if(this.cacheLength_>=this.options.maxCacheLength){this.cacheFlush()}t=String(t);if(this.cacheData_[t]!==undefined){this.cacheLength_++}this.cacheData_[t]=e;return this.cacheData_[t]}return false};l.cacheFlush=function(){this.cacheData_={};this.cacheLength_=0};l.callHook=function(e,i){var s=this.options[e];if(s&&t.isFunction(s)){return s(i,this)}return false};l.activate=t.debounce(400,function(){var t=this;this.maxOffset_=0;t.activateNow()});l.activateNow=function(t){var e=null;if(this.options.onActivate){e=this.options.onActivate.call(this)}if(this.bodyClickEvent===null){this.bodyClickEvent=this.onClickHandler;this.dom.$body.on("click.autocomplete",this.bodyClickEvent)}this.checkSearchIndex();this.checkSearchField();this.abandonAJAX();var i=this.dom.$elem.val();if(e){i=e}if(i){if(t||i!==this.lastProcessedValue_&&i!==this.lastSelectedValue_){if(this.options.showNotificationBar){this.showNotificationBar(i)}this.fetchData(i)}else if(i===this.lastProcessedValue_){this.displayResults()}}else{this.deactivate(false)}};l.abandonAJAX=function(){if(this.curJQXHR_&&this.curJQXHR_.readyState!=4){this.curJQXHR_.abort();this.dom.$results.find(".loading").remove();return true}return false};l.fetchData=function(e){var i=this,s=function(t,e){i.showResults(i.filterResults(t,e),e)};this.lastProcessedValue_=e;if(e.length<this.options.minChars){return false}else if(this.options.data){s(this.options.data,e)}else{this.fetchRemoteData(e,function(a){if(t.isFunction(i.options.onRequestComplete)){i.options.onRequestComplete(a,e)}s(a,e)})}};l.fetchRemoteData=function(e,i){var s=this.cacheRead(e);var a=this;var n=this.dom.$results;var o;var r=this.dom.$resultList;this.curJQXHR_=null;if(s){i(s)}else{o=function(t){var s=false;n.find(".loading").remove();if(t!==false){s=a.parseRemoteData(t);a.cacheWrite(e,s);i(s)}};r.find("li:not(.notificationBar)").remove();n.find(".loading").remove();n.find("#resultsWrap").append(t('<li class="loading"/>'));if(t.isFunction(a.options.onFetchRemoteData)){a.options.onFetchRemoteData(this)}this.curJQXHR_=t.ajax({url:this.makeUrl(e),success:o,error:function(e,i,s){if(s==="abort"||this.readyState===0){return}if(t.isFunction(a.options.onError)){a.options.onError(e,i,s)}else{o(false)}},dataType:"json"})}};l.setExtraParam=function(e,i){var s=t.trim(String(e));if(s){if(!this.extraParams_){this.extraParams_={}}if(this.extraParams_[s]!==i){this.extraParams_[s]=i;this.cacheFlush()}}};l.checkSearchIndex=function(){var e=this.options.searchIndex;var i=[];var s=0;var a=this;var n=1;if(this.extraParams_["page"]!==undefined){n=parseInt(this.extraParams_["page"],10);if(isNaN(n)){this.pageNumber_=n=1;this.paginationOffset_=0}}var o=this.dom.$elem.val();if(o!==this.lastProcessedValue_&&o!==this.lastSelectedValue_){this.pageNumber_=n=1;this.paginationOffset_=0}this.extraParams_=t.extend({},this.options.extraParams);if(e){if(t.type(e)!=="array"){e=e.split(",")}t.each(e,function(t,e){a.setExtraParam("indices["+s+"]",e);s++});a.setExtraParam("page",n);if(this.options.searchIndexOnly){a.setExtraParam("indexOnly",this.options.searchIndexOnly)}}};l.checkSearchField=function(){var e=this.options.searchField;var i=[];var s=0;var a=this;if(e){if(t.type(e)!=="array"){e=e.split(",")}t.each(e,function(t,e){a.setExtraParam("fields["+s+"]",e);s++})}var n=this.options.searchFilter;if(n!=null){a.setExtraParam("filters",n)}};l.makeUrl=function(e,i){var s=this.options.url,a=t.extend({},this.extraParams_);if(typeof i!=="undefined"){s=i}if(this.options.queryParamName===false){s+=encodeURIComponent(e)}else{a[this.options.queryParamName]=e}return n(s,a)};l.parseRemoteData=function(e){var i,s=e;i=typeof e;switch(i){case"object":s=e;break;case"string":s=t.parseJSON(e);break;default:throw new Error("Unexpected remote data type: "+i)}return s};l.filterResult=function(t,e){if(!t.name){return false}if(this.options.filterResults){var i=this.matchStringConverter(e);var s=this.matchStringConverter(t.name);if(!this.options.matchCase){i=i.toLowerCase();s=s.toLowerCase()}var a=s.indexOf(i);if(this.options.matchInside){return a>-1}else{return a===0}}return true};l.filterResults=function(e,s){var a=[];var n=this;var o;if(e.results){t.each(e.results,function(t,e){o=i(e);if(n.filterResult(o,s)){a.push(o)}if(n.options.sortResults){a=n.sortResults(a,s)}});this.calculateMaxOffset(e)}return a};l.calculateMaxOffset=function(t){var e=this.options.maxItemsToShow;this.maxOffset_=Math.floor(t.count/e)*e;if(t.count%e===0){this.maxOffset_-=e}};l.sortResults=function(e,i){var s=this;var a=this.options.sortFunction;if(!t.isFunction(a)){a=function(t,e){return o(t,e,s.options.matchCase)}}e.sort(function(t,e){return a(t,e,i,s.options)});return e};l.matchStringConverter=function(e,i,s){var a=this.options.matchStringConverter;if(t.isFunction(a)){e=a(e,i,s)}return e};l.enableFinishOnBlur=function(){this.finishOnBlur_=true};l.disableFinishOnBlur=function(){this.finishOnBlur_=false};l.showNotificationBar=function(t){t=t||this.getValue();if(t.length>=this.options.minChars){this.dom.$notificationTerm.text(t);if(this.options.notificationText){this.dom.$notificationText.text(this.options.notificationText)}else{this.dom.$notificationText.text("Search for")}this.position();this.displayResults();this.focusItem(this.dom.$first)}};l.createItemFromResult=function(e){var i=this,s=t("<li/>").append(t(this.showResult(e)));if(!this.options.autoRedirect){s.click(function(){if(s.find(".noResults").length>0){return}i.selectItem(s)})}s.data(e||{}).mousedown(i.disableFinishOnBlur).mouseup(i.enableFinishOnBlur);return s};l.showResult=function(e){var i,s="",a="",n="resultWrap",o,r;if(t.isFunction(this.options.showResult)){return this.options.showResult(e)}else if(!e&&this.options.showEmptyText){return'<div class="noResults">'+this.options.emptyText+"</div>"}else{i=e.image||this.options.placeholderGraphic;if(!!e.label){s="<span>"+e.label+"</span>"}else if(!!e.type){s="<span>"+e.type+"<span>"}if(this.options.textOnly){n+=" resultTextOnly"}else{a='<img src="'+i+'">'}r=e.name;if(this.dom.$elem.data("display-field")&&e[this.dom.$elem.data("display-field")]){r=e[this.dom.$elem.data("display-field")];e.name=r}if(this.options.autoRedirect){o='<a href="'+e.url+'" class="'+n+'" data-type="'+e.type.toLowerCase()+'" data-id="'+e.id+'" data-key="'+e.engineKey+'">'+a+"<h5>"+r+"</h5>"+s+"</a>"}else{o='<div class="'+n+'">'+a+"<h5>"+r+"</h5>"+s+"</div>"}return o}};l.getItems=function(){return this.dom.$resultList.find(">li")};l.showResults=function(e){if(!e){e=[]}var i=e.length,s=this,a=t("<ul/>"),n,o,r,l,h=this.dom.$results,u=this.dom.$resultList;if(i>0){if(this.pageNumber_>1){a.append(this.addPagination("prev"))}for(n=0;n<i;n++){o=e[n];r=this.createItemFromResult(o);a.append(r);if(!this.dom.$first){this.dom.$first=r}if(n===i-1){r.addClass(this.options.lastItemClass)}}if(this.paginationOffset_<this.maxOffset_){a.append(this.addPagination("next"))}}else{a.append(this.createItemFromResult(o))}u.find("li:not(.notificationBar)").remove();u.append(a.find("li"));if(this.options.afterShowResults){this.options.afterShowResults(e,u,this)}this.displayResults();this.position();if(this.options.autoWidth){l=this.dom.$elem.outerWidth()-h.outerWidth()+h.width();h.css(this.options.autoWidth,l)}this.getItems().hover(function(){s.focusItem(this)},function(){});if(this.options.selectFirst||this.options.selectOnly&&i===1){this.focusItem(this.dom.$first)}this.active_=true};l.addPagination=function(e){var i=e==="next"?t('<li class="next">See more results</li>').data("paginate",e):t('<li class="prev">See previous results</li>').data("paginate",e);if(!i.data("clickEventAdded")){this.addPaginationEvent(i,e)}return i};l.paginate=function(t){var e=this.dom.$results.find("li.loading").length>0;if(e){this.resultsPaginating_=true;return}if(this.pageNumber_<=1&&t==="prev"){this.resultsPaginating_=false;return}else if(this.paginationOffset_>=this.maxOffset_&&t=="next"){this.resultsPaginating_=false;return}var i=Number(this.options.maxItemsToShow);if(t==="next"){this.paginationOffset_+=i;this.pageNumber_++}else if(t==="prev"){this.paginationOffset_-=i;this.pageNumber_--}this.resultsPaginating_=true;this.setExtraParam("page",this.pageNumber_);this.activateNow(true)};l.addPaginationEvent=function(t,e){var i=this;t.click(function(){i.paginate(e)}).data("clickEventAdded",true)};l.focusNext=function(){this.focusMove(+1)};l.focusPrev=function(){this.focusMove(-1)};l.focusMove=function(e){var i=this.getItems(),a;e=s(e,0);if(e){for(a=0;a<i.length;a++){if(t(i[a]).hasClass(this.selectClass_)){this.focusItem(a+e);return}}}this.focusItem(0)};l.focusItem=function(e){var i,s=this.getItems();if(s.length){s.removeClass(this.selectClass_);if(typeof e==="number"){if(e<0){e=0;this.paginate("prev")}else if(e>=s.length){e=s.length-1;this.paginate("next")}i=t(s[e])}else{i=t(e)}if(i){i.addClass(this.selectClass_)}}};l.selectCurrent=function(){var e=t("li."+this.selectClass_,this.dom.$results);if(e&&e.length===1){if(this.dom.$notificationBar instanceof jQuery&&e.get(0)===this.dom.$notificationBar.get(0)){if(this.options.notificationBarSearch){var i=this.dom.$elem.val();var s=this.makeUrl(i,this.options.notificationSearchUrl);window.location=s}else if(this.options.onNotificationBarClick){this.options.onNotificationBarClick(event,this)}}else{this.selectItem(e)}}else{this.deactivate(false)}};l.selectItem=function(e){if(this.options.onItemSelect){var i=this.callHook("onItemSelect",e.data());if(!i){this.dom.$elem.focus();this.deactivate(true);this.hideResults();return}}var s=this.getValue(),a=e.data("paginate");this.lastProcessedValue_=s;this.lastSelectedValue_=s;if(a){this.paginate(a)}else if(this.options.autoRedirect){if(e.get(0)===t(this.dom.$first).get(0)){this.dom.$elem.closest("form").submit()}else{window.location.href=e.data("url")}}else if(this.options.podLimit===null||this.podCount_<this.options.podLimit){this.addResultPodFromTemplate(e.data())}else{Phoenix.Ui.showErrorMessage("You've exceeded the limit.");this.setValue("")}this.deactivate(true);this.hideResults()};l.addResultPodFromTemplate=function(t){var e=this.buildResultPod(t),i=this.dom.$elem;e.insertBefore(i);this.podCount_++;this.checkRequiredAttribute();this.setValue("");i.focus();if(this.options.podLimit!==null&&this.podCount_===this.options.podLimit){i.addClass("hide")}return e};l.buildResultPod=function(e){if(t.isFunction(this.options.resultPodTemplate)){return this.options.resultPodTemplate.call(this,e)}else{var i=this.dom.$parent.find('input[type="hidden"]').length;var s,a=this.options.podInputName+(this.options.podInputNoIndex||/\[\]$/.test(this.options.podInputName)?"":"["+i+"]"),n=this;if(typeof e.guid!="undefined"){s=e.guid}else{s=e.contentTypeId+"-"+e.id}if(a){var o=t('<span class="resultPod"><span>'+(e.name||e.title)+'</span><svg class="symbol symbol-remove"><use xlink:href="#symbol-remove"></use></svg><input type="hidden" name="'+a+'" value="'+s+'"></span>');if(this.options.sortable&&this.canDoSortable_){o.draggable(this.draggableOptions_);o.droppable(this.droppableOptions_)}return o}else{throw new Error("Missing required option: podInputName.")}}};l.hideResults=function(){this.dom.$results.hide();this.resultsShowing=false;if(this.options.onHideResults){this.options.onHideResults(this.dom.$results)}};l.displayResults=function(){this.dom.$results.show();this.dom.$results.addClass("visible");this.resultsShowing=true;if(this.options.onDisplayResults){this.options.onDisplayResults(this.dom.$results)}this.onResizeHandler()};l.deactivate=function(t){if(this.abandonAJAX()){t=true}if(this.bodyClickEvent!==null){this.dom.$body.off("click.autocomplete",this.bodyClickEvent);this.bodyClickEvent=null}if(this.resultsPaginating_){return}if(t){if(this.lastProcessedValue_!==this.lastSelectedValue_){if(this.options.mustMatch){this.setValue("")}this.callHook("onNoMatch")}if(this.active_){this.callHook("onFinish")}this.lastKeyPressed_=null;this.lastProcessedValue_=null;this.lastSelectedValue_=null;this.active_=false;this.pageNumber_=1;this.paginationOffset_=0}this.hideResults()};l.getCaret=function(){var e=this.dom.$elem,i,s,a;if(t.browser.msie){var n=document.selection;if(e[0].tagName.toLowerCase()!=="textarea"){var o=e.val();i=n.createRange().duplicate();i.moveEnd("character",o.length);s=i.text===""?o.length:o.lastIndexOf(i.text);i=n.createRange().duplicate();i.moveStart("character",-o.length);a=i.text.length}else{i=n.createRange();var r=i.duplicate();r.moveToElementText(e[0]);r.setEndPoint("EndToEnd",i);s=r.text.length-i.text.length;a=s+i.text.length}}else{s=e[0].selectionStart;a=e[0].selectionEnd}return{start:s,end:a}};l.setValue=function(t){if(this.options.useDelimiter){var e=this.dom.$elem.val();var i=this.getDelimiterOffsets();var s=e.substring(0,i.start);var a=e.substring(i.end);t=s+t+a}this.dom.$elem.val(t)};l.getValue=function(){var t=this.dom.$elem.val();if(this.options.useDelimiter){var e=this.getDelimiterOffsets();return t.substring(e.start,e.end).trim()}else{return t}};l.getDelimiterOffsets=function(){var t=this.dom.$elem.val(),e,i;if(this.options.useDelimiter){var s=t.substring(0,this.getCaret().start);e=s.lastIndexOf(this.options.delimiterChar)+1;var a=t.substring(this.getCaret().start);i=a.indexOf(this.options.delimiterChar);if(i===-1){i=t.length}i+=this.getCaret().start}else{e=0;i=t.length}return{start:e,end:i}};l.getValueForReal=function(){var e=this.dom.$parent.find('input[type="hidden"]');if(!e.length){return null}else if(e.length==1){return t(e[0]).val()}else{var i=[];e.each(function(e){i.push(t(e).val())});return i}};l.setValueForReal=function(e,i){if(typeof i=="undefined"){i=false}if(!t.isArray(e)){e=[e]}if(!i){this.dom.$elem.empty()}var s=this;t.each(e,function(t){s.addResultPodFromTemplate(t)})};t(document).ready(function(){var e=t(".autoCompleteSSContainer");t(".autoCompleteSSCommit").click(function(){e.find(".js-ac-needs-hacks").each(function(e,i){var s=t(i);var a=s.find(".js-ac-needs-hacks-name");var n=a.data().autocompleterObject;var o=n.getValueForReal();if(o){a.removeAttr("name")}})})})})(jQuery);
$(document).ready(function(){"use strict";var t=function(){$(".js-autocompleter-checkbox-span").each(function(){var t=$(this);if(t.data("initialized")){return}var e=t.parent().find(".js-autocompleter-checkbox").find("input").first();t.on("click",function(c){if(e.attr("checked")==="checked"){e.removeAttr("checked");t.text("Click to match all above")}else{e.attr("checked","checked");t.text("Click to match individually above")}c.preventDefault()});t.data("initialized",true)})};t();$(document).ajaxStop(function(){t()})});
Phoenix.SiteSearch=null;$(function(){"use strict";window.Swiftype=window.Swiftype||{};Swiftype.root_url=Swiftype.root_url||"https://api.swiftype.com";Swiftype.pingUrl=function(e,t){var i=setTimeout(t,350);var n=new Image;n.onload=n.onerror=function(){clearTimeout(i);t()};n.src=e;return false};Swiftype.pingAutoSelection=function(e,t,i,n,r){var a={t:(new Date).getTime(),engine_key:e,document_type_id:t,doc_id:i,prefix:n};var c=Swiftype.root_url+"/api/v1/public/analytics/pas?"+$.param(a);Swiftype.pingUrl(c,r)};Phoenix.SiteSearch=function(){var e=$("#siteSearch");var t=false;var i=false;if(!e.length){return}var n=$("#search-toggle");n.find("a").first().click(function(e){e.preventDefault()});$(e).find("input").focusin(function(){$(e).addClass("is-focused");$("body").addClass("has-search-focused")});$(e).find("input").focusout(function(){$(e).removeClass("is-focused");$("body").removeClass("has-search-focused")});e.on("keydown",function(e){if(e.which==224||e.which==17||e.which==91||e.which==93){i=e.which}}).on("keyup",function(e){if(e.which==i){i=false}});e.on("click","li a",function(t){if(i!=false){return}t.preventDefault();var n=$(e).find('input[type="text"]').val();var r=$(this).data("type");var a=$(this).data("id");var c=$(this).data("key");var o=$(this).attr("href");if(c&&r&&a&&n){Swiftype.pingAutoSelection(c,r,a,n,function(){window.location=o})}else{return true}return false});var r=e.find('input[type="checkbox"]'),a=e.find('.search-group-wiki input[type="checkbox"]'),c=e.find(".checkall"),o=e.find(".uncheck"),s=e.find(".wikionly"),l=[],f=function(){l.length=0;r.filter(":checked").each(function(){l.push($(this).val())})};var u=e.find("#search-main");var h={};if(e.find('[name="from_cms"]').length!==0){h["cms"]=1}var p=function(){var e;if(u.val().length){e=$.Event("keydown");e.keyCode=27;u.trigger(e);e=$.Event("keydown");e.keyCode=13;u.trigger(e,true)}};c.click(function(e){e.preventDefault();r.prop("checked",true);f();p()});o.click(function(e){e.preventDefault();r.prop("checked",false);f();p()});s.click(function(e){e.preventDefault();r.prop("checked",false);a.prop("checked",true);f();p()});r.click(function(){var e=$(this).prop("checked");if(!t&&e){r.not(this).prop("checked",false)}t=true;f();p()});f();var d={};r.each(function(){var e=$(this).parent();var t=$.trim(e.text());d[t]=$(this).val()});var v=function(e){var t=e.split(" ");if(t.length<=0){return null}var i=[];var n=[];var r=0;for(r=0;r<t.length;r=r+1){var a=t[r];a=$.trim(a);if(a===""){continue}var c=a.charAt(a.length-1);if(c!==":"){break}a=a.slice(0,-1);a=$.trim(a);if(a===""){continue}if(a==="person"||a==="persons"){a="people"}var o=d[a]||d[a+"s"]||d[a.substr(0,a.length-1)];if(o){i.push(o);n.push(a)}else{break}}if(i.length<=0){return null}var s=t.slice(r).join(" ");return{newIndicies:i,searchText:s,terms:n}};return u.autocomplete({autoRedirect:true,searchIndex:l,selectFirst:true,showNotificationBar:true,notificationBarSearch:true,notificationSearchUrl:"/search/",extraParams:h,parentModal:e,autoWidth:null,enableForMedia:"(min-width: 321px)",onActivate:function(){var e=this.dom.$elem.val();var t=v(e);if(!t){this.options.notificationText=null;f();return}if(t.terms.length===1){this.options.notificationText="Searching "+t.terms[0]+" for"}else{this.options.notificationText=null}l.length=0;$.extend(l,t.newIndicies);return t.searchText},preventDefaultReturn:false,finishOnBlur:false,bodyOnClickFilter:e})}()});$(function(){"use strict";var e="/bundles/phoenixsite/images/core/loose/no-image.jpg";var t=$("#default-content .search-filters");var i=false;var n,r,a;var c;var o=$("#default-content .primary-content .search-results");var s=false;var l=$();if(t.length===0){return}n=t.find(":checkbox");r=t.find(".search-group-toggle");a=t.find(".search-group-wiki :checkbox");a=t.find(".search-group-wiki :checkbox");c=function(t,i){var r={page:1,q:Phoenix.Request.get("q","string"),srp:true};var a=0;var c;if(s){return}if(i){r=$.extend({},r,i)}if(t){r["client"]=t}if(Phoenix.Request.get("indexOnly")){r["searchIndexOnly"]=Phoenix.Request.get("indexOnly","boolean")}o.addClass("loading");n.each(function(){var e=$(this);if(e.prop("checked")===true){r["indices["+a+"]"]=e.val();a=a+1}e.prop("disabled",true)});c=o.children("li").clone(true);o.children("li").remove();AjaxApiRequest.makeGetApiRequest("/jsonsearch/",r,function(t){var i=$(t["pagination"]);var a=_.template($("#resultTemplate").html());$.each(t["results"],function(t,i){if(!i["image_url"]){i["image_url"]=e}if(i["deck"]){i["deck"]=i["deck"].replace(/(<([^>]+)>)/gi,"")}else{i["deck"]=""}o.append(a(i))});if($(i[0]).hasClass("paginate")){var c=o.siblings(".paginate");if(c.length===0){i.insertAfter(o)}else{c.replaceWith(i)}i.find("a").each(function(){var e=$(this);var t=parseInt($(this).text(),10);var i="/search/?q="+r["q"]+"&page=";var n=0;var a=e.parent();if(a.hasClass("results")){return}if(isNaN(t)){if(a.hasClass("next")){t=r["page"]+1}else if(a.hasClass("prev")){t=r["page"]-1}else{t=1}}i+=t;$.each(r,function(e,t){if(e.substr(0,8)==="indices["){i+="&"+encodeURIComponent("indices["+n+"]")+"="+encodeURIComponent(t);n=n+1}else if(e=="sort"&&r[t]){i+="&"+encodeURIComponent(e)+"="+encodeURIComponent(t)+"&"+encodeURIComponent(t)+"="+encodeURIComponent(r[t])}});e.attr("href",i)})}else{var c=o.siblings(".paginate");c.replaceWith("")}s=false;n.prop("disabled",false);o.removeClass("loading")},function(){s=false;n.prop("disabled",false);o.append(c);o.removeClass("loading");n.prop("checked",false);l.prop("checked",true);Phoenix.Ui.showErrorMessage("Error occurred while loading results, showing previous results")})};t.on("click",":checkbox",function(){var e=$(this).prop("checked");$(this).parent().toggleClass("s-active");l=n.filter(":checked").not(this);if(!i&&e){n.not(this).prop("checked",false)}jQuery.param.querystring(window.location.href,"q="+Phoenix.Request.get("q","string")+"&page=1");i=true;c("search")});r.on("click",".checkall",function(e){n.prop("checked",true);c("search");e.preventDefault();return false});r.on("click",".uncheck",function(e){n.prop("checked",false);c("search");e.preventDefault();return false});r.on("click",".wikionly",function(e){n.prop("checked",false);a.prop("checked",true);c("search");e.preventDefault();return false});$("select.ajax-js-filter").on("change",function(e){e.preventDefault();var t=$(this);var i={};if(t.val()&&t.val().length){i["sort"]=t.attr("data-filter-query");i[t.attr("data-filter-query")]=t.val()}c("search",i);return false})});
(function(a,t){"use strict";var n=function(a,n){var i=t(a.target),r=a.data.callback,e;i.data("invalid",null);i.trigger("preSend");e=i.data("invalid");if(e){a.preventDefault();a.stopPropagation()}else{if(r!==undefined){r.call(this,a,n)}}};var i="data-ajaxForm";t.ajaxFormOn=function(a,i){t(document).on("submit",a,{callback:i},n)};t.fn.ajaxForm=function(a,i){if(i==null){i=a;a=undefined}return this.each(function(){var r=t(this);r.attr("data-ajaxForm","true").on("submit",a,{element:this,callback:i},function(a,t){n.call(this,a,t)})})};t.fn.isAjaxForm=function(){return t(this).attr(i)==="true"}})(this,jQuery);
var FuzzyDate=function(){"use strict";return this};FuzzyDate.prototype.selectors=[".fuzzy-datetime",".wiki-datetime"];FuzzyDate.prototype.initAll=function(){"use strict";$(this.selectors.join(",")).each(function(){var e=$(this);var t=e.find('input[type="hidden"]');var a;if(t.length){a=parseInt(t.val(),10);if(isNaN(a)){a=0}}e.wikiDatePicker(a)});return this};Phoenix.jQuery.getDocument().ready(function(){"use strict";var e=(new FuzzyDate).initAll();$(this).ajaxComplete(e.initAll.bind(e))});(function(e){"use strict";e.fn.wikiDatePicker=function(t){return this.each(function(){var a=e(this);if(a.data("fuzzy-date")){return}var i=a.find("input.datepicker-input");var r=a.find("select");var n=a.find('input[type="hidden"]');var s=a.find("a.swap");var f=a;var l=i.length!==0;var o=r.length===3;var v=n.length>=1;var d=s.length===1&&s.children("span").length===2;var p;var u;var c;var h=0;var g=1;var k=2;var y=3;var z=t===undefined?h:t;if(!z){z=h}var D=function(e){if(e===undefined){e=new Date(i.val())}var t=e.getMonth()+1;var a=Math.floor((t-1+3)/3);var r=e.getFullYear();if(z===h||z===g){p.find("option").prop("selected",false);p.find('option[value="'+t+'"]').prop("selected",true)}if(z===k){c.find("option").prop("selected",false);c.find('option[value="'+a+'"]').prop("selected",true)}u.find("option").prop("selected",false);u.find('option[value="'+r+'"]').prop("selected",true)};var I=function(){var t=parseInt(n.val(),10);var a=[];if(t===h&&(!i.data().datepicker.date||!i.val())){r.each(function(){var t=e(this);t.find("option").prop("selected",false);t.find("option:first").prop("selected",true)})}else{r.each(function(){var t=parseInt(e(this).val(),10);if(t){a.push(t)}});if(!a.length){i.val("").prop("value","").attr("value","")}}};var m=function(){var e=!!parseInt(p.val(),10);var t=!!parseInt(c.val(),10);var a=!!parseInt(u.val(),10);if(!e&&!t&&a){z=y;n.val(y)}};var w=function(t){return function(){var a=parseInt(e(this).val(),10);var r=i.data().datepicker.date;var s="set"+t;if(!a){I();m();return}if(s!=="setFullYear"){a-=1}if(s==="setFullYear"){m()}if(s==="setMonth"){z=g;n.val(z);F()}r[s](a);r.setDate(1);i.datepicker("setValue",r);I()}};var F=function(){c.find("option").prop("selected",false);c.find("option:first").prop("selected",true)};var $=function(){p.find("option").prop("selected",false);p.find("option:first").prop("selected",true);var e=i.data().datepicker.date;e.setDate(1);i.datepicker("setValue",e)};if(isNaN(t)||t>y){z=h;n.val(h)}if(!(l&&o&&v&&d)){return}if(typeof i.data().datepicker==="undefined"){i.datepicker()}r.each(function(){var t=this.getAttribute("name");var a=e(this);if(/\]\[month\]$/.test(t)){p=a;a.on("change",w("Month"))}else if(/\]\[year\]$/.test(t)){u=a;a.on("change",w("FullYear"))}});r.filter(function(){var t=/\]\[quarter\]$/.test(this.getAttribute("name"));if(t){c=e(this)}return t}).on("change",function(){var t=parseInt(e(this).val(),10);var a=i.data().datepicker.date;var r={1:1,2:4,3:7,4:10};if(!t){m();I();return}a.setDate(1);a.setMonth(r[t]-1);i.datepicker("setValue",a);$();I();z=k;n.val(z)});if(i.val()){D()}i.on("changeDate",function(e){D(e.date)});a.on("click","a.swap",function(t){var a=e(this);var s=parseInt(n.val(),10);var l;if(isNaN(s)){s=h}if(s===h){l=g}else{l=h}n.val(l);a.children("span").toggleClass("hide");f.find("div").filter(function(){var t=e(this);var a=!!String(t.attr("id")).match(/_release_date$/);return t.hasClass("release-date-picker")||a}).toggleAttr("data-hide");if(!i.data().datepicker.date||!i.val()){r.each(function(){var t=e(this);t.find("option").prop("selected",false);t.find("option:first").prop("selected",true)})}if(l!==h&&parseInt(c.val(),10)){z=k;$();n.val(k)}if(l!==h&&!parseInt(c.val(),10)&&!parseInt(p.val(),10)){z=y;$();F();n.val(y)}t.preventDefault();return false});z=parseInt(z,10);if(z!==h&&!!p.parent().attr("data-hide")){s.trigger("click")}if(z===k){$();n.val(k)}if(z===g){F();n.val(g)}if(z===y){$();F();n.val(y)}a.find(".datetime-now-button").remove();a.data("fuzzy-date",true)})}})(window["jQuery"]);
var scrollToHeader=function(e){"use strict";var a=e.offset().top;$("html, body").animate({scrollTop:a-100},1e3)};$(document).ready(function(){"use strict";var e=$(".js-toc-generate");if(e.length===0){var a=$(document).find(".js-toc-container");a.parent().find(".toc").remove();a.remove();return}var n={"&":"&amp;","<":"&lt;",">":"&gt;"};function t(e){return n[e]||e}function i(e){return e.replace(/[&<>]/g,t)}e.each(function(e){var a=$(this);var n=e;var t=a.find(".js-toc-container");var l=a.find(".js-toc-content");if(l.length===0){t.parent().find(".toc").remove();t.remove();return}var o=l.find("h2, h3, h4");var r=$('<ul class="sub-nav-toc"></ul>');var s=[];var f=r;var c=false;var p=false;o.each(function(e){var a=$(this);var t=$('<a href="#toc-'+n+"-"+e+'">'+i(a.text())+"</a>");var l=$("<li></li>");var o=null;var r=null;t.appendTo(l);t.click(function(t){t.preventDefault();scrollToHeader(a);location.hash="toc-"+n+"-"+e});a.attr("name","toc-"+n+"-"+e);if(a.is("h2")){if(c){o=s.pop();r=o.find("li:last");if(r.length>0){f.appendTo(r)}else{f.appendTo(o)}f=o;c=false}if(p){o=s.pop();r=o.find("li:last");if(r.length>0){f.appendTo(r)}else{f.appendTo(o)}f=o;p=false}}else if(a.is("h3")){if(c){o=s.pop();r=o.find("li:last");if(r.length>0){f.appendTo(r)}else{f.appendTo(o)}f=o;c=false}if(!p){s.push(f);f=$("<ul></ul>");p=true}}else if(a.is("h4")){if(!c){s.push(f);f=$("<ul></ul>");c=true}}l.appendTo(f)});var d=null;while((d=s.pop())!==undefined){if(c){var u=d.find("li:last");if(u.length>0){f.appendTo(u)}else{f.appendTo(d)}c=false}else if(p){var u=d.find("li:last");if(u.length>0){f.appendTo(u)}else{f.appendTo(d)}p=false}else{f.appendTo(d);f=d}}if(r.html()===""){t.parent().find(".toc").remove();t.remove()}if(r.is("ul")){r.children().appendTo(t)}else{r.appendTo(t)}})});$(document).ready(function(){"use strict";$(".js-toc-static-links").click(function(e){e.preventDefault();var a=$(this).attr("href");a=a.slice(1);var n=$('[name="'+a+'"]');scrollToHeader(n);location.hash=a})});$(window).load(function(){"use strict";var e=location.hash.slice(1);if(e.indexOf("toc-")>=0){var a=$("h2, h3, h4").filter("[name="+e+"]");scrollToHeader(a)}});
(function(e,r){"use strict";var a=r(e.document);var t="Woops! Something happened and we are working on it!";var s="forum-add-ajax";var i="forum-new-comment-ajax";var n="forum-edit-ajax";var o="forum-reply-ajax";var l="."+s;var f="."+i;var u="."+n;var d="."+o;var c="textarea.js-editor-textarea";var v="messageElement";var m="messageBodyElement";var h="messageUserElement";var g="<div class='loading'></div>";var p="<div class='alert alert-error'><div>";var j=function(){return r.fn.richTextEditor!==undefined};var w=function(){return r.fn.ajaxForm!==undefined};e.initCollectionBlock=function(e){var a;var x=function(){return e};var y=function(){if(a===undefined){a=e.find(".js-reply");if(a.length===0){a=r(".js-reply")}}return a};var P=function(e){if(e===undefined){e=y()}return e.find(c)};var C=function(e){var r=e.data(v);if(r===undefined){r=e.closest(".js-message").first();e.data(v,r)}return r};var b=function(e){var r=e.data(m);if(r===undefined){r=C(e).find(".js-message-body").first();var a=r.find(".message");if(a.length){r=a}e.data(m,r)}return r};var E=function(e){var r=e.data(h);if(r===undefined){var a=C(e);r=null;if(a.length===0){r=C(e).find(".js-avatar-user").first()}else{r=C(e).find(".message-user").first()}e.data(h,r)}return r};var T=function(){if(!w()){return}e.ajaxForm([l,u,d,f].join(","),function(a){a.preventDefault();var l=r(a.target),f=l.serializeArray(),u=r(g),d,c;if(!l.hasClass(i)){l.hide()}u.insertAfter(l);r.ajax({type:"POST",url:l.attr("action"),data:f,success:function(a){if(a.success===0){var f=a.errMessage?a.errMessage:t;Phoenix.Ui.showErrorMessage(f);l.after(r(p).text(f));l.hide();u.remove();return}c=P(l);if(l.hasClass(o)){c=P(l);if(j()&&c.length>0){c.richTextEditor("remove")}l.closest(".js-message").replaceWith(a.html);l.remove();u.remove();Phoenix.Ui.showSuccessMessage("Reply added.")}else if(l.hasClass(s)){c=P(l);if(j()&&c.length>0){c.richTextEditor("remove")}l.remove();u.remove();var v=x().find(".js-forum-messages");r(a.html).hide().appendTo(v).slideDown();D();Phoenix.Ui.showSuccessMessage("Message added.")}else if(l.hasClass(i)){if(j()&&c.length>0){c.richTextEditor("clear")}u.remove();var v=e.find(".js-forum-comments");if(v.data("sort")==="DESC"){r(a.html).hide().prependTo(v).slideDown()}else{r(a.html).hide().appendTo(v).slideDown()}Phoenix.Ui.showSuccessMessage("Comment added.")}else if(l.hasClass(n)){d=b(l);if(j()&&c.length>0){c.richTextEditor("remove")}l.parents(".js-message").find(".js-forum-edit").removeClass("hide");l.remove();u.remove();d.html(a.html);Phoenix.Ui.showSuccessMessage("Message modified.")}else{Phoenix.Ui.showSuccessMessage("Saved.")}},error:function(){Phoenix.Ui.showErrorMessage(t);l.parents(".js-message").find(".js-forum-edit").removeClass("hide");u.remove();l.show()},complete:function(){r(document).trigger("image-viewer-rescrape")}})})};var k=function(){e.on("click",".js-forum-comments .js-forum-edit, .js-forum-messages .js-forum-edit",function(e){var a=r(e.target),s=a.attr("href");var i=r(this);if(a.is("a")===true&&s!==""){e.preventDefault();var n=b(a);i.addClass("hide");r.ajax({url:a.attr("href"),success:function(e){var r;n.html(e.html);r=P(n);if(r.length===1){if(j()){r.richTextEditor();r.richTextEditor("focus")}}},error:function(){Phoenix.Ui.showErrorMessage(t)},complete:function(){r(document).trigger("image-viewer-rescrape")}})}})};var M=function(a){var s=x();if(!s.hasClass("js-ajax-pagination")){return}if(!window.history.pushState){return}var i=location.href;var n=false;var o=false;s.on("click",'.paginate a[href*="page="]',function(e){if(!n){window.history.replaceState({name:"ForumPaginate",url:i},"",i);n=true}e.preventDefault();var a=r(this);var t=a.attr("href");l(t);window.history.pushState({name:"ForumPaginate",url:t},"",t);o=true});var l=function(i){var n=r(g);var o=e.find(".container").offset().top;var l=r(window);n.height(s.height());s.hide();s.after(n);if(l.scrollTop()>o){r("html, body").animate({scrollTop:o},300)}r.ajax({cache:false,url:i,success:function(r){var t=e.find(".paginate");if(!r.success){window.location=i;return}else{var o=Phoenix.getDocument();o.trigger("pre_page_event",["pageLoad"]);o.trigger("update_page_event",["pageLoad"]);o.trigger("on_page_event",["pageLoad"])}s.html(r.html.list);t.html(r.html.pagination);n.remove();s.show();if(a){a()}},error:function(){n.remove();s.show();Phoenix.Ui.showErrorMessage(t)},complete:function(){r(document).trigger("image-viewer-rescrape")}})};r(window).on("popstate","",function(e){if(!o){return}var r=e.originalEvent.state;if(r&&r.name==="ForumPaginate"){l(r.url)}})};var S=function(){var a=e.find(".js-poll-form");a.ajaxForm(function(e){e.preventDefault();var a=r(e.target);var s=a.serializeArray();r.ajax({type:"POST",url:a.attr("action"),data:s,success:function(e){a.parents(".js-message-body").html(e.html)},error:function(){Phoenix.Ui.showErrorMessage(t)}})})};var D=function(){e.find(".js-forum-reply, .js-forum-quote").remove()};var U=function(){x().on("click",".js-forum-reply-inline, .js-forum-quote-inline",function(e){var a=r(e.target),t=E(a),i=r(g),n={},l,f={};e.preventDefault();var u=r('<div class="message js-message"></div>');a.closest(".js-message").children(".message-wrap").after(u);u.append(i);AjaxApiRequest.makeGetApiRequest("/forums/comment/new/"+a.data("topic-id")+"/",{},function(e){i.remove();u.html(e.html);if(t.length===1){n.slug=t.data("user-slug");n.profile=t.data("user-profile")}var r=u.find("form").removeClass(s).addClass(o);var d=P(r);r.find("#forum_message_"+a.data("topic-id")+"_replyTo").val(a.data("reply-id"));if(a.hasClass("js-forum-quote-inline")&&j()){l=b(a);f.user=n;f.html=l.html();d.richTextEditor("quote",f)}else{if(j()===false){d.val("@"+n.slug+": "+d.val())}else{d.richTextEditor();d.richTextEditor("reply",n)}}})});x().on("click",".js-forum-reply, .js-forum-quote",function(e){var a=r(e.target),t=E(a),s=P(),i={},n,o={};e.preventDefault();var l=s.parents(".editor").first().offset().top;r("html, body").animate({scrollTop:l-100},500);if(t.length===1){i.slug=t.data("user-slug");i.profile=t.data("user-profile")}if(a.hasClass("js-forum-quote")&&j()){n=b(a);o.user=i;o.html=n.html();s.richTextEditor("quote",o)}else{if(j()===false){s.val("@"+i.slug+": "+s.val())}else{s.richTextEditor("reply",i)}}})};var q=function(){e.on("click",'[data-embed-type="spoiler"] .header',function(){r(this).siblings(".content").toggleClass("hide")})};var _=function(){e.on("click",".js-best-answer",function(){var a=r(this);var t=false;e.find(".js-best-answer-header").remove();var s=a.parents(".js-message");if(s.hasClass("answer")){t=true}e.find(".js-message.answer").each(function(){var e=r(this);var a=e.find(".js-best-answer");var t=a.attr("data-toggle-value");a.attr("data-toggle-value"," "+a.text());a.text(t);e.removeClass("answer")});if(!t){s.addClass("answer")}})};var F=function(){e.on("click",".btn-toggle-visibility",function(e){var a=r(this);e.preventDefault();var t=a.attr("data-toggle-label");if(t){a.attr("data-toggle-label",a.text());a.text(t)}var s=a.attr("data-toggle-target");if(s){r(s).toggleClass("hide")}})};var R=function(e){if(r(".js-forum-messages .js-message").length===0){return}var a=5e3;var t="button";var s=function(e){var a=r(".js-post-render-topic");if(a.length===0){return null}else{return{url:a.data("base-url")+"?page="+e.page+"#js-message-"+e.savedPosition,index:e.savedPosition,page:e.page}}};var i=function(){if(!!Modernizr&&Modernizr.sessionstorage){var e=sessionStorage["savedPosition:"+window.location.pathname];if(e==="true"){return true}else{sessionStorage["savedPosition:"+window.location.pathname]="true"}}return false};var n=function(e){if(t==="button"){r(".js-last-read").attr("href",e.url).removeClass("hidden")}else if(!i()){Phoenix.Ui.showNotificationMessage('Would you like to continue where you left off? <a class="btn" href="'+e.url+'">Take me there</a>',{hideDelay:a})}};var o=function(e,a){if(a===null){return}var t=r(".js-message:last");var i=s(a);if(i){var o=parseInt(i.index);var l=parseInt(t.attr("id").split("-")[2]);if(o>l){n(i)}else{var f="#js-message-"+i.index;if(window.location.hash!==f&&r(f).length>0){n(i)}}}};if(e){PostRender.executePostRender()}PostRender.getPostRenderData("ForumBundle",o)};_();q();R();if(w()===false){return}var A=function(){R(true)};M(A);k();T();S();F();U();if(j()===false){return}};a.ready(function(){r(".js-comments-block, .js-forum-block, .js-profile-blog, .js-user-list, .js-moderation-block, .js-pm-block").each(function(){e.initCollectionBlock(r(this))})})})(this,this.jQuery);
(function(e,a){"use strict";var t=a(e.document);var r="Whoops! Something happened and we are working on it!";var i="<div class='loading'></div>";var n=a(i);var o=function(e){e.on("click",".feed-hdr a",function(e){e.preventDefault();var r=a(this),n=r.attr("href"),o=r.data("dir"),l=a(this).parent().hasClass("paginate-refresh");a.cookie("comment-sort-dir",o,{path:"/",expires:30});if(l){t(n,true)}else{t(n,false);s.pageName=i(s.pageName,n);a("#comments-block .feed-hdr:not(:first) li").removeClass("on");a("#comments-block .feed-hdr:not(:first) li").eq(r.parent("li").index()).addClass("on");void s.t()}});e.on("click",".js-paginate-order-switch",function(a){a.preventDefault();e.find(".feed-hdr a:not(.on)").first().trigger("click")});var t=function(t,s){var i=e;var o=i.offset().top;var l=a(window);if(s){var d=i.find(".symbol-refresh").attr("class","symbol symbol-refresh spin")}else{n.height(i.height());i.hide();i.after(n)}if(l.scrollTop()>o){a("html, body").animate({scrollTop:o},300)}a.ajax({url:t,success:function(e){if(i.data("etag")===e.etag){var t=a("<span> No new comments</span>").hide();i.find(".paginate-refresh").after(t);t.fadeIn().delay(1250).fadeOut(400,function(){t.remove()});return}i.data("etag",e.etag);if(e.success===0){Phoenix.Ui.showErrorMessage(e.errMessage);return}var r=a(e.html);r.filter("dl.paginate-messages").replaceAll(i.find("dl.paginate-messages"));r.filter("dl:last-child").replaceAll(i.find("dl:last-child"));r.filter(".comment-messages").replaceAll(i.find(".comment-messages"));var s=new Date(i.data("last-updated"));i.find(".comment-messages .js-message time").each(function(){var e=a(this);if(new Date(e.attr("datetime"))>s){a("<span> New</span>").hide().insertAfter(e).fadeIn().delay(3050).fadeOut(500,function(){a(this).remove()})}});i.data("last-updated",e.lastUpdated);a(document).trigger("image-viewer-rescrape")},error:function(){Phoenix.Ui.showErrorMessage(r)},complete:function(){if(s){d.attr("class","symbol symbol-refresh")}else{n.remove();i.show()}}})};var i=function(e,a){var t=e.match(/:p([0-9]):/i);var r=t?t[1]:null;var i=a.split("comment_page=")[1];if(!i)i=1;if(!r){return s.pageName}return e.split(":p"+r+":").join(":p"+i+":")}};var l;var d=function(){var s=a(".js-load-comments"),i;if(undefined===l){i=s}else{i=s.not(l)}if(!i||i.length<1){return}i.on("click.loadComments",function(s){s.preventDefault();var i=a(this);i.addClass("hide");i.after(n);a.ajax({url:i.attr("href"),data:{comment_page:1,wrap:1},success:function(r){var s=a(r.html);i.removeClass("js-load-comments");i.trigger("commentsLoaded",[s]);i.replaceWith(s);o(s);if(a.fn.richTextEditor!==undefined){s.find(".js-editor-textarea").richTextEditor()}t.trigger("image-viewer-rescrape");e.initCollectionBlock(s)},error:function(){Phoenix.Ui.showErrorMessage(r)},complete:function(){n.remove();i.removeClass("hide")}})});l=s};t.ready(function(){a(".js-comments-block").each(function(){o(a(this))});d()});t.ajaxComplete(d)})(this,jQuery);
Phoenix._uploaderButtonAjaxBound=false;Phoenix._uploaderReadyBound=false;Phoenix._uploaderReadyNonAjaxTriggered=false;Phoenix.jQuery.getDocument().ready(function e(r){"use strict";var a=".image-widget-container";var i=[a+" .btn",a+" .clickable"].join(",");var o=$(a);var n=$(document);var t,l,u,d;var s,c;var f=function(e,r){if(!u.hasClass("hide")&&u.children("img").length===0){u.addClass("hide")}var a=o.find("img");var i=a.length===0;var n=$();var l=function(){Phoenix.Ui.showErrorMessage("Unable to load image");d.parent().replaceWith(s)};var f=function(e){return function(){if(this.width<10||this.height<10){l()}if(typeof e==="function"){e()}}};if(i){d=$('<img class="clickable">');n=$('<a class="image-widget" href="#">').append(d)}else{d=$(a[0])}if(e["successful"]===undefined){return l()}var h=function(e,a){d.bind("error",l);d.bind("load",f(r));d[0].src=a["url"];if(a["id"]){if(t.length===0||!t){t=o.find("input")}t.val(a["id"])}else{l()}};$.each(e["successful"],function(r,a){if(Phoenix.UploaderButton._successHandler){a["embargo"]=!!e["image-embargo"];var o=Phoenix.UploaderButton._successHandler(c,r,a);if(o===true){i=false}}else{h(r,a)}});if(i){o.find(".btn-primary").addClass("hide");n.appendTo(o)}else{u.removeClass("hide")}for(var p in Phoenix.UploaderButton._callbackFunctions){if(o.is(p)||o.find(p).length>0||o.parent().find(p).length>0){Phoenix.UploaderButton._callbackFunctions[p].call(d)}}};var h=function(e){var r=e["errors"];if(e.crossOriginError){Phoenix.Ui.showErrorMessage("An error occurred while loading the image. The image editor will be closed.");return f(e)}if(u.hasClass("hide")){u.removeClass("hide")}if(e.status===413){return Phoenix.Ui.showErrorMessage("Image is too large, please upload a smaller image.")}if(r!==undefined){if(r["url"]){return Phoenix.Ui.showErrorMessage(r["url"])}if(r["file"]){return Phoenix.Ui.showErrorMessage(r["file"])}}};var p=function(e){c=$(this);o=c.closest(a);t=o.find("input");u=o.find(".image-widget, .btn-primary");s=u.parent().clone(true);var r=c.data("multiple");$.uploader({complete:f,error:h,type:"image",postURL:"/images/upload",urlPostURL:"/images/url-submit",headerText:"Where does your image live?",multiple:r,fileType:["image/jpeg","image/gif","image/png"],drop:true,dropText:"Or drag and drop your image to this window."});l.modal("show");e.preventDefault();return false};var g=function(e){e.each(function(){var e=$(this);if(e.data("uploader")){return}n.trigger("uploaderReady",[e])})};if(!Phoenix._uploaderButtonAjaxBound){n.ajaxComplete(function(){e(true)});Phoenix._uploaderButtonAjaxBound=true}if(!Phoenix._uploaderReadyBound){n.on("uploaderReady",function(e,r){l=$("#js-uploader");if(r){o=r}if(o.data("uploader")){return}n.on("click.uploaderButton",i,p);o.data("uploader",true);o.data("uploaderCompleteHandler",f)});Phoenix._uploaderReadyBound=true}if(r===true){g(o)}else if(!Phoenix._uploaderReadyNonAjaxTriggered){g(o);Phoenix._uploaderReadyNonAjaxTriggered=true}});Phoenix.UploaderButton=function(){"use strict";return this};Phoenix.UploaderButton._callbackFunctions={};Phoenix.UploaderButton._successHandler=null;Phoenix.UploaderButton.setCallbackFunction=function(e,r){"use strict";Phoenix.UploaderButton._callbackFunctions[e]=r};Phoenix.UploaderButton.setSuccessHandler=function(e){"use strict";Phoenix.UploaderButton._successHandler=e};
$(document).ready(function(){"use strict";var t="_promos_seen";$("a[data-promo-id], .js-video-player[data-promo-id]").on("click",function(){var a=$.cookie(t);var r=new Date;var e=parseInt($(this).attr("data-promo-id"),10);var i=parseInt($(this).attr("data-top-slot-allowed"),10)===1;var o=[];var n=$("#promo-id-"+e).children("a").data();if(!e||n&&n.cms===true){return}if(parseInt($(this).parent().attr("data-pinned"),10)===1){return}r.setMonth(r.getMonth()+1);if(a&&a.charAt(0)==="["){a=$.parseJSON(a)}else{a=[]}for(var s=0;s<a.length;s=s+1){if(a[s]===e){continue}for(var p=0,d=false;p<o.length;p++){if(o[p]===a[s]){d=true;break}}if(!d){o.push(a[s])}}o.push(e);$.cookie(t,JSON.stringify(o.slice(-20)),{expires:r,path:"/"})})});
var AjaxApiRequest=function(){"use strict";var e={makeApiRequest:function(e,t,a,i,r){if(typeof t=="undefined"||typeof a=="undefined"){throw"Must specify params, and post or get for makeApiRequest"}return n(e,t,a,i,r)},makeGetApiRequest:function(e,t,a,i){if(typeof t=="function"){i=a;a=t;t=null}return n(e,t,false,a,i)},makePostApiRequest:function(e,t,a,i){if(typeof t=="function"){i=a;a=t;t=null}return n(e,t,true,a,i)},makeAppropriateApiRequest:function(e,t,a,i){if(typeof t=="function"){i=a;a=t;t=null}var r=JSON.stringify(t);if(r.length>1800){return n(e,t,true,a,i)}else{return n(e,t,false,a,i)}},eoo:null};(function(){$(document).ready(function(){$(".js-ajax-api-request").click(function(e){e.preventDefault();var t=$(this);var a="";var i=t.attr("data-api-url-from");if(typeof i!="undefined"){a=$(i).val()}else{a=t.attr("href")}if(t.data("add-class")){n(a,null,true,function(){t.toggleClass(t.data("add-class"));t.attr("href","#null")})}else{n(a,null,true)}});$(".js-ajax-api-request-select").change(function(){n($(this).val())});$(".js-ajax-api-track-anchor").click(function(e){var n=$(this);if(n.data("api_anchor_event_called")===true){return}var a=n.attr("data-tracking-token");if(t(a)){n.data("api_anchor_event_called",true);Phoenix.getDocument().trigger("api_anchor_event",a);var i=n.attr("href");if(i.charAt(0)!="#"){e.preventDefault();var r=n.attr("target");setTimeout(function(){n.data("api_anchor_event_called",false);if(!r||r===""){window.location=i}else{window.open(i,r)}},1e3)}else{n.data("api_anchor_event_called",false)}}});$(".js-ajax-api-track-form-submit").click(function(e){var n=$(this);var a=n.attr("data-tracking-token");if(!t(a)){return}if(n.data().formPostLatch===undefined){e.preventDefault();Phoenix.getDocument().trigger("api_result_event",a);n.prop("disabled",true);n.data().formPostLatch=true;setTimeout(function(){n.prop("disabled",false);if(navigator.userAgent.search("Firefox")==-1){n.trigger("click")}else{var e=n.parents("form");if(e[0]){if(typeof tinymce!="undefined"){tinymce.triggerSave()}e.submit()}}},250)}else{delete n.data().formPostLatch}})})})();function t(e){return typeof e!="undefined"&&e&&e!==""}function n(e,t,n,a,i){if(typeof n=="undefined"){n=false}if(typeof a=="undefined"){a=function(){}}if(typeof i=="undefined"){i=function(){}}var r=n?$.post:$.get;var f=r(e,t,function(e,t,n){if(typeof e!="undefined"&&e&&typeof e.trackingToken!="undefined"){Phoenix.getDocument().trigger("api_result_event",[e])}a(e,t,n)}).error(function(e,t,n){i(n,e)}).statusCode({0:function(e){},303:function(e){},302:function(e){}});return f}return e}();
var UrlMaster=function(){"use strict";var n={setOrigin:function(n){e=n},setPath:function(n){t=n},addParam:function(n,e){r[n]=e},removeParam:function(n){if(typeof(r[n]!="undefined")){delete r[n]}},hasParam:function(n){return r.hasOwnProperty(n)},getParam:function(n,e){if(typeof e=="undefined"){e=null}if(!r.hasOwnProperty(n)){return e}if(typeof r[n]=="undefined"){return true}else{return decodeURIComponent(r[n])}},getAllParams:function(){return r},clearParams:function(){r={}},paramExists:function(n){return typeof(r[n]!="undefined")},setHash:function(n){a=n},getHash:function(){return a},setHashLive:function(n,e,t){if(typeof e=="undefined"){e=false}if(typeof t=="undefined"){t=false}f=e;window.location.hash=n;if(t){a=n}},getHashLive:function(){var n=window.location.hash;if(n===""){return""}return decodeURI(n.toLowerCase()).substr(1)},getHashParams:function(n){if(typeof n=="undefined"){n={}}var e=window.location.hash;if(e===""){return{}}var t=s(e.substr(1));$.extend(n,t);return n},setHashParams:function(e,t){var a="";for(var r in e){if(e.hasOwnProperty(r)){a+=r+":"+e[r]+";"}}a=encodeURI(a.substr(0,a.length-1));n.setHash(a,t)},updateHashParams:function(e,t){var a=n.getHashParams();for(var r in e){if(e.hasOwnProperty(r)){a[r]=e[r]}}n.setHashParams(a,t)},bindHashChange:function(n,e){if(!i){throw"Hash change support not available."}if(o.indexOf(n)!=-1){return}o.push(n);if(typeof e!="undefined"&&e){n()}},unbindHashChange:function(n){if(!i){throw"Hash change support not available."}var e=o.indexOf(n);if(e==-1){return}o.splice(e,1)},generateUrl:function(n){var i="";if(!n){if(e!==""){i=e}else{i=window.location.protocol+"//"+window.location.hostname}if(window.location.port.length){i+=":"+window.location.port}}if(t!==""){i+=t}else{i+=window.location.pathname}if(Object.keys(r).length){i+="?";for(var o in r){if(r.hasOwnProperty(o)){i+=o+"="+encodeURIComponent(r[o])+"&"}}i=i.substr(0,i.length-1)}if(a!==""){i+="#"+a}return i},eoo:null};var e="";var t="";var a="";var r={};var i=false;var o=[];var f=false;(function(){var n=window.location.search;if(n!==""){n=n.substr(1);n.split("&").forEach(function(n){var e=n.split("=");r[e[0]]=e[1]})}a=window.location.hash;if(a!=""){a=a.substr(1)}var e=$(window);if(e.hashchange){i=true;e.hashchange(function(){if(f){f=false;return}o.forEach(function(n){n()})})}})();function s(n){var e={};if(typeof n=="undefined"||!n){return e}try{n.split(";").forEach(function(n){var t=n.split(":");if(t.length==2){var a=t[0].replace(/\s/g,"");e[a]=t[1].replace(/^[ \t]+|[ \t]+$ /,"")}else{e[t[0]]=null}})}catch(t){return[]}return e}return n};
var PostRender=function(){var e=null;var r="";var n=[];var t=function(){var t={};$("[data-post-render-param]").each(function(e,r){var n=$(r);var o=n.attr("data-post-render-param");var i=n.attr("data-post-render-value");var a=o.endsWith("[]");if(a){o=o.substr(0,o.length-2)}var u=o.split(".");if(typeof t[u[0]]=="undefined"){t[u[0]]={}}if(a){if(typeof t[u[0]][u[1]]=="undefined"){t[u[0]][u[1]]=[i]}else{t[u[0]][u[1]].push(i)}}else{t[u[0]][u[1]]=i}});var o=new UrlMaster;var a={page:o.generateUrl(true),params:t};var u=o.getParam("ip_override",null);if(u){a.ip_override=u}AjaxApiRequest.makePostApiRequest("/postRender",a,function(n){if(n.result!="ok"){e="error";r="server error: "+n.error}else{e=n.data}f()},function(n){e="error";r="network error: "+n;f()});function f(){n.forEach(function(e){i(e.bundle,e.completionFn,e.errorFn)})}};var o={getPostRenderData:function(r,t,o){if(e){setTimeout(function(){i(r,t,o)},0)}else{n.push({bundle:r,completionFn:t,errorFn:o})}},executePostRender:function(){e=null;r="";n=[];t()},eoo:null};$(document).ready(function(){t()});function i(n,t,o){if(e==="error"){if(typeof o=="function"){o(r)}return}if(n&&typeof e[n]=="undefined"){if(typeof o=="function"){o("bundle does not provide post render data")}return}t(e._common,n?e[n]:undefined)}return o}();if(!String.prototype.endsWith){Object.defineProperty(String.prototype,"endsWith",{value:function(e,r){var n=this.toString();if(r===undefined||r>n.length){r=n.length}r-=e.length;var t=n.indexOf(e,r);return t!==-1&&t===r}})}
$(document).ready(function(){"use strict";(function(){var t=$(".js-forum-layout"),e=!!t.length;if(!e){return}var a=document.querySelector("#forums #forum-content"),o="container-fluid",s="container";var i=function(){var t=$(this).attr("data-type-layout");var e=$.cookie("forumLayout");if(e=="container"){classie.remove(a,o);classie.add(a,s)}else if(e=="container-fluid"){classie.remove(a,s);classie.add(a,o)}};var n=function(t,e){if(t!==undefined){$.cookie(t,e,{expires:365,path:"/"})}};$(document).on("click",".js-forum-layout",function(t){var e=$(this).attr("data-type-layout");n("forumLayout",e);i()});var r=$(".table-forums .is-topic-sticky").last(),u=!!r.length;if(!u){return}function c(){if(!r.hasClass("is-last-sticky")){r.addClass("is-last-sticky")}}c()})();(function(){var t=function(t,e){if(e===null){return}$(".js-posts").each(function(){var t=$(this).find("meta.js-post-render-topic");var a=t.data("post-render-value");var o=t.data("full-message-count");var s=$.grep(e,function(t){return t.topic==a});if(s&&s.length>0&&s[0].savedPosition>0){var i=s[0];var n=o-i.savedPosition;if(n>0){$(this).append('<a class="saved-position" title="'+n+' New posts. Continue where you left off" href="'+t.data("base-url")+"?page="+i.page+"#js-message-"+i.savedPosition+'">&raquo;</a>')}}})};if($("meta.js-post-render-topic").length>0){PostRender.getPostRenderData("ForumBundle",t)}})()});
(function(e,a){"use strict";var o;PostRender.getPostRenderData("GameBundle",function(t,n){o=n;PostRender.getPostRenderData("FollowBundle",function(t,n){var l=a(".stacks");a.each(l,function(e,t){var l=a(t),r=l.attr("data-post-render-value");if(a(".js-game-card-follow").length){var i="/api/follow/unfollowGameRelease/"+r;var s=false;var f=o[r];if(!f){return true}var c=Object.keys(f["platforms"]).length>1;if(c){var d=null;a.each(f["platforms"],function(e,o){var t="/api/follow/followGameRelease/"+r+"-"+o["abbreviation"];var i="/api/follow/unfollowGameRelease/"+r;var f=n[r][o["name"]];var c=a("<div>").append(l.find(".stacks-list__item").clone()).html().trim();if(f){s=true;c=c.replace(/%following%/g,"following")}else{c=c.replace(/%following%/g,"")}c=c.replace(/%platformFollowURL%/g,t).replace(/%platformUnfollowURL%/g,i).replace(/%isFollowingThisPlatform%/g,f).replace(/%platformName%/g,o["name"]);if(d==null){d=c}else{d+=c}})}else{if(Object.keys(f["platforms"])[0]!=null){var g="/api/follow/followGameRelease/"+r+"-"+f["platforms"][Object.keys(f["platforms"])[0]]["abbreviation"],p=l.find(".js-game-card-follow"),u=l.find(".js-game-card-follow-toggle"),m=p.data("stacks-event-hierarchy");u.attr("data-follow-url",g);u.addClass("js-game-follow-event-tracking");l.find(".js-pop-over-container").remove();if(m){u.attr("data-event-tracking",m)}s=n[r][f["platforms"][0]["name"]]}}l.find(".stacks-list__item").replaceWith(d);var v=a("<div>").append(l.clone()).html().trim();v=v.replace(/%isFollowing%/g,s).replace(/%followText%/g,"Follow").replace(/%followingText%/g,"Following").replace(/%multiplatform%/g,c).replace(/%getUnFollowGameReleaseApiUrl%/g,i);v=a(v);if(s){v.find(".game-card-follow-text").text("Following")}l.replaceWith(v)}else{var v=a("<div>").append(l.clone()).html().trim();v=v.replace(/%gameName%/g,o[r]["game"]["name"]);v=a(v);v.find(".js-game-image").attr("src",o[r]["image"]);l.replaceWith(v)}});a(".stacks").removeClass("game-card-loading");var r=false;var i=function(){var t=false,n=a(".js-game-card-follow"),l=a(".js-game-card-follow-toggle");if(n.data("gamecard-initialized")){return}n.data("gamecard-initialized",1);l.tooltip();var s=function(e){e.each(function(e,o){var t=a(o),n=t.parent(".js-game-card-follow"),l=n.attr("data-following")==="true";t.tooltip(l?"disable":"enable");t.find(".game-card-follow-text").text(n.data(l?"following-text":"follow-text"))})};var f=function(e){if(t){return false}t=true;return a.post(e).fail(function(){Phoenix.Ui.showErrorMessage("An error occurred. Please try again later.")}).always(function(){t=false})};var c=function(){var e="event-tracking";return function(o,t){var n=o.data(e),l;if(typeof n==="string"){l=n;n=undefined}if(undefined===n){n={};if(l){n.event_hierarchy=l}if(t.eventTracking){a.extend(n,t.eventTracking)}if(!a.isEmptyObject(n)){o.data(e,n)}}if(undefined!==n&&!a.isEmptyObject(n)){o.trigger("gameFollowEventTracking")}}}();l.each(function(){var e=a(this);if(typeof e.data("click-registered")==="undefined"){e.on("click",function(e){e.preventDefault();var t=a(this),n=t.parent(".js-game-card-follow"),l=n.attr("data-following")==="true",r=t.data("game-id"),i=a('[data-game-id="'+r+'"]');if(t.data("multiplatform")){return false}var d=t.data(l?"unfollow-url":"follow-url");f(d).done(function(e){if(!e["success"]){Phoenix.Ui.showErrorMessage(e["reason"]||"An unknown error occurred. Please try again later.");return}l=!l;n.attr("data-following",""+l);var f=l?"You're now following this game!":"You're no longer following this game.";i.each(function(e,o){a(o).parent(".js-game-card-follow").attr("data-following",""+l)});s(i);Phoenix.Ui.showSuccessMessage(f);if(l){c(t,e);_BoomTrain.sendEvent("followed",{model:"game",id:"5003-"+r,platforms:o[r]["platforms"][0]["name"],genres:o[r]["genres"]})}})});e.data("click-registered",true)}});a(".js-game-card-follow-platform").each(function(){var e=a(this);if(typeof e.data("click-registered")==="undefined"){e.on("click",function(e){e.preventDefault();var t=a(this),n=t.attr("data-following")==="true",l=t.data("follow-url"),r=t.data("unfollow-url"),i=t.parents(".js-game-follow").data("popover-game-id"),d=a('[data-popover-game-id="'+i+'"]'),g=a('[data-game-id="'+i+'"]'),p=d.find('.js-game-card-follow-platform[data-follow-url="'+l+'"]'),u=n?r:l;f(u).done(function(e){if(!e["success"]){Phoenix.Ui.showErrorMessage(e["reason"]||"An unknown error occurred. Please try again later.");return}var l;n=!n;p.attr("data-following",""+n);if(n){l="You're now following this release!";p.addClass("following")}else{l="You're no longer following this release.";p.removeClass("following")}g.each(function(e,o){var t=false;d.find(".js-game-card-follow-platform").map(function(e,o){if(a(o).attr("data-following")==="true"){t=true}});a(this).parent(".js-game-card-follow").attr("data-following",""+t)});s(g);Phoenix.Ui.showSuccessMessage(l);if(n){c(t,e);_BoomTrain.sendEvent("followed",{model:"game",id:"5003-"+i,platforms:e["platformAbbrev"],genres:o[i]["genres"]})}})});e.data("click-registered",true)}});a(".js-game-card-follow-form").each(function(e,o){var t=a(o);if(typeof t.data("submit-registered")==="undefined"){t.submit(function(e){var o=a(this);e.preventDefault();var t=o.find("input[name=email]").val();AjaxApiRequest.makePostApiRequest(o.attr("action"),{email:t},function(e){if(typeof e!=="undefined"&&!e.success){o.find(".error").html(e.reason)}else{o.addClass("hidden");o.siblings(".js-game-card-follow-others").removeClass("hidden").find("input[name=email]").val(t);setTimeout(PhoenixPopover.hidePopover,4e3)}},function(){o.find(".error").html("An error occured, please try again")})});t.data("submit-registered",true)}});a(".js-pop-over-container.js-game-follow").each(function(){var e=a(this);if(typeof e.data("popover:shown-registered")==="undefined"){e.on("popover:shown",function(e,o){var t=a(this);if(t.hasClass("js-game-follow-unreg")){t.css({display:"block"})}else{t.css({width:o.toggle.css("width"),display:"block"})}t.position({my:"center top",at:"center bottom",of:o.toggle,collision:"fit"})})}});PhoenixPopover.init();if(!r){a(e).ajaxComplete(i);r=true}};i();a(e).on("on_page_event",i)},function(e){console.error(e)})})})(document,jQuery);var PhoenixPopover=function(){var e={init:function(){$(".js-pop-over-toggle").each(function(e,l){var r=$(l);if(typeof r.data("toggle-init")==="undefined"){for(var i=r.parent();i[0].nodeName.toLowerCase()!="body";i=i.parent()){if(i.hasClass("js-pop-over-parent")){break}}var s=i.find(".js-pop-over-container");var f={element:s,width:s.width(),height:s.height(),toggle:r,clickOffsetX:parseInt(s.attr("data-click-open-offset-X")),clickOffsetY:parseInt(s.attr("data-click-open-offset-Y"))};r.data("popOverContainer",f);$("body").append(s.detach());s.css({position:"absolute"});r.click(function(e){if(a){n();return}a=$(this).data("popOverContainer");if(a){e.stopPropagation();var l=0;if(e.clientX+a.width>$(document).width()){a.element.addClass("popover-position-left");l=e.clientX-a.width-a.clickOffsetX}else{a.element.addClass("popover-position-right");l=e.clientX+a.clickOffsetX}a.element.css({top:e.clientY+$(window).scrollTop()+a.clickOffsetY,left:l});a.element.show();a.element.trigger("popover:shown",a);$("body").bind("click",o);$(window).bind("resize",t)}});r.data("toggle-init",true)}})},hidePopover:function(){if(a){n()}},eoo:null};var a=null;function o(e){var o=$(".js-game-follow-unreg").length>0;if(!$.contains(a.element[0],e.target)&&o||!o){n()}}function t(){if(a){n()}}function n(){a.element.hide();a.element.removeClass("popover-position-left");a.element.removeClass("popover-position-right");a=null;$("body").unbind("click",o);$(window).unbind("resize",t)}return e}();
var loadDataUserAgentPlatform=function(){"use strict";var t=document.documentElement;t.setAttribute("data-useragent",navigator.userAgent);t.setAttribute("data-platform",navigator.platform)};loadDataUserAgentPlatform();$(document).ready(function(){"use strict";var t=Phoenix.jQuery.getMessageBlock();if(t&&$.trim(t.html())!==""&&!t.hasClass("transitioning")){var e=$.trim(t.html());Phoenix.Ui.showMessageBar(e)}var a=$('meta[itemprop="deviceType"]').attr("content");if(a!=="phone"){$(".paginate a").tooltip();$(".tipsy").tooltip()}var i=function(){$(".search-autocomplete").each(function(){var t=$(this);var e=t.data("autocomplete-indexes");var a={};if(t.data("initialized")===true){return}if($(this).data("cms")){a.cms=1}if(e){t.autocomplete({autoRedirect:true,searchIndex:e,selectFirst:true,showNotificationBar:true,extraParams:a})}else{t.autocomplete({showNotificationBar:true,extraParams:a})}t.data("initialized",true)})};i();$(document).ajaxStop(i);$(document).on("newAutoCompleteAdded",i);var r=false;$(".js-prevent-mult-submit").on("submit",function(t){$(this).find("button[type=submit]").attr("disabled","disabled");if(r){t.preventDefault();t.stopPropagation()}else{r=true}return true})});
$(document).on("ready ajaxContentLoaded",function(){"use strict";$(".js-load-forever").each(function(){var a=$(this);if(a.data("loadForeverInitialized")){return}a.data("loadForeverInitialized",true);var t=a.attr("data-page-name")||"page";var e=a.attr("data-show-more-type")||"";var r=e===""?"":"river/content/"+e;var n=a.attr("data-target")||".js-load-forever-container";var i=typeof a.attr("data-no-scroll")!=="undefined";var f=a.attr("data-end-of-line-text")||"Sorry that's all folks";var d=$('<div class="loading"></div>');var l=true;var o=1;var v=false;v=a.attr("data-max-page");if(!v){v=false}var s=function(){var t=a.data("end-of-line");a.find("a").text(f);a.find("a").attr("href",t);a.find("a").attr("target","_blank");a.show();l=false};a.click(function(e){if(!l){return}if(v!==false&&o>=v){return}e.preventDefault();o=o+1;a.before(d);a.hide();$.get(r+"?"+t+"="+o,function(t){var e=null;if(t.html||t.river){var r=t.html||t.river;e=$("<div>"+r+"</div>")}else{e=$(t)}var f=e.find(n).html();var d=false;var l=$(f);if(l.filter("ul").html()!=undefined){d=l.filter("ul").html().trim()===""}if(f===""||d||e.find(".river--empty").length>0){s();return}$(n).append(l);if(!i){$("html, body").animate({scrollTop:l.offset().top})}if(v!==false&&o>=v){s()}if(e.find(".js-noPagesRemaining").length===0){var u=a.find("a").data("event-tracking");if(u){var c=u.lastIndexOf("|")+1;if($.isNumeric(u.substring(c))){var m=u.substring(0,c)+o;a.find("a").attr("data-event-tracking",m);a.find("a").data("event-tracking",m)}}a.show()}}).complete(function(){d.remove()})})})});
(function(){"use strict";var r=$("#skin-switch");if(!r||r.length<1){return}var t=$(document);var n="skinSource";var i=function(r){return r.split("_").pop()};var e=function(){var t;var n="switch__item--";var i="white";var e="black";var a={white:n+i,black:n+e};return function(n){if(t===n){return false}if(t){r.removeClass(a[t])}r.addClass(a[n]);t=n;return true}}();var a=function(){var r=function(r){return r.attr("data-rel-url")};var t=function(){var r;return function(){if(undefined===r){r=$("link#skin-color");if(!r||r.length<1){r=$("link#skin-color-non-critical")}}return r}}();return function(n){var i=r(n),e=t();e.attr("href",i)}}();var c=function(){var r;var t="richTextEditorTheme";return function(n){if(undefined===r){r=$("#richTextEditorTheme");if($.cookie(t)){$.removeCookie(t,{path:"/"})}}r.attr("content",n).trigger("change")}}();var o=function(r){$.cookie(n,r,{expires:3650,path:"/"})};var u=function(){var t=r.find(".skin-switch-btn");var u=$.cookie(n),f=r.data("default"),v=u||f,l;if(v){l=i(v);e(l);c(l)}if(!u){o(v)}t.click(function(r){r.preventDefault();var t=$(this),n=t.attr("rel"),u=i(n);if(e(u)){a(t);o(n);c(u)}})};t.ready(u)})();
(function(t){"use strict";var r=$(document);var a=".js-video-player";var n="meta.js-event-tracking";var e="event-trackers";var i;var v=function(t){var r=t.data(e),a;if(undefined===r){r={};a=t.find(n);a.each(function(){var t=$(this),a=t.attr("itemprop");if(a){r[a]=t}});t.data(e,r)}return r};var o=function(t,r){var a=v(t);return a[r]};var c=function(t){var r=$(this),a=t.type,n=o(r,a);if(n){n.trigger("customEventTracking")}};var u=function(){i.on("videoReplay postPlayStart postPlayStop",c)};r.on("ready",function(){i=$(a);if(!i||i.length<1){return}u()})})(this);
(function(t){"use strict";var e=$(document);var a=".js-video-player";var n=".js-vid-postplay";var o=".js-vid-postplay-countdown";var r=".js-vid-postplay-timer";var i=".js-vid-postplay-close";var d=".js-vid-postplay-stop";var s=".js-vid-postplay-next";var f=".js-vid-postplay-action";var u=".js-vid-postplay-videos";var l=".js-vid-postplay-video";var c="is-postplay-counting";var v="is-postplay-complete";var p="is-vid-postplay";var y="is-countdown-stopped";var w="is-countdown-disabled";var h="countdown-timeout-id";var m="postplay-started";var g="postplay-id";var x="redir-tracking";var C="event-tracking";var j="enterViewport";var k=10;var V=1e3;var P=10;var T=500;var S=0;var N={videoTimeRemaining:0,countdown:{timeValue:0,delayStart:0,delayOverride:0},deferred:false,canceled:false,paused:false,noCountdown:false};var O={};var D;var R=function(){var t,e,a,n,o,r,i,d,s,f;var c=function(){var t=f.watchedCookieName,e;if(!t){return}e=$.parseJSON($.cookie(t));if(!e){e=[]}d=e};var v=function(){var t=f.watchedCookieName,e=f.watchedCookieDays,a;if(undefined===d){return}try{a=JSON.stringify(d)}catch(n){a=false}$.cookie(t,a,{path:"/",expires:e})};var p=function(){var t=[],e,a;for(a=0;a<d.length;a++){e=d[a];if(0>$.inArray(e,s)){t.push(e)}}d=t};var y=function(){var t=e[0].querySelectorAll(l),a,n,o;for(o=0;o<t.length;o++){a=$(t[o]);n=a.data("id");if(!r){r=a}if(0<=d.indexOf(n)){s.push(n)}else{i=a;break}}};var w=function(){var n,d=t.$timer,s;if(r!==i){o=e.find(u);o.prepend(i)}n=i.find("a");if(false===$.contains(i[0],d[0])){n.append(d)}s=n.text();a.text("Next up: "+s);a.attr({href:n.attr("href"),title:s})};return function(o,d){f=o.data("video");t=d;e=t.$postPlay;a=t.$nextControl;n=t.$countdown;c();r=i=null;s=[];y();if(null===i){i=r;p();v()}w();d.$nextVideo=i}}();var H=function(t,e){var a=e.find(n),u=a.find(s),l=a.find(f),v=a.find([i,d].join(",")),p=$.extend({},N,{$player:e,$postPlay:a,$countdown:a.find(o),$nextControl:u,$nextVideo:null,$timer:a.find(r),watcher:scrollMonitor.create(e),noCountdown:a.data("no-countdown")?true:false,noNext:a.data("no-next")?true:false});p.enterViewportHandler=function(){J(p)};if(v&&v.length>0){v.on("click",function(t){var e=$(this);if(a.hasClass(c)){t.stopPropagation();t.preventDefault();if(e.is(i)){L(p)}else{I(p)}}})}u.on("click",function(){F(p)});l.on("click",function(){var t=$(this).closest(p.$nextVideo);if(t.length>0){F(p)}else{I(p)}});l.each(function(t){var e=$(this),a=e.data(C);if(a){a+="|"+(t+1);e.data(C,a)}});if(p.noNext===false){R(e,p)}O[t]=p};var M=function(t){var e=t.data(g);if(!e){S++;e=S;t.data(g,e);H(e,t)}return O[e]};var b=function(t){var e=t.$nextControl,a=e.data(x);if(a){e.data(C,a);e.trigger("customEventTracking")}window.location=e.attr("href")};var A=function(t){var e=t.data(h);clearTimeout(e);e=null;t.data(h,e)};var E=function(t,e,a){var n=t.$countdown,o=t.videoTimeRemaining,r,i;A(n);if(Math.floor(o)>e){e=Math.floor(o);a=(o-e)*V+P}r=e-1;n.text(e);t.countdown={timeValue:e,delayStart:Date.now(),delayOverride:null};if(t.paused){return}if(a){}if(0>=e){setTimeout(function(){F(t,true)},T)}else{i=setTimeout(function(){E(t,r)},a||V);n.data(h,i)}};var J=function(t){var e=t.$countdown,a;A(t.$countdown);B(t);t.$postPlay.removeClass(v).addClass(c);t.$timer.removeClass(y);a=setTimeout(function(){E(t,k)},P);e.data(h,a)};var q=function(t){if(!t.deferred){t.deferred=true;t.watcher.on(j,t.enterViewportHandler)}};var B=function(t){if(t.deferred){t.deferred=false;t.watcher.off(j,t.enterViewportHandler)}};var I=function(t){$.extend(t,N);A(t.$countdown);B(t);t.$postPlay.removeClass(c);t.$timer.addClass(y)};var W=function(t){if(!t.paused&&t.countdown.timeValue>0){var e=Date.now(),a=e-t.countdown.delayStart;A(t.$countdown);B(t);t.paused=true;t.countdown.delayOverride=a}};var z=function(t){if(t.paused){t.paused=false;E(t,t.countdown.timeValue,t.countdown.delayOverride)}};var F=function(t,e){I(t);t.$postPlay.addClass(v);if(e){b(t)}};var G=function(t){I(t);t.$player.removeClass(p)};var K=function(t){t.$player.addClass(p)};var L=function(t){G(t);t.canceled=true};var Q=function(t){var e;if(true===t.data(m)){return}t.trigger("postPlayStart");D=e=M(t);t.data(m,true);K(e);if(e){e.canceled=false;if(e.countdown&&!e.noCountdown){if(e.watcher.isInViewport){J(e)}else{q(e)}}else{e.$timer.addClass(w)}}};var U=function(t){var e;if(!t.data(m)){return}e=M(t);t.data(m,false);if(e){G(e)}};var X=function(){e.on({contentPause:function(){W(M($(this)))},contentProgress:function(t,e){if(e){var a=$(this),n=M(a),o=e.duration-e.currentTime;n.videoTimeRemaining=o;if(k<o){U(a)}else{if(false===e.adPlaying&&true===e.playing){Q(a,e)}}}},contentResume:function(){var t=M($(this));if(t.paused){z(t)}}},a)};var Y=function(){e.on({contentEnd:function(){Q($(this))},videoStart:function(){U($(this))}},a)};var Z=function(t){var a=t.data("postplay-start");if(0===a){Y()}else{X()}e.on({rteBlur:function(){if(D&&!D.canceled){q(D)}},rteTyping:function(){if(D){I(D)}}},".js-editor-textarea")};e.on("ready",function(){var t=$(n);if(t&&0<t.length){Z(t)}$(".js-preshow-iframe").load(function(){this.contentWindow.$(".js-video-player").on("postPlayStart",function(){$(".js-preshow-title").remove()})})})})(this);
(function(e){"use strict";var a=$(document);var i=".js-video-player";var n="video";var t="states";var o=5;var r={};var d=function(e){var a=e.data(t),i=a.videoId,o=r[i],d;if(undefined===o){d=e.data(n);o=d.savePosition;if(undefined===o){o=null}else{o["videoId"]=i}r[i]=o}return o};var v=function(e){if(!e.api){return}$.ajax({type:"POST",url:e.api.deleteSavedTime,data:{video_id:e.videoId}})};var u=function(e,a){if(!e.api){return}$.ajax({type:"POST",url:e.api.setSavedTime,data:{video_id:e.videoId,time_to_save:a},async:false})};var f=function(e){$.removeCookie(e.cookieName,{path:"/"})};var c=function(e,a){$.cookie(e.cookieName,a,{path:"/",expires:o})};var s=function(e){v(e);f(e)};var l=function(e,a){var i=a.currentTime,n=Math.floor(i)>=Math.floor(a.duration);if(n){s(e)}else{u(e,i);c(e,i)}};var p=function(e,a){var i=$(this),n=i.data(t),o=d(i);if(!o){return}if(n.adPlaying||!(n.playing||n.paused)){return}if(a){n.currentTime=a}l(o,n)};a.on("videoPlayerReady",function(e,t){var o=t.data(n);if(!o||!o.savePosition){return}a.on("contentEnd contentPause contentSeek unloadVideoplayer",i,p)})})(this);
(function(e){"use strict";var t={version:"v.2013.07.31",ageMessage:"Sorry you cannot access this content."};var i=".metisVideoPlayer";var a,n,r,s;var o=function(){var t;return function(){if(a===t){t=e.Phoenix||{}}return t}}();var l=function(){if(a===s){var e=o();if(!!e.jQuery&&!!e.jQuery.getWindow){s=e.jQuery.getWindow()}else{s=$(window)}}return s};var u=function(){if(a===n){var e=o();if(!!e.jQuery&&!!e.jQuery.getDocument){n=e.jQuery.getDocument()}else{n=$(document)}}return n};var d=function(){if(a===r){r=$("html, body")}return r};var f=function(e){if(!!e){if(!!e.preventDefault){e.preventDefault()}}};var c=function(e){var t,i=false;if(!!JSON&&!!JSON.stringify){try{t=JSON.stringify(e);i=true}catch(a){i=false}}if(!i){t=false}return t};var v=function(e){var t=o();if(!!t.Ui&&!!t.Ui.showSuccessMessage){t.Ui.showSuccessMessage(e)}};var p=function(e,t){if(!e||!t){return}var i=0,a=t.width(),n=t.offset(),r=e.pageX-n.left,s;if(r<i){r=i}else if(r>a){r=a}s=r/a;return s};var y=function(e){var t=(100*e).toFixed(2),i=t.indexOf(".00");if(i>0){t=t.substr(0,i)}return t+"%"};var g=60,h=60,m=3600,S="0",k=":";var P=function(e){var t,i,a,n="",r="",s="";if(!e){e=0}if(e<0||isNaN(e)){e=0}t=Math.floor(e%g);i=Math.floor(e/g%h);a=Math.floor(e/m);if(t<10){n=S}if(i<10){r=S}s=r+i.toString()+k+n+t.toString();if(e>=m){s=a.toString()+k+s}return s};var C=false;var T=false,A=[],b=function(){var e=A.push;if(!!e.apply){e.apply(A,[arguments])}else{e(Array.prototype.slice.call([arguments]))}};var w=function(){var t=e.console||{},i=A,a;T=true;if(!!t.log){A={push:function(){var e=t.log,i="",a="",n=arguments[0],r=n[0];if("error"===r||"warn"===r||"info"===r){i=r;if(!!t[i]){e=t[i]}else{a=i.toUpperCase()+": "}n[0]=a}n[0]="[METIS] "+n[0];if(!!e.apply){e.apply(t,n)}else{e(Array.prototype.slice.call(n))}}};b("Enable metis logging");for(a=0;a<i.length;a++){A.push(i[a])}}};if(true===T){w()}var E="is-vid-disabled";var D,O="10",I="js-vid-flash",L=function(){if(undefined===D){if(!swfobject||!swfobject.hasFlashPlayerVersion||!swfobject.hasFlashPlayerVersion(O)){D=false}else{D=true}b("Browser supports flash? "+(D?"yes":"no"))}return D},j=function(e){var t;if(false===L()){t=e.find("."+I);t.remove()}};var N,R=".js-vid-m3u8",M="application/vnd.apple.mpegURL",V=function(){if(undefined===N){var e=$("<video>")[0];if(e.canPlayType&&e.canPlayType(M)!==""){N=true}else{N=false}b("Browser supports m3u8? "+(N?"yes":"no"))}return N},x=function(e){var t=e.find(R);if(true===V()){yt(t)}else{t.remove()}};var U,_,B="js-vid-h264",q="."+B,J="js-vid-volume-control",F="."+J,G=function(){if(undefined===U){U=false;if(!!Modernizr){if(!!Modernizr.video&&Modernizr.video.h264){U=true}b("Browser supports H264? "+(U?"yes":"no"))}else{b("error","hasH264Support(): Modernizr not found")}}return U},z=function(e){var t=e.find(q);if(false===G()){t.remove()}if(!t||t.length<1){U=false}},Q=function(){if(undefined===_){var e=new Audio;e.volume=.5;_=e.volume===.5;b("Browser supports volume control? "+(_?"yes":"no"))}return _},W=function(e){if(false===Q()){e.find(F).remove()}};var H,Y=function(){if(undefined===H){if(navigator.appName.indexOf("Microsoft")!==-1){H=window}else{H=document}}return H};var K=function(e){var t=e.data("video");if(!t){return}b("getMetisVideoJSON() videoJSON:\n",$.extend({},t));return t};var X=function(){var e="[AD CALL] ";var t=function(t){var i=o(),a=i.CampaignParams&&i.CampaignParams.getParams&&i.CampaignParams.getParams()||null;if(t&&a){b(e+"campaignParams: ",c(a));t=$.extend(t,a);b(e+"updated custParams: ",c(t))}return t};return function(){var i=nt.video,a=i.states.adPlayed,n=i.videoJSON.adCall,r={},s={},o,l;if(!n||true===a){return}b(e+"Get adCallUrl");n=decodeURIComponent(n);b(e+"Initial adCallUrl: ",n);o=n.split("?");if(o.length>1){n=o[0];r=$.deparam(o[1]);if(r.cust_params){s=$.deparam(r.cust_params);b(e+"custParams: ",c(s))}}l=$.cookie("AD_SESSION");if(!!l){if(s.session){s.session=l}else{s=$.extend({session:l},s)}}s=t(s);if(!$.isEmptyObject(s)){r.cust_params=$.param(s)}if(!$.isEmptyObject(r)){n=n+"?"+$.param(r)}b(e+"Final adCallUrl: ",n);return n}}();var Z={name:"basePlayer",logPrefix:"",initialized:false,playerReady:false,contentLoading:false,load:function(){},init:function(){this.initialized=true},detach:function(){},play:function(){},pause:function(){},resume:function(){},stop:function(){},mute:function(){},unmute:function(){},setVolume:function(){},seekTo:function(){},seekToLive:function(){},getCurrentTime:function(){return 0},getDuration:function(){},isInitialized:function(){return this.initialized},isReady:function(e){return this.playerReady},setPlayerReady:function(e){var t=this,i=t.logPrefix;if(t.playerReady!==e){b(i+"Set playerReady to ["+(e?"TRUE":"FALSE")+"]");t.playerReady=e}if(e){nt.onPlayerReady()}},isContentLoading:function(){return this.contentLoading},setContentLoading:function(e){var t=this,i=t.logPrefix;if(t.contentLoading!==e){b(i+"set contentLoading to ["+(e?"TRUE":"FALSE")+"]");t.contentLoading=e;nt.contentLoading(e)}if(!e){nt.onPlayerReady()}},getAdCall:X};var et=function(e){return $.extend({},Z,e)};var tt=function(){var t="flash";var i="[FLASH] ";var a="gamesVideoSwf_";var n="__gamesVideoPlayer";var r="object";var s;var o=function(){return s};var l=function(e){s=e};var u={flashPlayerStarted:function(){b(i+" flashPlayerStarted()");p(true)},adError:function(e){b("error",i+"AD ERROR: "+e)},adInfo:function(e){b("info",i+"AD : "+e)},adProgress:function(){var e=v(y.playerApiId);nt.videoProgress({currentTime:e.getCurrentTime_js(),duration:e.getDuration_js()});y.setContentLoading(false)},contentProgress:function(){var e=v(y.playerApiId),t={currentTime:e.getCurrentTime_js(),duration:e.getDuration_js(),bytesLoaded:e.bytesLoaded_js(),bytesTotal:e.bytesTotal_js()};y.setContentLoading(false);nt.videoProgress(t)},loadMinder:function(){},onAdStart_flash:function(){b(i+"onAdStart_flash()");nt.adStart()},onAdEnd_flash:function(){b(i+"onAdEnd_flash()");nt.adEnd()},onCBSIPlayerReady:function(){b(i+"onCBSIPlayerReady()")},onContentEnd_flash:function(){var e=v(y.playerApiId);b(i+"onContentEnd_flash()");b(i+"currentTime: ",e.getCurrentTime_js());nt.contentEnd(t)},onContentStart_flash:function(){b(i+"onContentStart_flash() ===== ");nt.contentStart()},onPlaylistEnd:function(){b(i+"onPlaylistEnd() =====>");nt.playlistEnd(t)},onPlaylistStart:function(){b(i+"onPlaylistStart() =====>")},userPause:function(){b(i+"userPause() =====>");nt.toggleUiPlayPause()},videoHasEnded:function(){b(i+"VIDEO END =====>")}};var d=function(e){var t=e.playerId,i,n=e.videoJSON;var r={uvpUri:n.uvp,uvpThird:n.uvpThird,imaUri:n.ima3,uvpcUri:n.uvpc};i={id:a+t,swf:n.swfLocation,width:"100%",height:"100%",allowFullScreen:true,allowScriptAccess:"always",flashvars:{autoPlay:"true",config:c(r),duration:n.lengthSeconds,guid:n.guid,id:n.id,mapp:n.mapp,partner:n.adPartner,title:n.title}};if(n.diagnosticsUniqueKey){i.flashvars.viewerDiagnosticId=n.diagnosticsUniqueKey}return i};var f=function(e){b(i+"BEG initFlashUvpObject() =====>");var a,n;if(!!e){y.setContentLoading(true);a=nt.getVideoContainer(t);n=a.find(r);if(n.length<=0){b(i+"initFlashUvpObject(): Build new flash object tag");a.flash(d(e));n=a.find(r);if(n.length<=0){n=undefined;b("error",i+"initFlashUvpObject(): unable to create video embed")}}}else{b("error",i+"initFlashUvpObject(): undefined video")}b(i+"END initFlashUvpObject() =====>");l(n);return n};var v=function(e){var t,i=Y();t=i[e];return t};var p=function(){var e=1e3;var t=null;return function(a){var n=true,r=v(y.playerApiId);if(null!==t){b(i+"isApiAlive() > clear timeout id: ",t);clearTimeout(t);t=null}try{b(i+"isApiAlive()?");n=r.isAPIAlive_js();if(false===y.playerReady){b(i+"isApiAlive > setPlayerReady(true)");y.setPlayerReady(true)}}catch(s){b("error",i+s.message);n=false;if(true===y.playerReady){b(i+"isApiAlive > setPlayerReady(false)");y.setPlayerReady(false)}}if(false===n&&true===a){b(i+"isApiAlive > NO -- check again in "+e+"ms");t=setTimeout(function(){p(true)},e);b(i+"isApiAlive() > timeout id: ",t)}if(true===n){b(i+"isApiAlive > YES")}return n}}();var y=et({name:"flashPlayer",logPrefix:i,playerApi:null,playerApiId:null,load:function(){if(!e[n]){e[n]=u}},init:function(){var e=this,t=nt.getVideoUi(),a=o(),n;if(e.isInitialized()){return}b(i+"Init Player API");if(!!t){if(!a){a=f(t)}if(undefined!==a){e.initialized=true;n=a.attr("id");if(n!==e.playerApiId){e.playerApiId=n;e.playerApi=v(n)}}}else{b(i+"Player API init failed :: no video")}},loadVideo:function(){var e=this,t=nt.getVideoUi(),a=t.states,n,r,s,o;e.setContentLoading(true);n={playback:a.playback,streamToPlay:t.getVideoUrl(),mute:a.mute,volume:a.volume};s=e.getAdCall();o=t.getCuePoints();if(s){n.adCall=s;n.cuePoints=o}r=c(n);b(i+"loadVideo() params: ",n);e.playerApi.newContentRequest_js(r)},mute:function(){b(i+"mute()");this.playerApi.mute_js()},pause:function(){b(i+"pause()");this.playerApi.pauseButton_js()},play:function(){var e=this,t=nt.getVideoUi(),i=false;if(!t){return}i=e.isInitialized();if(true===i){e.loadVideo()}},replay:function(){b(i+"replay()");this.playerApi.replay_js()},resume:function(){b(i+"resume()");this.playerApi.playButton_js()},setVolume:function(e){b(i+"setVolume("+e+")");this.playerApi.setVolume_js(e)},seekTo:function(e){b(i+"seekTo: "+e);this.setContentLoading(true);this.playerApi.seekTo_js(e)},seekToLive:function(){b(i+"seekToLive");this.setContentLoading(true);this.playerApi.seekToLive_js()},stop:function(){b(i+"stopVideo");this.setContentLoading(false);this.playerApi.stopVideo_js()},unmute:function(){b(i+"unMute()");this.playerApi.unMute_js()},fullscreenOn:function(){b(i+"fullscreenOn");this.playerApi.userFullscreen_js(1)},fullscreenOff:function(){b(i+"fullscreenOff");this.playerApi.userFullscreen_js(0)},getCurrentTime:function(){var e=this,t;t=e.playerApi.getCurrentTime_js();return t},getDuration:function(){var e=this,t;t=e.playerApi.getDuration_js();return t},isLive:function(){var e=this,t=e.playerApi.getIsLive_js();return t},detach:function(){var e=this;if(!!e.playerApi){b("stop flash player");e.stop()}},isReady:function(){var e=this,t=p();return t&&e.playerReady}});return y}();var it=function(){var t="html5";var i="[HI5] ";var a=false;var n=false;var r=false;var s=false;var o="click.hi5Player";var l;var u=function(e){l=e};var d=function(){var e=nt.video.els.$imaAdDiv,t;if(e){t=e.find("video");if(!t||t.length<1){t=undefined}}return t};var f={isAd:false,profile:"prog",startTime:0,endTime:-1,mapp:"Hi5",contentVO:{chapterStartTimes:[],assetURLs:[]}};var c,v=function(e){c=e},p=function(){return c};var y={onPlayerLoaded_cbsi:function(){var e=nt.getVideoUi(),a=nt.getVideoContainer(t),n=a.find("video"),r=e.videoJSON;if(!e||!r){return}n.removeAttr("controls");b(i+"PLAYER LOADED =====>\n",n)},onPlayerDataLoaded_cbsi:function(){b(i+"PLAYER DATA LOADED =====>")},onPlaylistStart_cbsi:function(){b(i+"PLAYLIST START =====>")},onPlayListEnd_cbsi:function(){b(i+"PLAYLIST END =====>");nt.playlistEnd(t)},onContentStart_cbsi:function(){b(i+"CONTENT START =====>");nt.contentStart()},onContentEnd_cbsi:function(){b(i+"CONTENT END =====>");nt.contentEnd(t)},onAdSlotStart_cbsi:function(){b(i+"AD SLOT START =====>")},onAdStart_cbsi:function(){b(i+"AD START =====>");s=false;nt.adStart()},onAdEnd_cbsi:function(){b(i+"AD END =====>");nt.adEnd();T.setContentLoading(true);c.showIMAadAndEventCatcherDivs(false)},onVideoProgress:function(e){if(true===nt.isAdPlaying()||true===nt.isContentStarted()){T.setContentLoading(false)}nt.videoProgress({currentTime:e.getCurrentTime(),duration:e.getDuration()})},onVideoDone:function(){b(i+"VIDEO DONE =====>")},onNoAdContent:function(){b(i+"NO AD CONTENT =====>")}};var g={jsReady:false,setJSReady:function(){this.jsReady=true},isJSReady:function(){return this.jsReady},onCBSIPlayerReady:function(e){var t;if(!e){return}b(i+"onCBSIPlayerReady!");v(e);t=p();$.each(y,function(e,i){t.addEventJSCallback(e,i)});T.setPlayerReady(true);$(document).trigger("cbsiplayer_ready")}};var h=function(){b("hi5 video click > togglePlay");nt.toggleUiPlayPause()};var m=function(){var e=p(),a=nt.video,n,l,d,f,c,v=nt.getVideoContainer(t),y,g,m;if(!!e&&!!v){m=v.find("video");if(m.length<=0){l=v.attr("id");if(r){c=v.parent();n=c.attr("id");if(!n){n=l+"-wrap";c.attr("id",n)}y=a.els.$imaAdDiv;if(y){d=y.attr("id")}g=a.els.$imaAdClickthru;if(g){f=g.attr("id")}}if(d){b(i+"Initialize UVP_IMA >\n- videoDivId: "+l+"\n- containerDivId: "+n+"\n- imaAdDivId: "+d+"\n- imaAdClickthruId: "+f);e.initialize(l,n,d,f)}else{b(i+"Initialize basic UVP > \nvideoDivId: ",l);e.initialize(l)}m=v.find("video");m.attr("poster","/bundles/phoenixsite/images/core/loose/clear.gif");m.on(o,h);if(g){g.on(o,function(){s=true;b(i+"Clicked IMA Ad Clickthru")})}u(m)}}};var S=function(e){var t,i=e.nativeControls||false,a=e.autoHide||false;t={partner:e.partner,nativeControls:i,autoHide:a,uvpc:e.uvpc,loadAnimation:"",logWindow:C};return t};var k=function(t){b("!!!!!!!!!! SETTING GLOBAL uvp_sOpts AS: ",t);e.uvp_sOpts=t};var P=function(e){var t=S(e);k(t)};var T=et({name:"html5Player",logPrefix:i,load:function(t){var s=this,o=t.videoJSON,l=o.uvpHi5,u=o.uvpHi5Ima;if(true===a||true===n){if(true===a){b(i+"already loaded")}else if(true===n){b(i+"already loading")}return}n=true;P(o);$.each(g,function(t,i){if(undefined===e[t]){e[t]=i}});if(t.els.$imaAdDiv&&u){b(i+"Load IMA js");$.ajax({url:u,dataType:"script",error:function(){b(i+"IMA script failed to load")},success:function(){b(i+"IMA script successfully loaded");r=true}})}b(i+"Load hi5 js: "+l);$.ajax({url:l,dataType:"script",beforeSend:function(){b(i+"load start: ",l)},complete:function(){b(i+"load complete");n=false},error:function(){b("error",i+"load failure");s.playerApi=false},success:function(){b(i+"load success");a=true}})},init:function(){var e=this;if(e.isInitialized()){return}m();e.playerApi=p();e.initialized=true},play:function(){var e=this,t=nt.getVideoUi(),a=false,n,r,s,o,l,u;if(!t){return}a=e.isInitialized();if(!a){b(i+"player is not initialized, quitting");return}b(i+"BEG play() =====>");n=p();r=t.videoJSON;s=t.getVideoUrl();if(undefined===s){return}o=$.extend({},f,{partner:r.partner,mediaId:r.id,cmsRefId:r.guid,videoTitle:decodeURIComponent(r.title),assetURL:s});b("- Video Url: ",s);e.setContentLoading(true);u=e.getAdCall();if(undefined===u){b("- load video url");n.loadVideoByUrl(s,o);n.playVideo()}else{l={pre_0:u};b("- loadContentWithAds: ",l);n.loadContentWithAds(l,o)}b(i+"END play() =====>")},pause:function(){var e=this;b(i+"pause video");e.playerApi.pauseVideo();b(i+"paused video")},resume:function(){b(i+"resume video");this.playerApi.playVideo()},replay:function(){b("seek to 0");this.playerApi.seekTo(0);b("replay video");this.playerApi.playVideo()},stop:function(){this.playerApi.stopVideo()},mute:function(){b(i+"fire playerApi.mute()");this.playerApi.mute()},unmute:function(){b(i+"fire playerApi.unMute()");this.playerApi.unMute()},setVolume:function(e){b("setting html volume");this.playerApi.setVolume(e)},seekTo:function(e){this.setContentLoading(true);this.playerApi.seekTo(e)},seekToLive:function(){},getCurrentTime:function(){return this.playerApi.getCurrentTime()},getDuration:function(){return this.playerApi.getDuration()},detach:function(){b(i+"stop player");this.stop()}});return T}();var at=function(){var e="[YT]";var t;var i="<iframe webkitAllowFullScreen mozallowfullscreen allowFullScreen/>";var a="http://www.youtube.com/embed/";var n={wmode:"transparent",autoplay:"1"};var r="https://www.googleapis.com/youtube/v3/videos?part=id&id=",s="&key=",o=".js-vid-youtube";var l=function(e,t,i){var a=t.youtubeID,n=t.youtubeKey,o,u;i=i||{};o=i.error;if(undefined===e){a=null}if(!a){b("error","Invalid youtubeID");if(e&&e.length){e.remove()}if(o){o()}}else{u={url:r+a+s+n,beforeSend:function(){b("Checking youtubeID "+a+" against API")},error:function(a,n){if("error"===n){t.youtubeID=null;l(e,t,i)}},success:function(e){if(e.pageInfo.totalResults>=1){if(i.success){i.success()}}else{u.error(null,"error")}}};$.ajax(u)}};var u=function(e){var t;if(!e){return}t=a+e+"?"+$.param(n,true);b("youtube embed url: ",t);return t};var d=function(){if(undefined===t){t=$(i,{frameborder:"0"})}return t};var f=et({name:"youtubePlayer",logPrefix:e,playerApi:null,load:function(t){var i=this,a=t.els,n=a.$playbackButtons,r,s;i.setPlayerReady(false);if(n){r=n.filter(o)}if(r.length){s={error:function(){var a=ft(n);b(e+"youtubeCheck error");t.setPlayback(a.data(rt));i.setPlayerReady(true)},success:function(){b(e+"youtubeCheck success");i.setPlayerReady(true)}};l(r,t.videoJSON,s)}},play:function(){var t=nt.getVideoContainer("youtube"),i=d(),a=nt.getVideoUi(),n,r;if(a&&a.videoJSON){r=a.videoJSON.youtubeID}if(!r){return}b(this.name+" > play");b(e+"play() > videoId: "+r);n=u(r);b(e+"play() > embedUrl: "+n);i.attr("src",n);t.append(i);nt.contentStart()},detach:function(){var e=d();e.attr("src","").detach()},isContentLoading:function(){return true}});return f}();var nt=function(){var e="[SWITCH] ";var t={flash:tt,html5:it,youtube:at};b(e+"playerTypes: ",t);var i=false;var a=function(e,t){var i=false;if(!!e){i=e.videoJSON.id===t.videoJSON.id}return i};var n=function(){var e="[RELAY] ";var t={};var i=[],a=[];var n="pause",s="play",o="resume",l="stop",u="mute",d="unmute";var f=[s,l];var c=function(e){return 0<=$.inArray(e,f)};var v;var p=function(e){v=e};var y=function(){return r.player};var g=function(t,i){var a=y();if(!a){b(e+"runPlayerMethod() failed :: undefined player");return}try{b(e+"runPlayerMethod() >\n- methodName: "+t+"\n- methodArgs: ",i);if(!!i&&i.length>0){a[t](i)}else{a[t]()}}catch(n){b("error",e+"runPlayerMethod(): ",n.message)}};var h=function(t){var n,r=e+"Use ";if(c(t)){r+="preContentReadyQueue";n=i}else{r+="contentReadyQueue";n=a}r+=" for ["+t+"]";return n};var m=function(){return 0<i.length||0<a.length};var S=function(i){var a=h(i),n=$.inArray(i,a),r=false;if(n>=0){a.splice(n,1);if(t[i]){delete t[i]}b(e+"removeQueueMethod() methodName removed: ",i);r=true}return r};var k=function(){var i=Array.prototype.slice.call(arguments),a=i.shift(),r,l=false,f;if(a.length===0){return}r=a.shift(a);f=h(r);b(e+"BEG queuePlayerMethod() queued methods: ",f.join(", "));switch(r){case s:S(o);S(n);break;case o:S(n);l=true;break;case n:S(o);break;case u:S(d);break;case d:S(u);l=true;break}S(r);if(false===l){f.push(r);if(a.length>0){t[r]=a}b(e+"queuePlayerMethod() new queued method: ",r)}b(e+"END queuePlayerMethod() queued methods: ",f.join(", "))};var P=function(){var n=y(),r=i.length,s=a.length,o=0,l,u,d;if(!n){b(e+"runQueue() failed :: undefined player");return}if(r>0){o=r;l=i}else if(s>0){if(n.isContentLoading()){b(e+"runQueue() prevented :: content is still loading");return}else{o=s;l=a}}b(e+"BEG runQueue() >\n- preContentReadyQueueLength: "+r+"\n- contentReadyQueueLength: "+s+"\n- queueLength: "+o+"\n- queueToRun: ",l);if(o>0){while(o>0){u=l.shift();d=t[u];o=l.length;g(u,d)}}b(e+"END runQueue()")};var C={setPlayer:function(e){p(e)},run:function(){var t=y(),i=Array.prototype.slice.call(arguments),a=0<i.length,n=false,r,s,o;if(!t){return}b(e+"BEG run() >\n- arguments: ",arguments);if(!t.isInitialized()){b(e+"player.init()");t.init()}o=t.isReady();b(e+"run() >\nisReady: "+o+"\nhasQueuedMethods: "+m()+"\nhasArguments: "+a);if(true===o&&false===m()&&true===a){r=i.shift();s=i;b(e+"Player API is ready without any queued methods");if(c(r)||!t.isContentLoading()){b(e+"Running ["+r+"] player method.");g(r,s);n=true}else{b(e+"Restore args with ["+r+"] for queuing.");i.unshift(r)}}if(!n){if(true===a){b(e+"Queuing player method: ",i);k(i)}b(e+"player API is"+(o?"":" not")+" ready, "+(o?"":" don't ")+"run the queue");b(e+"isReady: "+o);if(true===o){P()}}b(e+"END run()")},clear:function(){i=[];a=[];t={}},hasQueuedMethods:function(){return m()}};return C}();var r={player:null,video:null,states:{},loadPlayerTypes:function(a,n){if(true===i||!a||a.length<1){return}var r,s,o;b(e+"Load Player Types: ",a);for(r=0;r<a.length;r++){s=a[r];o=t[s];if(!!o&&!!o.load){o.load(n)}}i=true},isPlaying:function(){var e=this.video,t=false;if(!!e){t=e.states.playing}return t},getPlayer:function(i){var a=this,n=i.states,r=n.playerType,s=t[r],o,l=false,u=false;b(e+"getPlayer() playerType: "+r);if(undefined===s){b("error",e+"Undefined player type ["+r+"]")}o=a.player||{};u=!!o.name;if(o.name!==s.name){l=true}if(true===l){b(e+"newPlayer: ",s.name);b(e+"currentPlayer: ",o.name);if(true===u){b(e+"Switch to ["+r+"] player");a.setPlayer(o,s)}else{a.player=s;b(e+"new player: ",s)}}else{b(e+"player is ["+r+"]")}},setPlayer:function(i,a){var n=this;if(n.video){var r=n.video.states,s=r.playerType,o=t[s];b(e+"setPlayer()");b(e+"currentPlayer: ",i);b(e+"newPlayer: ",a);if(!i){i=n.player;b(e+"Using self.player as currentPlayer: ",i)}if(!a){a=o;b(e+"Using playerTypes[playerType] as newPlayer: ",a)}if(a){if(i){b(e+"UNSET CURRENT PLAYER");i.detach()}b(e+"SET NEW PLAYER");n.player=a;b(e+"Updated player to ["+a.name+"]")}return true}return false},changePlayerState:function(t,i){var n=this,r=n.video,s=n.states,o=t.states,l=true,u,d,f=0,c={},v=false;if(false===a(r,t)){v=true;if(false===o.playing){l=false}}if(false===l){return}b(e+"!!!!! CHANGE PLAYER STATE !!!!!\n",t.states);if(!i){i=[]}else{b(e+"forcing state updates for: "+i.join(", "))}for(u in o){if(o.hasOwnProperty(u)){d=o[u];if(d!==s[u]||0<=$.inArray(u,i)){f+=1;c[u]=d}}}if(c.playerType){b(e+"changedStates.playerType > getPlayer");n.getPlayer(t)}if(c.volume){b(e+"changedStates.volume > setVolume");n.setVolume(c.volume)}if(c.mute===true){b(e+"changedStates.mute > mute");n.mute()}else if(c.mute===false){b(e+"changedStates.mute > unmute");n.unmute()}if(0<f){b("changedStates: ",c);$.extend(n.states,o)}},play:function(e){var t=this,i=t.video||{},a,r=false,s;b("playerManager.play()");if(!e){b("error","playerManager.play() > undefined video")}if(null===t.player){b("playerManager.play() > BEFORE get player");t.getPlayer(e);b("playerManager.play() > AFTER get player")}s=t.player;t.video=e;e.setVideoProgress("","0%");if(i.playerId!==e.playerId){r=true}n.run("play");b("playerManager.play() > update states: ",a);t.changePlayerState(e,["volume","mute"])},pause:function(){n.run("pause")},resume:function(){n.run("resume")},replay:function(){n.run("replay")},mute:function(){n.run("mute")},unmute:function(){n.run("unmute")},setVolume:function(e){n.run("setVolume",e)},seekTo:function(e){n.run("seekTo",e)},seekToLive:function(){n.run("seekToLive")},onPlayerReady:function(){if(n.hasQueuedMethods()){n.run()}},getCurrentTime:function(){var e=this.player,t=0;if(!!e){t=e.getCurrentTime()}return t},getDuration:function(){var e=this.player,t;if(!!e){t=e.getDuration()}return t},savePosition:function(e){var t=this.video;if(!!t&&!!t.savePosition){t.savePosition(e)}},getVideoUi:function(){return this.video},getVideoContainer:function(e,t){var i=this,a;if(!t){t=i.video}if(t){a=t.getVideoContainer(e);return a}else{b("error","unable to run getVideoContainer on undefined video")}},isAdPlaying:function(){var e=this,t=false;if(e.video&&e.video.states){t=!!e.video.states.adPlaying}return t},isContentStarted:function(){var e=this,t=false;if(e.video&&e.video.states){t=!!e.video.states.contentStarted}return t},isActivePlayerType:function(e){var t=this,i=t.video,a=false,n;if(i){n=i.states;a=e===n.playerType}return a},adEnd:function(){var e=this;if(e.video){e.video.adEnd()}},adStart:function(){var e=this;if(e.video){e.video.adStart()}},contentEnd:function(t){var i=this;if(i.isActivePlayerType(t)){i.video.contentEnd()}else{b(e+"contentEnd ignored :: playerType is not active")}},contentLoading:function(e){var t=this;if(t.video){t.video.contentLoading(e)}},contentStart:function(){var e=this;if(e.video){e.video.contentStart()}},playlistEnd:function(t){var i=this;if(i.isActivePlayerType(t)){i.video.playlistEnd()}else{b(e+"playlistEnd ignored :: playerType is not active")}},toggleUiPlayPause:function(){var t=this,i;if(t.video){b(e+"play/pause from player api");i=t.video.els.$playPauseButtons;i.first().trigger("click")}},videoProgress:function(e){var t=this;if(t.video){t.video.videoProgress(e)}}};return r}();var rt="cmd-value",st="dn",ot="on";var lt=function(e){return!!e&&e.length>0&&e.closest("html").length>0&&!e.hasClass(st)};var ut=function(e){return!!e&&e.hasClass(ot)};var dt=function(e,t){return e.data(rt)===t};var ft=function(e){var t=e.filter(".js-vid-default"),i;t=t.not("."+st);i=t.first();if(i.length<1||i.closest("body").length<1){i=e.first()}return i};var ct=function(e,t){var i=e.filter(function(){var e=$(this);return true===lt(e)&&true===dt(e,t)});return i};var vt=function(e,t,i){if(!e||0===e.length){return}if(true===t){e.addClass(i)}else if(false===t){e.removeClass(i)}};var pt=function(e){ht(e);vt(e,true,st)};var yt=function(e){vt(e,false,st)};var gt=function(e){vt(e,true,ot)};var ht=function(e){vt(e,false,ot)};var mt=function(){var e="[UI CORE] ";var t={$videoPlayerDiv:null,$videoContainer:{selector:".js-vid-player-holder"},$playerChrome:{selector:".js-vid-player-chrome"},$ageGate:{selector:".js-vid-age-gate"},$ageMonth:{selector:".js-vid-age-gate-month"},$ageDay:{selector:".js-vid-age-gate-day"},$ageYear:{selector:".js-vid-age-gate-year"},$ageDate:{selector:".js-vid-age-gate-date"},$playPauseButtons:{selector:".js-vid-play, .js-vid-play-pause",events:{click:"togglePlay"}},$qualityButtons:{selector:".js-vid-quality",events:{click:"setQuality"},cookieType:"state",state:"quality"},$timeDisplay:{selector:".js-vid-time"},$kubrickLead:{selector:"#kubrick-lead",unique:true},$countdown:{selector:".js-vid-countdown"},$imaAdDiv:{selector:".js-vid-ima-ad"},$imaAdClickthru:{selector:".js-vid-ima-clickthru"},$volume:{selector:".js-vid-volume"},$volumeBar:{selector:".js-vid-volume-bar",events:{mousedown:"volumeChange","mousedown.volumeSlide":"volumeSlideStart","mouseup.volumeSlide":"volumeSlideStop"}},$volumeHandle:{selector:".js-vid-volume-handle"},$muteButton:{selector:".js-vid-mute",events:{click:"toggleMute"},cookieType:"state",state:"mute"},$fullscreenButton:{selector:".js-vid-fullscreen",events:{click:"toggleFullscreen"}},$fullWinButton:{selector:".js-vid-windowed",events:{click:"toggleWindowed"}},$reportSuckButton:{selector:".js-vid-report-suck-btn",events:{click:"reportSuck"}},$playbackButtons:{selector:".js-vid-playback",events:{click:"setPlayback"},cookieType:"state",state:"playback"},$videoMaxWidth:{selector:".js-vid-max-width"},$seeker:{selector:".js-vid-buffer",cookieType:"position",events:{click:"seekTo",mouseenter:"seekDisplayStart",mouseleave:"seekDisplayStop"}},$seekDisplay:{selector:".js-vid-seek-display"},$seekText:{selector:".js-vid-seek-text"},$seekPointer:{selector:".js-vid-seek-pointer"},$seekToLive:{selector:".js-vid-seektolive",events:{click:"seekToLive"}},$progress:{selector:".js-vid-position"},$loader:{selector:".js-vid-loaded"}};var a={type:"wtfbbq",playerId:null,videoJSON:null,html5Player:false,adMessagePrefix:"This ad ends in: ",els:{},stateJSON:{},states:{videoId:null,playback:null,playerType:null,quality:null,adPlayed:false,contentLoading:false,contentStarted:false,played:false,paused:false,started:false,ended:false,contentEndTimeoutId:null,counting:false,adPlaying:false,gated:false,hasGate:false,showAgeGate:false,loading:true,playing:false,volume:1,embiggened:false,mute:false,share:false,stickied:false,fullscreen:false,windowed:false,currentTime:0,duration:0,hasTimeChange:false,isAtEndTime:false,isLive:false,isOffAir:false,isRewound:false,isSeekDisabled:true,customStartTime:0,restoredFromSavedTime:false,liveStartTime:0,liveSeekDelay:10,liveSeekDelayLeft:null,stowControls:false},classNames:{contentLoading:"is-vid-content-loading",contentStarted:"is-vid-content-started",played:"is-vid-played",started:"is-vid-started",ended:"is-vid-ended",counting:"has-vid-countdown",adPlaying:"is-vid-ad-playing",gated:"has-vid-invalid-age",hasGate:"has-vid-age-gated",showAgeGate:"is-vid-age-gate",disabled:"is-vid-disabled",loading:"is-vid-loading",playing:"is-vid-playing",embiggened:"is-vid-embiggened",mute:"is-vid-muted",share:"has-vid-share",stickied:"is-vid-stickied",fullscreen:"is-vid-fullscreen",windowed:"is-vid-fullscreen",isLive:"is-vid-live",isOffAir:"is-vid-offair",isRewound:"is-vid-rewound",isSeekDisabled:"is-vid-noseek",stowControls:"is-vid-stow-controls"},kubrickClassNames:{played:"video-active",playing:"video-playing"}};a.initialize=function(t){var i=this,a=i.els;b("Player type: "+i.type);i.playerId=t.playerId;i.videoJSON=t.videoJSON;i.states.videoId=t.videoJSON.id;if(!!t.els){$.extend(a,t.els)}if(false===i.isOfAge()){i.gate();return}i.initElements();if(undefined===a.$playerChrome){b(e+"Quitting -- player chrome is missing.");return}i.initStates();i.initComplete()};a.initElements=function(){var e=this,t=e.getUiMap(),i=e.els,a,n,r;for(n in t){if(t.hasOwnProperty(n)){a=undefined;r=t[n];if(!!r){a=e.getUiElement(n,r)}b("UI Elements ["+n+"]: ",!!a?a.length:0);if(undefined!==a){i[n]=a;if(!!r.events){e.addElementEvents(a,r)}}}}e.initCountdown()};a.initStates=function(){};a.initComplete=function(){var t=this,i=t.videoJSON;b(e+"initComplete");if(t.html5Player){$(document).on("cbsiplayer_ready",function(){t.setStates({loading:false})})}else{t.setStates({loading:false})}if(i.startTime){t.setStates({customStartTime:i.startTime,restoredFromSavedTime:i.restoredFromSavedTime?true:false})}};a.getUiMap=function(){return $.extend({},t)};a.getUiElement=function(e,t){var i=this,a=i.els,n=i.playerId,r=t.selector,s="",o;o=a[e];if(undefined===o){if(!!r&&r.indexOf("#")===0&&!t.unique){s=n}if(!!r){if(""!==s){r+=s}if(r.indexOf("#")===0){o=$(r)}else{o=a.$videoPlayerDiv.find(r)}}}if(!o||o.length<1){o=undefined}return o};a.handleUserAction=function(){};a.getEventFunction=function(e,t,i,a){if(!e||e.length<=0||!t){return}var n=this,r,s;if(i){s=n[i]}if(!s){b("Unable to find callback for ["+i+"]");return}if("click"===t){r=function(e){var t=$(this),i=false,r=t.data(rt);f(e);i=s.call(n,r);if(true===i){b("CHANGED!!!\n",n.states);n.handleUserAction(t,a);if(true===n.states.started){b("!!! Change occured during playback !!!");nt.changePlayerState(n)}}}}else{r=function(e){s.call(n,e,$(this).data(rt))}}return r};a.addElementEvents=function(e,t){var i=this,a=t.events,n,r,s,o={},l=false;if(!e||e.length<=0||!a){return}for(n in a){if(a.hasOwnProperty(n)){r=a[n];if(!!r){s=i.getEventFunction(e,n,r,t);if(undefined!==s){o[n]=s;l=true}}}}if(true===l){b("- adding eventsMap: ",o);e.on(o)}};a.initCountdown=function(){var e=this,t=e.videoJSON,i=Date.now(),a=parseInt(t.countdownTime,10)*1e3,n=e.els.$countdown,r=false;if(!n){b("No countdown");return n}b("Initializing countdown");r=!n.data("complete")&&(a>0&&i<a);if(r){n.on("complete",function(){e.els.$videoPlayerDiv.find("iframe").remove();e.setStates({counting:false})});n.on("almostComplete",function(){e.els.$videoPlayerDiv.addClass("countdown-almost-complete")});e.setStates({counting:true})}return n};a.getVideoContainer=function(e){var t=this,i=t.els.$videoContainer,a=i.attr("id");if(!a){i.attr("id","js-vid-"+e+"-player"+t.playerId)}return i};a.togglePlay=function(){var t=this,i=t.states,a=i.playing,n=false;b(e+"togglePlay > states: ",i);if(true===a){n=t.pause()}else if(true===i.started){n=t.resume()}else{n=t.play()}if(true===n){i.playing=!a}return n};var n=function(e){var t=e.watchedCookieName,i;if(!t){return}i=$.parseJSON($.cookie(t));if(!i){i=[]}return i};var r=function(e){var t=e.id,i=e.watchedCookieName,a=e.watchedCookieDays,r=n(e);if(undefined===r){return}if(0>$.inArray(t,r)){r.push(t)}$.cookie(i,c(r),{path:"/",expires:a})};var s=function(t){var i=!!$("#VideoDisableTracking").attr("content"),a=t.id;b(e+"Disable Tracking? ",i);if(i||!a){return}$.ajax({url:"/api/video/played/"+a+"/",type:"GET",success:function(t){if(t.success===0){b(e+"Error logging view")}else if(t.success===1){b(e+"View logged successfully")}}});r(t)};a.play=function(){var t=this,i=t.states,a=t.isAgeGated(),n=false,r=t.videoJSON,o=r["id"];b("[UI] ui.play");if(true===a){t.gate()}else if(false!==a&&"string"===typeof a){if("prompt"===a){t.promptAgeGate()}else{alert(a)}}else{n=true;if(false===i.playing){b(e+"video is not playing > play")}if(false===i.played&&!!o){b(e+"video has not played > log view");
s(r)}if(false===i.started){t.els.$videoPlayerDiv.trigger("videoStart")}if(true===i.ended){t.els.$videoPlayerDiv.trigger("videoReplay")}t.setStates({played:true,playing:true,paused:false,started:true,ended:false});nt.play(t);u().trigger("video_play")}};a.pause=function(){var t=this;t.setStates({paused:true,playing:false});b(e+"Tell playerManager to pause");nt.pause(t);t.els.$videoPlayerDiv.trigger("contentPause");return true};a.resume=function(){var e=this;e.setStates({paused:false,playing:true});nt.resume(e);e.els.$videoPlayerDiv.trigger("contentResume");return true};a.replay=function(){var e=this;e.setStates({playing:true,started:true,ended:false});nt.replay(e)};a.seekToCustomStartTime=function(){var e=this,t=e.states,i=t.customStartTime,a=t.restoredFromSavedTime,n=e.videoJSON,r=n.seekablePlaybacks,s;if(!t.adPlaying&&t.started&&0<i){s=nt.getDuration();if(undefined===s||0===s||true===isNaN(s)){b("wait until we have a legit duration");return}e.setStates({customStartTime:0,restoredFromSavedTime:false});if(0>$.inArray(t.playback,r)){return}if(Math.floor(i)<Math.floor(s)){nt.seekTo(i);if(a){v("Resuming video from saved position")}}}};a.adStart=function(){b(e+"start video ad");var t=this,i=t.states,a=i.paused;t.cancelConfirmContentEnd();t.setStates({adPlayed:true,adPlaying:true,paused:a,playing:!a,started:true,ended:false})};a.adEnd=function(){var t=this;b(e+"end video ad");t.setStates({adPlaying:false})};a.contentStart=function(){var e=this,t=e.states,i=t.paused;e.cancelConfirmContentEnd();e.setStates({adPlaying:false,paused:i,playing:!i,started:true,ended:false,contentStarted:true})};a.contentEnd=function(){var t=this,i=t.states,a={contentStarted:false},n=i.isLive,r=false,s=Math.floor(i.currentTime),o=Math.floor(i.duration),l=Math.abs(o-s);if(1>=l||s>=o){r=true}a.isAtEndTime=r;b(e+"[CONTENT END]");b("- isLive: "+(n?"yes":"no"));b("- isAtEndTime: "+(r?"yes":"no"));if(!n&&r){a.playing=false;a.started=false;a.ended=true;b(e+"We are contentEnd!");t.els.$videoPlayerDiv.trigger("contentEnd")}this.setStates(a);if(i.playing){b(e+"contentEnd was ignored, check again in a second");t.confirmContentEnd()}};a.confirmContentEnd=function(){var t=this,i=4e3,a=t.states,n;t.cancelConfirmContentEnd();if(true===a.isLive){i=1e4}n=setTimeout(function(){b(e+"confirmContentEnd");t.setStates({isLive:false,currentTime:a.duration});t.cancelConfirmContentEnd();t.contentEnd()},i);a.contentEndTimeoutId=n};a.cancelConfirmContentEnd=function(){var t=this.states,i=t.contentEndTimeoutId;if(i){b(e+"clear confirmContentEnd timeout");clearTimeout(i);t.contentEndTimeoutId=null}};a.playlistEnd=function(){this.setStates({contentStarted:false,playing:false,started:false,ended:true})};var o=[],l=4,g=true,h=function(e){o.push(e);if(o.length===l){if(o[0]===o[l-1]){g=false}else{g=true}o=o.slice(l-1)}return g};a.liveStreamCheck=function(e){var t=this,i=t.states,a=false,n=false,r=false,s=e.currentTime,o=e.duration,l=i.liveSeekDelay,u=i.liveSeekDelayLeft,d,f;if(!t.videoJSON.isLiveStream){return}if(i.duration===0){return}if(i.currentTime===s){return}d=h(o);if(u===null){i.liveStartTime=s}if(u!==false){f=i.liveStartTime;u=l-s+f}if(u>0){i.liveSeekDelayLeft=u;e.isSeekDisabled=true;return}else if(false!==i.liveSeekDelayLeft){i.liveSeekDelayLeft=false;e.isSeekDisabled=false}if(true===d){if(s<o-2){r=true}else{n=true}}else{a=true}if(i.isOffAir!==a){e.isOffAir=a}if(i.isLive!==n){e.isLive=n}if(i.isRewound!==r){e.isRewound=r}};a.coreVideoProgress=function(e){var t=this,i=t.states,a=false;t.cancelConfirmContentEnd();if(false===i.adPlaying){if(true===t.videoJSON.isLiveStream){t.liveStreamCheck(e)}else{if(false!==i.isSeekDisabled){e.isSeekDisabled=false}if(t.states.customStartTime){t.seekToCustomStartTime()}}if(Math.floor(e.currentTime)!==Math.floor(t.states.currentTime)){a=true}e.hasTimeChange=a;t.setStates(e);if(a){t.els.$videoPlayerDiv.trigger("contentProgress",i)}}};a.getCuePoints=function(){var e=this,t=e.videoJSON,i;i=t.cuePoints;return i};a.getVideoUrl=function(){var t=this,i=t.states.quality,a=t.videoJSON,n;n=a.videoStreams[i];b(e+"getVideoUrl() =====>"+n);if(!n){b("error",e+"Playback quality unavailable: ",i)}return n};a.setStates=function(t){var i=this,a=i.els.$videoPlayerDiv,n=i.classNames,r=[],s=[],o=i.els.$kubrickLead,l=i.kubrickClassNames,u=[],d=[],f,c;$.each(t,function(e,t){f=n[e];if(e==="playerType"&&t!==i.states[e]){f="is-vid-"+t+"-player";if(i.states[e]){c="is-vid-"+i.states[e]+"-player";if(c){s.push(c)}}t=true}if(undefined!==f){if(true===t){r.push(f)}else{s.push(f)}}if(o){f=l[e];if(undefined!==f){if(true===t){u.push(f)}else{d.push(f)}}}});$.extend(i.states,t);a.data("states",i.states);if(r.length>0){r=r.join(" ");b(e+"setStates addClass: ",r);a.addClass(r)}if(s.length>0){s=s.join(" ");b(e+"setStates removeClass: ",s);a.removeClass(s)}if(u.length>0){u=u.join(" ");b(e+"setStates $kubrickLead.addClass: ",u);o.addClass(u)}if(d.length>0){d=d.join(" ");b(e+"setStates $kubrickLead.removeClass: ",d);o.removeClass(d)}};a.setControl=function(t,i){var a=false,n;n=ct(t,i);if(n.length>0&&false===ut(n)){b(e+"New Value Control for ["+i+"]: ",n);a=true;gt(n);ht(t.not(n))}return a};a.setQuality=function(t,i){var a=this,n=a.states,r=a.els.$qualityButtons,s=a.setControl(r,t);if(true===s){b(e+"setQuality newValue: "+t);n.quality=t;if(n.started&&!i){a.play()}}return s};a.setVideoProgress=function(){};a.contentLoading=function(e){this.setStates({contentLoading:e})};(function(){a.isOfAge=function(e){var t=this.videoJSON,i=t.contentRating,a;if(!i){a=true}else{if(!e){e=$.cookie(t.ageGateCookieName)}if(e){var n=new Date,r=e.split("-"),s,o;try{s=new Date(r[0],r[1],r[2]);if(isNaN(s.getTime())){s=n}}catch(l){s=n}o=Math.floor((n-s)/31536e6);if(o>=i){a=true}else{a=false}}}return a};a.hasAgeGate=function(){var e=this,t=e.els.$ageGate,i=e.videoJSON,a=i.contentRating,n=true;if(!t||!a||true===e.isOfAge()){b("[AGE GATE] not gated");n=false}else{b("[AGE GATE] gated")}return n};a.promptAgeGate=function(){this.setStates({showAgeGate:true})};a.isAgeGated=function(){var e=this,t=e.els,i=t.$ageGate,a=t.$ageYear,n=e.videoJSON,r=n.ageGateCookieName,s,o,l,u,d=false;b("[AGE GATE] Checking...");if(true===e.hasAgeGate()){if(false===e.isOfAge()){d=true}else if(false===e.states.showAgeGate){d="prompt"}else{u=a.val();b("[AGE GATE] Year selected: "+u);if("year"===u){b("warning","[AGE GATE] missing year value");d="Please select a year value to validate your age!"}else{l=t.$ageMonth.val();o=t.$ageDay.val();s=[u,l,o].join("-");if(!!r){$.cookie(r,s,{path:"/",expires:2e3})}if(!e.isOfAge(s)){b("[AGE GATE] User is not old enough");d=true}}}}if(false===d){b("[AGE GATE] User is old enough");e.setStates({hasGate:false,showAgeGate:false});if(!!i&&i.length>0){i.remove();delete t.$ageGate}}return d};a.gate=function(){var e=this,t=e.els,a=t.$videoPlayerDiv;e.setStates({disabled:true,gated:true});t.$playerChrome.remove();a.off(i)}})();a.toggleState=function(t){var i=this,a=false,n=i.stateJSON,r=i.getStateKey(t),s,o;switch(t){case"embiggen":o=i.setEmbiggen;break;case"mute":o=i.setMute;break;case"sticky":o=i.setSticky;break}if(!!o){s=n[r];b(e+"toggleState stateJSON stateValue: ",s);if(undefined===s){s=true}else{s=!s}a=o.call(i,s);b(e+"Toggle "+t+": ",s)}return a};(function(){var t="body-fullscreen",n="body-fauxscreen",r="keyup"+i,s=27;a.isFullscreen=function(){var e=this,t=e.states;return true===t.windowed||true===t.fullscreen};a.exitFullscreen=function(){var t=this,i=u();if(t.isFullscreen()){b(e+"exit full screen");i.off(r);t.setStowControls(false);t.setFullscreen(false);t.setWindowed(false)}};a.enterFullscreen=function(t){var i=this,a=u(),n=function(t){b(e+"exit fullscreen callback");if(t.keyCode===s){i.exitFullscreen()}};if(false===i.isFullscreen()){i.setStowControls(true);switch(t){case"fullscreen":i.setFullscreen(true);break;case"windowed":b(e+"attach esc from fullscreen event listener");a.on(r,n);i.setWindowed(true);break}}};a.setFullscreen=function(i){var a=false,n=this,r=n.els.$videoPlayerDiv[0],s=n.states.fullscreen||false,o=d(),l=function(){b(e+"[FULLSCREEN CHANGE HANDLER]");if(false===screenfull.isFullscreen){b(e+"screenfull.isFullscreen is false, exit");n.exitFullscreen(false);screenfull.onchange=function(){};b(e+"[FULLSCREEN EXIT] adjustWidth");n.adjustWidth()}};b(e+"ui.setFullscreen newState: ",i);b(e+"- documentContentRoots: ",o);if(!screenfull){return n.setWindowed(i,true)}if(s!==i){a=true;n.setWindowed(false);if(true===i){screenfull.onchange=l;screenfull.request(r);o.addClass(t)}else{o.removeClass(t);screenfull.exit()}n.setStates({fullscreen:i})}return a};a.setWindowed=function(t,i){var a=false,r=this,s=r.states.windowed||false,o=d();if(s!==t){a=true;if(!!screenfull){r.setFullscreen(false)}if(true===t){o.addClass(n)}else{o.removeClass(n)}if(!i){b(e+"ui.setWindowed adjustWidth");r.adjustWidth()}r.setStates({windowed:t})}return a};a.toggleFullscreen=function(){var e=this;if(true===e.isFullscreen()){e.exitFullscreen()}else{e.enterFullscreen("fullscreen")}};a.toggleWindowed=function(){var e=this,t=!e.states.windowed;if(true===t){e.enterFullscreen("windowed")}else{e.exitFullscreen()}};a.reportSuck=function(){var e=this;event.preventDefault();if(!confirm("This will send us a report that we will use to diagnose video playback issues. Are you sure you want to send us a report?\r\rPLEASE only do this if the video quality is bad or the video is broken in some way.\r\rAbusers will get banned.")){return}var t=e.els.$reportSuckButton;AjaxApiRequest.makeGetApiRequest("/videos/report/suck",{uniqueKey:t.data("unique-key"),videoId:t.data("video-id")},function(e){if(e.success){alert("Thanks, we're sorry you're having problems. This report will help us fix them. Please only send one report per video")}})}})();(function(){var t="mouseleave.volumeSlide",i="mousemove.volumeSlide";a.setVolume=function(t){var i=this,a=i.els,n=a.$volumeHandle;b(e+"setVolume: ",t);b(e+"states: ",i.states);i.moveVolumeHandle(t);n.data(rt,t);if(0>=t){i.setMute(true)}else if(true===i.states.mute){b(e+"setVolume states muted > unmute");i.setMute(false)}i.saveState("volume",t);i.setStates({volume:t});nt.changePlayerState(i);if(true===i.states.playing){nt.setVolume(t)}};a.setMute=function(t){var i=false,a=this,n=a.els,r=n.$muteButton,s=n.$volumeHandle,o=r.data(rt)||false,l=s.data(rt);if(o!==t){i=true;b(e+"setMute > hasChange!");if(true===t){l=0}else{if(l===0||l==="0.00"){b(e+"setMute > volume is 0, do not unmute");return}}a.moveVolumeHandle(l);r.data(rt,t);a.setStates({mute:t});a.saveState("mute",t);if(true===a.states.playing){if(true===t){nt.mute()}else{nt.unmute()}}}return i};a.toggleMute=function(){b(e+"toggle mute!");return this.toggleState("mute")};a.moveVolumeHandle=function(e){e=Math.round(e*100).toString()+"%";this.els.$volumeHandle.css("left",e)};a.volumeChange=function(e){var t=this,i=t.els.$volumeBar,a=p(e,i);t.setVolume(a.toFixed(2))};a.volumeSlideStart=function(){var e=this,a=e.els;a.$volume.on(t,function(){e.volumeSlideStop()});a.$volumeBar.on(i,function(t){e.volumeChange(t)})};a.volumeSlideStop=function(){var e=this.els;e.$volume.off(t);e.$volumeBar.off(i)}})();a.setStowControls=function(){};(function(){var t=["sticky","embiggen"];var i="frontdoor",n="frontDoor";var r=function(e,t){return e+t.slice(0,1).toUpperCase()+t.slice(1)};var s=function(){return location.pathname==="/"};a.getStateKey=function(e){if(0<=$.inArray(e,t)&&true===s()){e=r(i,e)}return e};var o=function(t,a){var r=a[t],s=false,o=false;b(e+"[CHECK SAVED STATE] "+t+" is "+r);if(undefined!==r&&("sticky"===t||0<t.indexOf("Sticky"))){o=playerUiMap_Desktop.$stickyPinButton.cookieType!==undefined;if(!o){r=""}}if(0===t.indexOf(n)){delete a[t];t=t.replace(n,i)}if(""===r){delete a[t];r=undefined;s=true}else if(!(undefined===r||true===r)){r=true;s=true}if(true===s&&undefined!==r){a[t]=r}if(s){b(e+"[CORRECTED STATE] "+t+" as "+r)}return s};var l=function(a){var s=false;b(e+"[CHECK SAVE STATES] original states: \n"+c(a));b(e+"states to check: ",t);$.each(t,function(e,t){s=o(t,a)||s;s=o(r(n,t),a)||s;s=o(r(i,t),a)||s});if(a.playback==="html5Progressive"){a.playback="html5";s=true}b(e+"[CHECK SAVE STATES] corrected states: \n"+c(a));b(e+" hasInvalidSavedStates: ",s);return s};var u="__gamesVideoPlayer";var d=function(t){var i=c(t);b(e+"Save state cookie value: "+i);$.cookie(u,i,{path:"/",expires:30})};a.loadSavedState=function(){var t=this,i=$.cookie(u),a,n,r,s=null,o,f,c,v;if(i){a=$.parseJSON(i)}if(undefined===a){return}v=l(a);if(v){d(a);v=false}n=a.playback;if(!!n){r=t.playbacks[n]||{};s=!!r.isAvailable;if(s){c=r.qualities}}f=a.quality;if(undefined===c){o=ft(t.els.$playbackButtons);n=o.data(rt);r=t.playbacks[n];c=r.qualities;if(!!a.playback){if(null===s){v=true;delete a.playback}}}if(f&&0>$.inArray(f,c)){v=true;delete a.quality}if(v){d(a)}t.stateJSON=$.extend({},a);b(e+"[LOADED SAVED STATES]:",a)};a.saveState=function(t,i){var a=this,n=a.getStateKey(t),r=a.stateJSON;if(!i){b(e+"Delete state for: "+n);delete r[n]}else{r[n]=i}d(r)}})();a.adjustWidth=function(){b(e+"========== BEG ui.adjustWidth ==========");var t=this,i=t.els,a=i.$videoPlayerDiv,n=i.$videoMaxWidth,r=i.$videoContainer,s=16/9,o="100%",l="width",u,d;n.css(l,o);u=a.height();d=r.height();b(e+"viewport height: ",u);b(e+"player height: ",d);if(u<d){o=s*u}b(e+"adjust max width to: ",o);b(e+"maxWidth.css(width): ",n.css(l));n.css(l,o);b(e+"========== END ui.adjustWidth ==========")};a.videoProgress=function(e){var t=this,i=t.states,a=i.adPlaying,n=i.contentStarted,r=t.videoJSON.isLiveStream,s=y(0),o=s,l=s,u="",d,f,c,v,p,g,h,m;mt.coreVideoProgress.call(t,e);if(!e.hasTimeChange){return}d=Math.floor(e.currentTime);f=Math.floor(e.duration);c=e.bytesLoaded||0;v=e.bytesTotal||0;p=i.isLive;g=i.isOffAir;h=i.isRewound;if(true===a){u=t.adMessagePrefix+P(f-d)}else if(true===n){u=P(d);o=y(d/f);if(0<=c&&0<v){l=y(c/v)}if(!p){u+=" / "+P(f)}if(true===r){if(!p&&!g&&!h){u="Loading stream data";for(m=0;m<=(d+1)%3;m++){u+="."}o=s}if(p){o=y(1)}}}t.setVideoProgress(u,o,l)};a.setVideoProgress=function(e,t,i){var a=this.els,n=a.$timeDisplay,r=a.$progress,s=a.$loader,o,l,u;if(!!n){o=n.data("progress-msg");if(o!==e){n.html(e);n.data("progress-msg",e)}}if(undefined!==t&&!!r){l=r.data("width");if(l!==t){r.css("width",t);r.data("width",t)}}if(!!i&&!!s){u=s.data("width");if(u!==i){s.css("width",i);s.data("width",i)}}};var m="mousemove.seekDisplay",S="left",k="position";var C=function(e,t){var i,a=0;i=e.offset();i.right=i.left+e.outerWidth();if(i.left<t.left){a=t.left-i.left}else if(i.right>t.right){a=t.right-i.right}return a};var T=function(e,t){var i,a;e.css("left","-50%");i=e.position();a=C(e,t);if(a!==0){e.css(S,i.left+a)}};var A=function(e,t){var i=e.data(k),a=e.data("limitClass"),n,r,s={},o={};if(undefined===i){i=e.position();i.width=e.outerWidth();e.data(k,i)}s={left:i.left,width:i.width};e.css(s);if(!!a){e.removeClass(a)}n=C(e,t);if(n>0){r="left"}else if(n<0){r="right"}if(n!==0){o["width"]=i.width-Math.abs(n);if(n>0){o["left"]=i.left+n}a="limit-"+r;e.addClass(a);e.data("limitClass",a);e.css(o)}};a.seekTo=function(){var t=this,i=t.states,a=t.seekTime,n=false;if(true===i.started&&false===i.adPlaying){b(e+"seekTo: ",a);n=true;nt.seekTo(a);t.els.$videoPlayerDiv.trigger("contentSeek",[a])}else{n=true;t.setStates({customStartTime:a,restoredFromSavedTime:true})}if(false===i.playing){b(e+"not playing, so don't let seekto play");nt.pause();t.videoProgress({currentTime:a,duration:nt.getDuration()})}t.seekTime=0;return n};a.seekToLive=function(){var t=this,i=t.states,a=false;if(true===i.started&&false===i.adPlaying){b(e+"seekToLive()");a=true;nt.seekToLive();if(false===i.playing){b(e+"not playing, so don't let seekToLive play");nt.pause();t.videoProgress({currentTime:nt.getDuration(),duration:nt.getDuration()})}}return a};a.updateSeekDisplay=function(e,t){var i=this,a=i.els,n=a.$videoPlayerDiv,r=a.$seekText,s=a.$seekPointer,o;if(!e){e="loading..."}r.text(e);a.$seekDisplay.css(S,t);o=n.offset();o.right=o.left+n.width();T(r,o);A(s,o)};a.setSeekDisplay=function(e){var t=this,i=t.els,a=i.$seekText,n=p(e,i.$seeker),r=nt.getDuration(),s=0,o=0,l="";if(undefined===r){r=0}if(0<=n&&0<r){s=Math.round(n*r);l=P(s);o=y(s/r)}if(s!==t.seekTime||l!==a.text()){t.seekTime=s;t.updateSeekDisplay(l,o)}};a.seekDisplayStart=function(){var e=this,t=e.states;if(true===t.started&&false===t.adPlaying){e.els.$seeker.on(m,function(t){e.setSeekDisplay(t)})}};a.seekDisplayStop=function(){this.els.$seeker.off(m)};return a}();var St=function(){var e="[UI MOBILE] ";var t={$deviceAdMessage:{selector:".js-vid-ad-message"}};var i={type:"mobile",states:{playback:"html5",playerType:"html5",quality:null}};i=$.extend(true,{},mt,i);i.initialize=function(e){var t=e.videoJSON;$.extend(t,{nativeControls:false,autoHide:true});mt.initialize.call(this,e)};i.initStates=function(){var t=this,i=ft(t.els.$qualityButtons),a=i.data(rt);b(e+"initStates");t.setQuality(a)};i.initComplete=function(){var e=this;nt.loadPlayerTypes([e.states.playerType],e);if(e.states.playerType==="html5"){e.html5Player=true}mt.initComplete.call(e)};i.getUiMap=function(){var e=$.extend(true,mt.getUiMap(),t);return e};return i}();var kt=function(){var e="[UI DESKTOP] ";var t={$videoPlayerDiv:{events:{keydown:"spacebarToggle",selectstart:"stopSelect"}},$avBox:{selector:".js-vid-box"},$kubrickLead:{external:true,parentOf:"$videoPlayerDiv"},$kubrickInfo:{selector:".kubrick-info",external:true,childOf:"$kubrickLead"},$kubrickInfoParent:{selector:".row",external:true,childOf:"$kubrickLead"},$kubrickRelated:{selector:"#js-kubrick-pod",external:true,childOf:"$kubrickLead"},$embiggenContainer:{selector:".js-video-embiggen",external:true,parentOf:"$videoPlayerDiv"},$embiggenVidSize:{selector:".js-video-size",external:true,parentOf:"$videoPlayerDiv"},$stickyContainer:{selector:".js-video-sticky",external:true,parentOf:"$videoPlayerDiv"},$videoSpacer:{selector:"#video-spacer",external:true,dependsOn:"$kubrickLead"},$embiggenButtonContainer:{selector:".js-vid-embiggen-wrap",dependsOn:"$embiggenVidSize"},$embiggenButton:{selector:".js-vid-embiggen",events:{click:"toggleEmbiggen"},cookieType:"state",state:"embiggen",dependsOn:"$embiggenVidSize"},$stickyPinButtonContainer:{selector:".js-vid-pin-wrap",dependsOn:"$stickyContainer"},$stickyPinButton:{selector:".js-vid-pin",events:{click:"toggleSticky"},state:"sticky",dependsOn:"$stickyContainer"},$shareButton:{selector:".js-vid-share",events:{click:"toggleShare"}},$shareModal:{selector:".js-vid-modal-share",ui:{sizes:".js-vid-share-sizes",markup:".js-vid-share-size-markup"}}};var a={state:"saveState",position:"savePosition"};var n={type:"desktop",seekTime:0,playbacks:null};n=$.extend(true,{},mt,n);n.initStates=function(){var t=this,i;i=t.initPlaybackQualities();b(e+"hasPlaybacks? ",i);if(!i){b(e+"no playbacks");return}t.loadSavedState()};n.initPlaybackQualities=function(){var t=this,i=t.els.$playbackButtons,a=t.els.$qualityButtons,n={},r={},s,o=false,l=[];if(a){b(e+"$qualities: ",a);a.each(function(){var e=$(this),t=e.data(rt);r[t]=this})}else{b("error",e+"No qualities defined!");i=undefined}if(!!i){i.each(function(){var i=$(this),a=i.data(rt),o=lt(i),u=i.data("qualities").split(","),d=[],f,c=[],v;for(s=0;s<u.length;s++){f=r[u[s]];if(undefined!==f){c.push(f);d.push(u[s])}}v=i.data("player");if(v==="html5"){t.html5Player=true}if(0>$.inArray(v,l)){l.push(v)}n[a]={isAvailable:o,playerType:v,qualities:d,$button:i,$qualities:$(c)};b(e+"Playback Quality Elements for ["+a+"]: ",n[a])});if(l.length>0){t.playbacks=n;o=true;nt.loadPlayerTypes(l,t)}}return o};n.initShareModal=function(){var i=this,a=i.els.$shareModal,n=t.$shareModal.ui,r,s,o={},l;if(!a){return}r=a.find(n.sizes);s=a.find(n.markup);l=s.data("size");b(e+"===== BEG ui.initShareModal =====>");b(e+"Default share size is: ",l);s.each(function(){var e=$(this);o[e.data("size")]=e});yt(o[l]);r.on("change",function(){var e=this,t=$(e),i=t.data("size")||l,a=e[e.selectedIndex].value||l;if(i!==a){t.data("size",a);pt(o[i]);yt(o[a])}});b(e+"===== END ui.initShareModal =====>")};n.initComplete=function(){var t=this,i=t.stateJSON,a=i.playback,n=i[t.getStateKey("sticky")],r=i[t.getStateKey("embiggen")],s=i["volume"],o=i["mute"],u=l(),d=t.els,f=d.$playbackButtons,c;t.initShareModal();c=ct(f,a);if(0===c.length){b(e+"invalid playback ["+a+"]");a=undefined}if(undefined===a){c=ft(f);a=c.data(rt);b(e+"using default playback ["+a+"]")}t.setPlayback(a);if(!!d.$stickyPinButton&&true===n){t.setSticky(true)}if(!!d.$embiggenButton&&true===r){t.setEmbiggen(true)}if(undefined!==s){t.setVolume(s,true)}if(true===o){t.setMute(true)}t.adjustWidth();u.on("resize",function(){t.adjustWidth()});mt.initComplete.call(t);if(t.hasAutoplay()){t.autoplay()}};n.getUiMap=function(){var i=$.extend(true,mt.getUiMap(),t);b(e+"uiMap: ",i);return i};n.getUiElement=function(t,i){var a=this,n=a.els,r=i.selector,s,o,l,u;if(!!i.external){if(!!i.parentOf){s=i.parentOf;o="parents"}else if(!!i.childOf){s=i.childOf;o="find"}if(!!s){l=n[s]}if(!!l&&!!o){u=l[o](r)}else if(r.indexOf("#")===0){u=$(r)}if(!u||u.length<1){u=undefined}b(e+"external element ["+t+"]: ",u)}else{u=mt.getUiElement.call(a,t,i)}if(!!i.dependsOn&&!!u){l=n[i.dependsOn];if(undefined===l){b("warn",e+"- ["+t+"] depends on an element that does not exist. Removing from player.");u.remove();u=undefined}}return u};n.initCountdown=function(){var e=this,t=mt.initCountdown.call(e);if(t&&t.length){t.on("complete",function(){if(e.hasAutoplay()){e.autoplay()}})}return t};n.handleUserAction=function(t,i){b(e+"handleUserAction > elementData: ",i);var n=this,r=i.cookieType,s=n[a[r]],o;if(!s){b("warn",e+"Not a cookie action");return}switch(r){case"state":o=i.state;if(!!o){s.call(n,o,t.data(rt))}else{b(e+"Invalid data detected, not saving.")}break;default:break}};n.getVideoContainer=function(e){var t=this,i=t.els.containers,a=t.els.$videoContainer,n;if(!i){t.els.containers=i={}}n=i[e];if(!n){n=$('<div id="js-vid-'+e+"-player"+t.playerId+'" class="av-player-type-holder av-'+e+'-player-holder"/>');a.append(n);i[e]=n}return n};n.spacebarToggle=function(e){if(e.which===32){e.preventDefault();this.togglePlay()}};n.stopSelect=function(e){if(!$(e.target).data("enable-select")){f(e)}return false};n.hasAutoplay=function(){var e=this;return e.videoJSON.autoplay&&!e.states.counting};n.autoplay=function(){var e=this;if(!e.states.playing){b("!!! AUTOPLAY !!!");e.els.$playPauseButtons.first().trigger("click")}};n.getCurrentTime=function(){var e=this,t=e.states,i=0;if(!e.videoJSON.isLiveStream&&0===t.customStartTime&&t.started){try{i=nt.getCurrentTime()}catch(a){}}return i};n.stashCurrentTime=function(){var t=this,i=t.states,a={},n;if(!t.videoJSON.isLiveStream&&0===i.customStartTime&&i.started){try{n=nt.getCurrentTime()}catch(r){n=0}a.customStartTime=n;b(e+"stashCurrentTime() time: "+n);if(true===i.restoredFromSavedTime){a.restoredFromSavedTime=false}t.setStates(a)}};n.setPlayback=function(t){var i=this,a=i.els,n=a.$qualityButtons,r=i.setControl(a.$playbackButtons,t),s,o,l,u,d=i.stateJSON.quality,f=i.states,c=false;var v=i.playbacks[t];if(true===r){b(e+"setPlayback to: ",t);i.setStates({playback:t,playerType:v.playerType});i.stashCurrentTime();o=v["$qualities"];l=n.not(o);pt(l);yt(o);s=v["qualities"];b(e+"> available qualities for playback: ",s);b(e+"> current activeQuality: ",d);if(!d||0>$.inArray(d,s)){b(e+"> activeQuality not found for playback");u=ft(o);d=u.data(rt);b(e+"> setting new activeQuality to: ",d)}if(f.started){i.pause();c=nt.setPlayer()}i.setQuality(d,true);if(c&&f.started){b(e+"> player has started, play video with new player");i.play()}}return r};n.setQuality=function(e,t){var i=this,a=i.states,n=mt.setQuality.call(i,e,true);if(n){i.stashCurrentTime();if(a.started&&!t){i.play()}}return n};n.adStart=function(){var e=this;mt.adStart.call(e);e.setVideoProgress("A word from our sponsors...")};n.contentEnd=function(){var t=this,i=t.states,a=i.isLive,n;mt.contentEnd.call(t);n=i.isAtEndTime;if(!a&&n){b(e+"reset progress width to 0");t.setVideoProgress("",0)}};n.toggleShare=function(){var e=this,t=!e.states.share;e.setStates({share:t})};(function(){var i="sticky",a={zIndex:5000050,noStop:true,unstickyOnAjax:false},r=function(t,a){var n=t.$stickyContainer,r=t.$videoSpacer,s=!!r;if(true===a){b(e+"add sticky");n.addClass(i);if(s){r.height(n.outerHeight(true))}}else{b(e+"remove sticky");n.removeClass(i);if(s){r.height("auto")}}};n.setSticky=function(e){var t=false,i=this,n=i.els,s=n.$stickyContainer,o=n.$stickyPinButton,l=o.data(rt)||false;if(!!s&&l!==e){t=true;if(true===e){$.sticky(s,a,function(){r(n,true)},function(){r(n,false)})}else{$.destroySticky(s);r(n,false)}o.data(rt,e);i.setStates({stickied:e})}return t};n.toggleSticky=function(){b(e+"toggle sticky!");var i=this,a=t.$stickyPinButton.cookieType,n,r;if(undefined===a){n=!i.els.$stickyPinButton.data(rt);r=i.setSticky(n)}else{r=i.toggleState("sticky")}return r}})();(function(){var e=false,t="pod-recirc--horizontal",i=["align-vertical--child","align-vertical--contain"],a,r,s,o=[];var u=function(n,l){var u=n.$kubrickRelated;if(!u){return}if(false===e){e=true;a=u.data("embiggen-class");r=u.data("debiggen-class");s=u.find(".pod");$.each(i,function(e,t){o.push(s.find("."+t))})}if(l){u.addClass(a).removeClass(r);s.addClass(t);$.each(o,function(e,t){t.removeClass(i[e])})}else{u.addClass(r).removeClass(a);s.removeClass(t);$.each(o,function(e,t){t.addClass(i[e])})}};n.setEmbiggen=function(e){var t=false,i=this,a=i.els,n=a.$embiggenContainer,r=a.$embiggenButton,s=a.$embiggenVidSize,o=a.$kubrickInfo,d=a.$kubrickInfoParent,f=a.$videoSpacer,c=r.data(rt)||false,v=".container",p='<div class="container"></div>',y="no-sticky",g,h,m=s.data("embiggen-class"),S=s.data("debiggen-class");if(c!==e){t=true;if(true===e){s.removeClass(S).addClass(m);n.addClass("large").removeClass("small medium");if(!!o){o.children().wrap(p);o.addClass(y);if(!!f){f.after(o)}}}else{s.removeClass(m).addClass(S);n.addClass("small").removeClass("medium large");if(!!o){h=o.find(v);g=h.children();if(h.length>0){g.unwrap()}o.removeClass(y);d.prepend(o)}}u(a,e);l().trigger("resize");r.data(rt,e);i.setStates({embiggened:e})}return t};n.toggleEmbiggen=function(){return this.toggleState("embiggen")}})();(function(){var t="mousemove"+i,a="mouseleave"+i,r=null,s=1500,o=null,l=null;var u=function(e){if(e.clientX===o&&e.clientY===l){return false}o=e.clientX;l=e.clientY;return true};n.toggleStowControls=function(e){var t=this;if(null!==r){clearTimeout(r);r=null}if(t.states.stowControls!==e){t.setStates({stowControls:e})}};n.cancelStowControls=function(){this.toggleStowControls(false)};n.delayStowControls=function(){var e=this;e.cancelStowControls();r=setTimeout(function(){e.toggleStowControls(true)},s)};n.setStowControls=function(i){var n=this,r=n.els.$videoPlayerDiv;b(e+"===== setStowControls: ",i);n.cancelStowControls();if(true===i){r.on(t,function(e){if(u(e)){n.delayStowControls()}});r.on(a,function(){n.toggleStowControls(true)})}else{n.toggleStowControls(false);o=null;l=null;r.off(t);r.off(a)}}})();return n}();var Pt=function(){var e="[UPDATE PLAYER] ",t,i;var a=function(t){var a=window.location.pathname;var n={async:true,data:{updatePlayer:1},dataType:"json",cache:true,type:"GET",url:a,beforeSend:function(){b(e+"sending request for player update")},success:function(a){b(e+"Success data: ",a);if(undefined===t){b(e+"Unable to find player to update");return}if(undefined===a||undefined===a.html){b(e+"No player update provided");return}if(undefined===i){i=$("<div/>")}var n;i.html(a.html);n=i.children();t.replaceWith(n);$t.call(n[0]);Ct(n);Tt(n)},error:function(){b(e+"player update request failed")}};b(e+"updatePlayer settings: ",n);return n};return function(i){if(undefined===i){return}if(undefined!==t){b(e+"abort previous player update request");t.abort()}t=$.ajax(a(i));b(e+"request sent: ",t)}}();var Ct=function(e){u().trigger("videoPlayerReady",[e])};var Tt=function(e){l().on("unload",function(){e.trigger("unloadVideoplayer")})};var At=function(){var e;return function(t){if(undefined===e||true===t){e=$(".js-video-player")}return e}}();var $t=function(){var e=$(this),t=e.data("id"),i,a,n,r;if(!t){return null}i=K(e);b(i);if(!i){b("error","Video JSON missing for: ",e);return null}if(i.isDevice){a=St}else{a=kt}n={playerId:t,videoJSON:i,els:{$videoPlayerDiv:e}};r=$.extend(true,{},a);r.initialize(n);if(!r.els.$playerChrome&&r.els.$countdown){r.els.$countdown.on("complete",function(){Pt(e)})}return r};var bt=function(){var e=At(),i;if(!!e.data("debug")){w()}b("Initializing metis version: ",t.version);j(e);z(e);x(e);W(e);i=e.find(".js-vid-invalid-reqs");if(!(true===L()||true===G())){e.addClass(E+" has-vid-invalid-reqs");e.find(".js-vid-player-chrome").remove()}else{var a=[];e.each(function(e,t){a.push($t.apply(t))});i.remove();Ct(e);wt(a)}Tt(e)};var wt=function(e){var t={};(function(){e.forEach(function(e){t[e.videoJSON.id]=e});i()})();function i(){var e={start:{fn:n},getPlayerInfo:{fn:r},play:{fn:s,params:["videoId"]},pause:{fn:o,params:["videoId"]},isPlaying:{fn:l,params:["videoId"]},getCurrentTimeStamp:{fn:u,params:["videoId"]},setCurrentTimeStamp:{fn:d,params:["videoId","timestamp"]},ended:{fn:f,async:true,params:["videoId","wait"]}};window.onmessage=function(t){var i=t.data.request;if(!i){return}if(!e.hasOwnProperty(i)){t.ports[0].postMessage({msg:"error",info:"unknown request"});return}var n=null;function r(e){n=e}var s=[];if(e[i].params){e[i].params.some(function(e){if(!t.data.hasOwnProperty(e)){n="Missing param "+e;return true}s.push(t.data[e])})}if(e[i].async){s.push(a(t))}s.push(r);var o=null;if(!n){o=e[i].fn.apply(this,s)}if(!e[i].async||n){if(n){t.ports[0].postMessage({result:"error",data:n})}else{t.ports[0].postMessage({result:"ok",data:o})}}}}function a(e){return function(t,i){if(i){e.ports[0].postMessage({result:"error",data:i})}else{e.ports[0].postMessage({result:"ok",data:t})}}}function n(){var e={apiVersion:"0.01",userLoggedIn:$("meta[name=userAuthState]").attr("content")=="loggedIn",userIsPremium:$("meta[name=userIsPremium]").attr("content")=="premium",edgework:"sucks"};return e}function r(){var e=[];for(var i in t){if(!t.hasOwnProperty(i)){continue}var a=t[i];var n={id:i,title:a.title,premium:a.videoJSON.premium};e.push(n)}return e}function s(e,i){if(!t.hasOwnProperty(e)){return i("No such video player")}var a=t[e];a.play()}function o(e,i){if(!t.hasOwnProperty(e)){return i("No such video player")}var a=t[e];a.pause()}function l(e,i){if(!t.hasOwnProperty(e)){return i("No such video player")}var a=t[e];return a.states.playing}function u(e,i){if(!t.hasOwnProperty(e)){return i("No such video player")}var a=t[e];return a.getCurrentTime()}function d(e,i,a){if(!t.hasOwnProperty(e)){return a("No such video player")}var n=t[e];n.seekTime=i;return n.seekTo()}function f(e,i,a,n){if(!t.hasOwnProperty(e)){return n("No such video player")}var r=t[e];var s=!r.states.playing&&Math.ceil(r.states.currentTime)>=r.states.duration;if(i&&!s){c(r,a,n)}else{a(s)}}function c(e,t,i){var a=setInterval(function(){if(!e.states.playing&&Math.ceil(e.states.currentTime)>=e.states.duration){clearInterval(a);t()}},1e3)}};(function(){var e=At();if(!e||e.length<1){return}var t=u();var i=$(".ad-settings"),a=$("#ad-service-client");var n=false;var r=false;var s=false;var o=e.data("initOnAdRender");var l="[DEPENDENCIES] ";var d=function(){if(n&&r&&!s){b(l+"["+(Date.now()-f)+"ms] INIT PLAYER");bt();s=true}};var f=Date.now(),c,v;b(l+"VIDEO PLAYER JS READY");var p={tracking_initialized:function(){b(l+"["+(Date.now()-f)+"ms] PAGE TRACKING INITIALIZED");r=true;d()}};var y=function(){n=true;d()};if(i&&i.length>0){p.ads_initialized=function(){c=Date.now();b(l+"["+(c-f)+"ms] DISPLAY ADS JS INITIALIZED");if(!o){y()}};p.guilt_detected=function(){v=Date.now();b(l+"["+(Date.now()-f)+"ms] GUILT DETECTED");t.off("guilt_detected",p.guilt_detected)};if(o){p.ad_rendered=function(){var e=At(true);v=Date.now();b(l+"["+(v-f)+"ms] DISPLAY AD RENDER DETECTED ["+(v-c)+"ms] after ADS JS INITIALIZED");t.off("ad_rendered",p.ad_rendered);if(e&&e.length>0){y()}else{b(l+"VIDEO PLAYER HAS BEEN REMOVED")}}}if(a&&a.length>0){if(a.data("isSpof")){y()}else{a.one("error",function(){y()})}}}else{n=true;b(l+"["+(Date.now()-f)+"ms] NO VIDEO PLAYER AD DEPENDENCIES")
}t.on(p)})()})(this);
(function(){"use strict";var r=$(".js-brightcove-video-player");if(!r||r.length<1){return}var e=false;var t=false;var a=false;var i=function(){return window.s};var n=function(){var r=false;var e=[6,10,15,20,24,30,44,64,66];return function(t){if(true===r){return}var a=i(),n,o,u;if(undefined===a||!t){return}r=true;var f={UMBEPARAMcc:"USD"};if(document.referrer){f.UMBEPARAMr=document.referrer}if(a.products){f.UMBEPARAMproducts=a.products}if(a.list3){f.UMBEPARAMl3=a.list3}for(u=0;u<e.length;u++){o=e[u];n=a["eVar"+o];if(n){f["UMBEPARAMv"+o]=n}}var c=t.metadataUri;c+="?"+$.param(f);t.metadataUri=c}}();var o=function(){var i=false;return function(){if(i||!e||!t){return}i=true;var o=window.videojs;if(undefined===o||"function"!==typeof o){return}var u=o("brightcovePlayer");var f=r.data("onceux-options");n(f);u.onceux(f);u.poster(r.data("poster"));u.controls(true);if(true===a){u.autoplay(a)}window.bcplayer=u}}();var u=function(){var r=false,e=false,a=[];var i=function(){if(false===e){a=[];var r=$(".js-brightcove-src-url");if(!r||r.length<0){return false}r.each(function(){var r=$(this).attr("content");if($.inArray(r,a)<0){a.push(r)}});e=true}};var n=function(){if(0===a.length){r=true}if(true===r){t=true;o();return}var e=a.shift();$.ajax({url:e,dataType:"script",success:n,error:function(){},complete:function(){}})};return function(){i();n()}}();var f=function(){if(!$.cookie("brightcove")||true===t){return}$(document).off(".loadBrightcove");$(".js-video-player").remove();r.removeClass("hide");var e=$('<video id="brightcovePlayer"></video>');e.attr(r.data("brightcove"));if(e.attr("autoplay")){a=true;e.removeAttr("autoplay")}r.append(e);u()};$(document).on("ready.loadBrightcove guilt_detected.loadBrightcove",f).one("tracking_initialized",function(){e=true;o()})})();
(function(){"use strict";window.PhoenixDatePicker={initializeDatePickers:function(){$(".datepicker-input").each(function(){var t=$(this);if(t.data("initialized")){return}var e=false;var i=t.val();if(i){e=true}t.datepicker().on("changeDate",function(){$(this).datepicker("hide")}).on("show",function(){if(e){return}e=true;t.datepicker("setValue",new Date)});t.data("initialized",true)});$(".timepicker").each(function(){var t=$(this);if(t.data("initialized")){return}t.timepicker({step:15,timeFormat:"H:i"});t.data("initialized",true)});$(".datetime-now-button").click(function(i){i.preventDefault();var a=$(this);var n=a.parent().find(".datepicker-input");var r=a.parent().find(".timepicker");var c=new Date;var u=t(c);var o=e(c);n.attr("value",u);r.attr("value",o)})}};$(document).ready(function(){PhoenixDatePicker.initializeDatePickers();$(document).ajaxStop(PhoenixDatePicker.initializeDatePickers())});function t(t){var e=t.getMonth()+1;var i=t.getDate();var a=t.getFullYear();if(e.toString().length<2){e="0"+e}if(i.toString().length<2){i="0"+i}return e+"/"+i+"/"+a}function e(t){var e=t.getHours();var i=t.getMinutes();if(i<10){i="0"+i}return e+":"+i}})();
$(document).ready(function(){"use strict";var t=function(t){if(t.attr("data-remove-parent")){t.closest(t.attr("data-remove-parent")).remove();return}var e=t.children("i.icon");var a=t.attr("data-toggle-value");t.attr("data-toggle-value",t.text());t.text(a);t.prepend(e);if(t.attr("data-toogle-tooltip")){var r=t.attr("data-tooltip-toggle-value");var i=t.attr("data-tooltip-title");t.attr("data-tooltip-toggle-value",i);t.attr("data-tooltip-title",r);t.data("tooltip").options.title=r;t.attr("data-original-title",r)}};var e=function(){var t="event-tracking";return function(e,a){var r=e.data(t),i;if("string"===typeof r){i=r;r=undefined}if(undefined===r){r={};if(i){r.event_hierarchy=i}if(a.eventTracking){$.extend(r,a.eventTracking)}if(!$.isEmptyObject(r)){e.data(t,r)}}if(undefined!==r&&!$.isEmptyObject(r)){e.trigger("followEventTracking")}}}();var a=function(){$(".btn-toggle").each(function(){var a=$(this);if(a.data("btn-toggle-initialized")){return}a.on("click",function(a){if($(this).is("a")===true&&$(this).attr("href")!==""){var r=$(this);if(r.hasClass("super-action")){r.siblings(".super-action").toggleClass("active",false);r.siblings(".sub-action:not('."+r.attr("rel")+"')").toggleClass("hide",true);r.toggleClass("active");r.siblings("."+r.attr("rel")).toggleClass("hide");return false}else if(r.hasClass("has-input")&&r.attr("rel").length&&r.siblings(":input[name='"+r.attr("rel")+"']").val().length){r.attr("href",jQuery.param.querystring(r.attr("href"),"reason="+encodeURIComponent(r.siblings(":input[name='"+r.attr("rel")+"']").val())))}else if(r.parents(".sub-action").find("a:contains('Flagged')").length>0){return false}var i=r.attr("data-verify-statement");if(typeof i!="undefined"&&i){if(!confirm(i)){return false}}AjaxApiRequest.makeApiRequest($(this).attr("href"),null,true,function(a){var i=[];if(a.hasOwnProperty("hideDelay")){i["hideDelay"]=a.hideDelay}if(a.hasOwnProperty("redirect")){Phoenix.Ui.showErrorMessage(a.error,i);window.location.href=a.redirect+"?redirect_url="+document.URL}else if(a.hasOwnProperty("success")&&!a.success){var n=a.message||a.reason||a.error||"Feature broken. Do not worry. Fix in pipeline.";Phoenix.Ui.showErrorMessage(a.message,i)}else{e(r,a);var n=a.message||"Setting saved.";Phoenix.Ui.showSuccessMessage(n,i);t(r)}},function(){Phoenix.Ui.showErrorMessage("Woops! Something happened and we are working on it!")});a.preventDefault()}});a.data("btn-toggle-initialized",true)})};a();$(document).ajaxStop(function(){a()})});
$(document).ready(function(){"use strict";$(".board-selector a").on("click",function(){var e=$(this);var a=e.parent().parent();var i=a.parent();var d=i.find(".board-autocomplete-li");a.addClass("hide");a.find(":input").attr("disabled","disabled");if(a.hasClass("board-main-li")){d.removeClass("hide");d.find(":input").removeAttr("disabled")}else{d=i.find(".board-main-li");d.removeClass("hide");d.find(":input").removeAttr("disabled")}return false})});
$(document).ready(function(){"use strict";$(".btn-ban").on("click",function(){if($(this).is("a")===true&&$(this).attr("href")!==""){var e=$(this);AjaxApiRequest.makePostApiRequest(e.attr("href"),function(){e.addClass("active");var s=e.closest(".btn-group");s.children(".btn-unban").first().removeClass("hide");s.children(".btn-ban-parent").first().addClass("hide");Phoenix.Ui.showSuccessMessage("User banned");e.parents(".js-avatar-user").first().addClass("banned")},function(){Phoenix.Ui.showErrorMessage("Woops! Something happened and we are working on it!")});return false}});$(".btn-unban").on("click",function(){if($(this).is("a")===true&&$(this).attr("href")!==""){var e=$(this);AjaxApiRequest.makePostApiRequest(e.attr("href"),function(){e.addClass("hide");e.next(".btn-ban-parent").removeClass("hide");Phoenix.Ui.showSuccessMessage("User unbanned");e.parents(".js-avatar-user").first().removeClass("banned")},function(){Phoenix.Ui.showErrorMessage("Woops! Something happened and we are working on it!")});return false}});$(".js-ban-widget .btn-ban, .js-ban-widget .btn-unban").on("click",function(){var e=$(this);AjaxApiRequest.makePostApiRequest(e.attr("href"),function(){if(e.hasClass("btn-unban")){Phoenix.Ui.showSuccessMessage("User unbanned")}else{Phoenix.Ui.showSuccessMessage("User banned")}},function(){Phoenix.Ui.showErrorMessage("Woops! Something happened and we are working on it!")});return false});$(".js-ban-time-widget button").on("click",function(e){var s=$.trim($(".js-ban-widget input").val());if(!s){Phoenix.Ui.showErrorMessage("Must enter ban value.")}else{var n=s.split(" ");var a=0;var t=false;$.each(n,function(){var e=this;if(e.length>1){var s=e[e.length-1];var n=parseInt(e.slice(0,e.length-1),10);if(isNaN(n)){Phoenix.Ui.showErrorMessage("Format string weird, should be like 1w 2d 3h");t=true;return false}switch(s){case"mo":a=a+n*44640;break;case"w":a=a+n*10080;break;case"d":a=a+n*1440;break;case"h":a=a+n*60;break;case"m":a=a+n*1;break;default:Phoenix.Ui.showErrorMessage("Format string weird, should be like 1w 2d 3h");t=true;return false}}});var r=$(this);if(!t&&a!==0){var i=r.attr("href");i=i.replace("REPLACEME",a);AjaxApiRequest.makePostApiRequest(i,function(){Phoenix.Ui.showSuccessMessage("User banned for "+s)},function(){Phoenix.Ui.showErrorMessage("Woops! Something happened and we are working on it!")})}}e.preventDefault();e.preventPropagation()});$(".btn-nuke").on("click",function(){var e=window.confirm("With great power comes great responsibility.  This will ban the user and delete all their messages and topics.  Are you sure you want to nuke this user?");if(e){var s=window.confirm("Are you really sure?  Also, this process will take a while (Up to 2 minutes).  Just sit and wait after clicking for the status message bar to appear.");if(!s){return false}}else{return false}if($(this).is("a,button")===true&&$(this).attr("href")!==""){var n=$(this);AjaxApiRequest.makePostApiRequest(n.attr("href"),function(){n.addClass("active");var e=n.closest(".btn-group");e.children(".btn-unban").first().removeClass("hide");e.children(".btn-ban-parent").first().addClass("hide");Phoenix.Ui.showSuccessMessage("User nuked!")},function(){Phoenix.Ui.showErrorMessage("Woops! Something happened and we are working on it!")});return false}})});
$(document).ready(function(){"use strict";var a=false;var t=false;var i=0;$(document).on("click",".js-simple-paginator a",function(r){r.preventDefault();var e=$(this).parents(".js-simple-paginator").data("warning");if(e){$(this).data("warning","");if(!confirm(e)){return}}var o=$(this);var s=o.parents(".js-simple-paginator-container").first();if(s.attr("data-paginator-number")===null){s.attr("data-paginator-number",i);i=i+1}var p=s.attr("data-paginator-number");if(!a&&window.history.pushState){window.history.replaceState({name:"SimplePaginate",url:location.href},"",location.href);a=true}var l=o.attr("href");n(o,l);if(window.history.pushState){window.history.pushState({name:"SimplePaginate",href:l},"",l);t=true}});var n=function(a,t){var i=$('<div class="loading"></div>');a.parents(".js-simple-paginator-container").children().addClass("hide");a.parents(".js-simple-paginator-container").append(i);AjaxApiRequest.makeGetApiRequest(t,function(t){var n=a.parents(".js-simple-paginator-container").first();i.remove();n.html(t.html)})};if(window.history.pushState){$(window).on("popstate","",function(a){if(!t){return}var i=a.originalEvent.state;if(i&&i.name==="SimplePaginate"){console.log("popping");console.log('.js-simple-paginator a[href="'+i.url+'"]');console.log(i.url);n($('.js-simple-paginator a[href="'+i.url+'"]'),i.url)}})}});
$(document).ready(function(){"use strict";$(document).on("click",".js-slider a.js-slide-button",function(e){e.preventDefault();var s=$(this);var t=s.attr("href");var i=$('<div class="loading"></div>');s.parents(".js-slider").children().addClass("hide");s.parents(".js-slider").append(i);AjaxApiRequest.makeGetApiRequest(t,function(e){var t=s.parents(".js-slider").first();i.remove();t.html(e.html)})})});
$(document).ready(function(){"use strict";var s="expandable__show-less";var a="expandable__show-more";var e=".js-expandable";var n=".js-expand";var i=function(n){n.siblings(e).removeClass(s).addClass(a);n.addClass("hide")};var t=function(){$(e).each(function(){var s=$(this),a=s.siblings(n);if(parseInt(s.css("height"),10)<parseInt(s.css("max-height"),10)){i(a)}})};t();$(document).on("click",n,function(s){s.preventDefault();i($(this))})});
$(document).ready(function(){"use strict";$(document).on("click",".js-unhide-list",function(i){i.preventDefault();var e=$(this).parents("ul").first();var s=e.find("li.hide");s.removeClass("hide");$(this).addClass("hide")});$(document).on("click",".js-replace-list",function(i){i.preventDefault();var e=$(this).parents("ul").first();var s=e.find("li:not(.hide)");var t=e.find("li.hide");t.removeClass("hide");s.addClass("hide");$(this).addClass("hide")})});
$(document).ready(function(){"use strict";var e=$("body"),s=$(".search-input");$("#js-btn-mobile-nav").click(function(s){if(e.hasClass("mobile-slide-search")){e.removeClass("mobile-slide-search");e.addClass("mobile-slide-nav")}else if(e.hasClass("mobile-slide")){e.removeClass("mobile-slide");e.removeClass("mobile-slide-nav");e.removeClass("mobile-slide-search")}else if(e.hasClass("mobile-nav-user")){e.removeClass("mobile-nav-user");e.addClass("mobile-slide");e.addClass("mobile-slide-nav")}else{e.addClass("mobile-slide");e.addClass("mobile-slide-nav")}s.preventDefault()});$("#js-btn-mobile-search").click(function(a){if(e.hasClass("mobile-slide-nav")){e.removeClass("mobile-slide-nav");e.addClass("mobile-slide-search");s.focus()}else if(e.hasClass("mobile-slide")){e.removeClass("mobile-slide");e.removeClass("mobile-slide-nav");e.removeClass("mobile-slide-search");s.blur()}else{e.addClass("mobile-slide");e.addClass("mobile-slide-search");s.focus()}a.preventDefault()});$("#js-btn-mobile-user").click(function(s){if(e.hasClass("mobile-slide-nav")){e.removeClass("mobile-slide");e.removeClass("mobile-slide-nav")}e.toggleClass("mobile-nav-user");var a=$(".masthead-userBox");a.toggleClass("show")});$(".js-dropnav-toggle").click(function(e){$(this).toggleClass("is-active");var s=$(this).siblings("ul");if(s.length===0){s=$(this).siblings().children("ul")}var a=$(this).parents(".subnav");s.toggleClass("show");a.toggleClass("menu-open")});$(".js-sidenav-toggle").click(function(){var e=$(this);e.toggleClass("is-active");var s=e.siblings("ul");s.toggleClass("show");s.find("li a").on("click",function(){s.removeClass("show");e.removeClass("is-active")})});$("#nav-main .dropdown-toggle").click(function(){$("html, body").animate({scrollTop:$(this).offset().top},300)});var a=navigator.userAgent.match(/iPad/i)!=null;if(a){$("ul.masthead-userBox li.dropnav",".masthead-container").on("click",function(e){if($(".dropnav-menu",this).is(":visible")){return $(this)}e.preventDefault();$("li","nav.masthead-nav").removeClass("hover");$("ul.masthead-userBox li .dropnav-menu",".masthead-container").hide();$(".dropnav-menu",this).toggle();return false});$("li.dropnav-submenu__item","nav.masthead-nav").on("click",function(){window.location.href=$(this).children("a").attr("href")});$("li:has(ul),li:has(dl)","nav.masthead-nav,nav#nav-main").doubleTapToGo();$(".dropnav",".header-section").doubleTapToGo()}});(function(e,s,a,l){e.fn.doubleTapToGo=function(l){if(!("ontouchstart"in s)&&!navigator.msMaxTouchPoints&&!navigator.userAgent.toLowerCase().match(/windows phone os 7/i))return false;this.each(function(){var l=false;e(this).unbind("mouseover mouseout");e(this).on("click",function(a){a.stopPropagation();a.preventDefault();var i=e(this);var o=e(a.target);e("ul.masthead-userBox li .dropnav-menu",".masthead-container").hide();if(i[0]!=l[0]){i.siblings("li").removeClass("dropnav-menu__active");if(i.hasClass("dropnav-menu__item")){i.addClass("dropnav-menu__active")}else{e("li:has(ul),li:has(dl)","nav.masthead-nav,nav#nav-main").removeClass("hover");i.siblings("li").removeClass("hover");i.addClass("hover")}l=i;return false}else{l=false;if(o&&o.attr("href")&&o.attr("href").length){s.location.href=o.attr("href")}else{return o}return false}});e(a).on("click touchstart MSPointerDown",function(s){var a=true,i=e(s.target).parents();for(var o=0;o<i.length;o++){if(i[o]==l[0]){a=false}}if(a)l=false})});return this}})(jQuery,window,document);
$(document).ready(function(){"use strict";$(".js-ajax-button-loader").on("click",function(e){e.preventDefault();var t=$(this);var a=t.data("ajax-href");var i=$('<div class="loading"></div>');var n=t.data("show-hide-button");if(n==="yes"){t.text("Hide")}else{t.hide()}t.parent().append(i);AjaxApiRequest.makeApiRequest(a,null,false,function(e){var a=t.parent();if(n==="yes"){t.show();var s=$("<div></div>").html(e.html);s.addClass(t.data("show-hide-container-class"));a.append(s);t.text("Hide");var d=false;i.remove();t.unbind();t.click(function(e){if(d){s.show();t.text("Hide");d=false}else{s.hide();t.text("Show");d=true}e.stopPropagation();e.preventDefault()})}else{a.html(e.html)}})})});
(function(){"use strict";var e=document.querySelector(".masthead"),r="has-scrolled",o="has-scrolled-top",n="js-show-scroll-dir";if(!e){return}var a=function(){var r;var o=false;var n=false;var a="is-scroll-up";var s="is-scroll-down";var t=function(){return window.pageYOffset!==undefined?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop};var l=function(r){var o,n;if(r){o=a;n=s}else{o=s;n=a}classie.add(e,o);classie.remove(e,n)};var i=function(){var e=t(),a=o,s=n;if(r>e){a=true;s=false}else{a=false;s=true}if(a!==o||s!==n){l(a)}r=e;o=a;n=s};return function(){r=t();$(window).on("scroll",i)}}();var s=function(){var o;var s=function(){if(o.isFullyInViewport){classie.remove(e,r)}else{classie.add(e,r)}};return function(){var r=scrollMonitor.create(e);o=r;r.lock();r.partiallyExitViewport(s);r.fullyEnterViewport(s);if(classie.has(e,n)){a()}}}();$(document).ready(s)})();
var ajax=new XMLHttpRequest;ajax.open("GET","/bundles/phoenixsite/images/core/sprites/icons/svg/icons-sprite-min.svg",true);ajax.send();ajax.onload=function(e){var t=document.createElement("div");t.innerHTML=ajax.responseText;t.setAttribute("id","js-svgDef-icons");t.setAttribute("style","displaY: none");document.body.insertBefore(t,document.body.lastChild.nextSibling)};
$(document).ready(function(){"use strict";var s=$(".js-uiTools-classSwitch--trigger"),a=$(".js-uiTools-classSwitch--target");$(document).on("click",".js-uiTools-classSwitch--trigger",function(s){var t=a.attr("data-uitools-onclass"),o=a.attr("data-uitools-offclass");if(a.hasClass(t)){a.removeClass(t).addClass(o);return}if(a.hasClass(o)){a.removeClass(o).addClass(t);return}})});
$(document).ready(function(){"use strict";var e=false;var n=$("li.js-notification");var i=null;var t=function(n,t,a,o){return function(){if(e){return}var r=this;e=true;var s=$(t);var f=s.parent().find(".loading");if(f.length===0){f=$('<div class="loading"></div>')}$(r).find(a).remove();s.after(f);i=$.get(n,function(e,n,t){if(!e.success){return}var f=e.messages;s.after(f);i=t;if(typeof o==="function"){o($(r).find(a))}}).fail(function(n,t,a){i=n;e=false;if(t==="abort"||n.readyState===0){return}Phoenix.Ui.showErrorMessage("There was a problem displaying recent messages, try again later.")}).done(function(n,t,a){i=a;e=false;s.parent().find(".loading").remove()})}};$("li.pm").mouseenter(function(e){t("/pm/unread/",".js-unread-messages",".js-inbox-message").call(this)}).mouseleave(function(){if(i&&typeof i.abort==="function"){i.abort()}});n.mouseenter(function(e){$(this).find(".js-notification-show-more").remove();t("/notifications/unread/",".js-unread-notifications",".js-notification-message",function(e){n.children("a:first .bubble-count").text("0");setTimeout(function(){e.each(function(){$(this).removeClass("unread").addClass("read")})},5e3)}).call(this,e)}).mouseleave(function(){if(i&&typeof i.abort==="function"){i.abort()}});var a=$(this);var o=6e4;var r=6e5;var s});
(function(e,t,i){var a="object",n=true;function r(e,t){var i=(e[0]||0)-(t[0]||0);return i>0||!i&&e.length>0&&r(e.slice(1),t.slice(1))}function s(e){if(typeof e!=a){return e}var t=[],i="";for(var r in e){if(typeof e[r]==a){i=s(e[r])}else{i=[r,n?encodeURI(e[r]):e[r]].join("=")}t.push(i)}return t.join("&")}function o(e){var t=[];for(var i in e){if(e[i]){t.push([i,'="',e[i],'"'].join(""))}}return t.join(" ")}function l(e){var t=[];for(var i in e){t.push(['<param name="',i,'" value="',s(e[i]),'" />'].join(""))}return t.join("")}var c;try{c=i.description||function(){return new i("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}()}catch(f){c="Unavailable"}var h=c.match(/\d+/g)||[0];e[t]={available:h[0]>0,activeX:i&&!i.name,version:{original:c,array:h,string:h.join("."),major:parseInt(h[0],10)||0,minor:parseInt(h[1],10)||0,release:parseInt(h[2],10)||0},hasVersion:function(e){var t=/string|number/.test(typeof e)?e.toString().split("."):/object/.test(typeof e)?[e.major,e.minor]:e||[0,0];return r(h,t)},encodeParams:true,expressInstall:"expressInstall.swf",expressInstallIsActive:false,create:function(e){var t=this;if(!e.swf||t.expressInstallIsActive||!t.available&&!e.hasVersionFail){return false}if(!t.hasVersion(e.hasVersion||1)){t.expressInstallIsActive=true;if(typeof e.hasVersionFail=="function"){if(!e.hasVersionFail.apply(e)){return false}}e={swf:e.expressInstall||t.expressInstall,height:137,width:214,flashvars:{MMredirectURL:location.href,MMplayerType:t.activeX?"ActiveX":"PlugIn",MMdoctitle:document.title.slice(0,47)+" - Flash Player Installation"}}}attrs={data:e.swf,type:"application/x-shockwave-flash",id:e.id||"flash_"+Math.floor(Math.random()*999999999),width:e.width||320,height:e.height||180,style:e.style||""};n=typeof e.useEncode!=="undefined"?e.useEncode:t.encodeParams;e.movie=e.swf;e.wmode=e.wmode||"opaque";delete e.fallback;delete e.hasVersion;delete e.hasVersionFail;delete e.height;delete e.id;delete e.swf;delete e.useEncode;delete e.width;var i=document.createElement("div");i.innerHTML=["<object ",o(attrs),">",l(e),"</object>"].join("");return i.firstChild}};e.fn[t]=function(i){var n=this.find(a).andSelf().filter(a);if(/string|object/.test(typeof i)){this.each(function(){var n=e(this),r;i=typeof i==a?i:{swf:i};i.fallback=this;r=e[t].create(i);if(r){n.children().remove();n.html(r)}})}if(typeof i=="function"){n.each(function(){var a=this,n="jsInteractionTimeoutMs";a[n]=a[n]||0;if(a[n]<660){if(a.clientWidth||a.clientHeight){i.call(a)}else{setTimeout(function(){e(a)[t](i)},a[n]+66)}}})}return n}})(jQuery,"flash",navigator.plugins["Shockwave Flash"]||window.ActiveXObject);
$(document).ready(function(){"use strict";$(document).on("click",".js-table-paginator a",function(t){t.preventDefault();var e=$(this);var a=e.attr("href");var o=$('<div class="loading"></div>');var n=e.parents(".js-table-pagintor-table");n.hide();n.after(o);$.ajax({url:a,type:"GET",dataType:"html",success:function(t){n.html(t);o.remove();n.show();$("html, body").animate({scrollTop:n.offset().top},300)},complete:function(){o.remove();n.show()}})})});
Phoenix.jQuery.getDocument().ready(function(){"use strict";if(!window.history||!window.history.pushState){return}var e=$(window);var t=["Refreshing results...","Working...","We'll be right back...","Contemplate your navel for a bit while we work this out...","Do your chair exercises while we grab your stuff...","Don't go away! It's coming...","A GameSpot slave is toiling away finding your stuff. Be cool...","You kids and your instant gratification culture! Chill...","Scouring our internets to find your stuff. Hang tight...","You have encountered a level 3 ogre. Play with him for a bit...","Of course the stuff you want is on the server in the basement. Hang on...","Look at you! All getting fancy with sorting! BRB...","Relax, the sorting elves are working...","Hang on while we remember the order of the alphabet...","Why u make us work so hard?","What is this? Burger King&reg;? Are we supposed to do it Your Way&reg;?","I like turtles...","Usermon uses Sort. It was very effective...","Hey! That tickles!","Settle down Beavis..."];var r=location.href;var a=false;var i;var n=window.replaceState;var o=$('meta[name="js-sort-filter-text"]').attr("content");function s(e,t){var r=Phoenix.getDocument();if(!e){e="pageLoad"}r.trigger("pre_page_event",[e,t]);r.trigger("update_page_event",[e]);r.trigger("on_page_event",[e])}function l(e){window.history.pushState({name:"FilterSort",url:e},"",e);i=true}function f(e){if(!a){if(window.history.replaceState&&n){window.history.replaceState({name:"FilterSort",url:e},"",e);a=true;i=true}}}function u(e){var r=$("#js-sort-filter-results");if(!r[0]){window.location=e;return}var a=t[d(0,t.length-1)];if(o==="no"){a="Refreshing results..."}r.html("<div class='loading'>"+a+"</div>").load(e+" #js-sort-filter-results > *",function(){l(e);s()})}function c(e){var t=$("#js-sort-filter-results");if(!t[0]){window.location=e;return}t.addClass("loading-overlay").load(e+" #js-sort-filter-results > *",function(){window.history.pushState({name:"FilterSort",url:e},"",e);i=true;t.removeClass("loading-overlay");Phoenix.getDocument().trigger("pre_page_event",["pageLoad"]);Phoenix.getDocument().trigger("update_page_event",["pageLoad"]);Phoenix.getDocument().trigger("on_page_event",["pageLoad"])})}e.on("popstate.FilterSort",function(e){if(!i){return}var t=e.originalEvent.state;if(t&&t.name==="FilterSort"){u(t.url)}});$("select.js-filter").on("change",function(){if(!a){window.history.pushState({name:"FilterSort",url:r},"",r);a=true;i=true}var e=$(this);var t=new UrlMaster;var n=e.parent().find("select");$.each(n,function(e,r){var a=$(r).val();var i=$(r).attr("data-filter-query");if(a=="0"||a==""){t.removeParam(i)}else{t.addParam(i,a)}});var o=t.generateUrl();u(o)}).add($("select.js-filter-passive")).each(function(e,t){var r=$(t);var a=r.attr("data-filter-query");var i=Phoenix.Request.get(a);if(i){r.find('option[value="'+decodeURIComponent(i)+'"]').attr("selected","selected")}});$(".js-filter-special").on("click","thead a",function(e){e.preventDefault();e.stopPropagation();if(!a){window.history.pushState({name:"FilterSort",url:r},"",r);a=true;i=true}var t=$(this).attr("href");c(t)});$(".js-filter-text").each(function(e,t){var r=$(t);var a=r.attr("data-filter-query");var i=Phoenix.Request.get(a);if(i){r.val(decodeURIComponent(i))}});$(".js-filter-activate").click(function(){var e=$(this);var t=e.attr("data-filters").split(",");var r=new UrlMaster;$.each(t,function(e,t){var a=$("[data-filter-query="+t.trim()+"]");var i=a.attr("data-filter-query");var n=a.val();if(n=="0"||n==""){r.removeParam(i)}else{r.addParam(i,n)}});var a=r.generateUrl();u(a)});$(".js-filter-clear-filters").click(function(){var e=$(this);var t=e.attr("data-filters").split(",");var r=new UrlMaster;$.each(t,function(e,t){var a=$("[data-filter-query="+t.trim()+"]");var i=a.attr("data-filter-query");r.removeParam(i);if(a.hasClass("js-filter-text")){a.val("")}else{a.val(0)}});var a=r.generateUrl();u(a)});$(".js-sort").each(function(e,t){var r=$(t);var a=Phoenix.Request.get("sort");var i=Phoenix.Request.get("direction");if(a&&i){r.find('option[data-sort-param="'+a+'"][data-sort-direction="'+i+'"]').attr("selected","selected")}}).on("change",function(){f(r);var e=$(this);var t=e.children(":selected");var a=t.attr("data-sort-param");var i=t.attr("data-sort-direction");if(!a||!i){return}var n=$.param.querystring(location.pathname+location.search,"sort="+a+"&direction="+i);u(n)});$(document).on("click",".js-order-buttons a",function(e){f(r);e.preventDefault();e.stopPropagation();var t=$(this);var a=t.data("orderby");var i=t.data("direction");if(!a||!i){return}var n=$.param.querystring(location.pathname+location.search,"orderby="+a+"&direction="+i);u(n)});$(".js-filter").find(".filter-list__label").click(function(){$(this).closest(".filter-list__item").toggleClass("js-active")});function d(e,t){return Math.floor(Math.random()*(1+t-e))+e}(function(){var t={};var a=0;var i="filter-url";var n="filter-cache-key";var o="is-loading-filter";var l="on";var u=".js-filter-json";var c="option, .js-filter-option";var d=".on, :selected";var v=function(){var t=false;return function(){if(true===t){return}t=true;e.on("popstate.JsonFilter",h)}}();var h=function(e){var r=(e.originalEvent||{}).state||{},a,i,n,o,s,f,u,c;if(r.name!=="JsonFilter"){return}a=r.filterSetKey;i=t[a];n=r.filterState;o=n.filterValue;f=i.$filter;c=i.$options;s=f.is("select");if(true===s){u=c.filter('[value="'+o+'"]')}else{u=c.filter("[data-filter-value="+o+"]")}n.$selected=u;$.extend(i,n);if(true===s){f[0].selectedIndex=u[0].index}else{c.filter(d).removeClass(l);u.addClass(l)}b(i)};var g=function(e,t){switch(t){case"abort":break;case"timeout":break;default:break}};var p=function(e,t){var r=e.$results,a=k(e),i=false,o,l;r.contents().detach();if(t&&t.$contents){i=true;r.append(t.$contents)}else{r.html(t.html)}r.data(n,a);if(!e.noHistory&&e.updateHistory){m(e,w(e,false))}if(e.updateHistory&&(r.hasClass("triggerPageLoadTracking")||r.data("triggerPageLoadEvent"))){if(t&&t.trackingParams){o="pageLoad_"+a;l=t.trackingParams}s(o,l)}if(false===i){x(e)}};var y=function(e){return e.slice(0,1)};var m=function(e,t){var a;f(r);a={name:"JsonFilter",filterSetKey:e.key,filterState:{filterKey:e.filterKey,filterValue:e.filterValue,updateHistory:false}};window.history.pushState(a,"",t)};var w=function(e,t){var r=e.$filter,a=e.$selected,n=a.data(i);if(!n){n=r.data(i)}if(!n){n=location.href}if(false!==t){n+=n.indexOf("?")<0?"?":"&";n+="ajax"}return n};var j=function(e){var t=e.$pod,r=e.requestSettings;if(r){return r}r={dataType:"json",beforeSend:function(){t.addClass(o)},error:[function(t,r){g(e,r)}],success:[function(t){p(e,t);$(document).trigger("ajaxContentLoaded")}]};r.complete=[function(){t.removeClass(o);r.complete=y(r.complete);r.error=y(r.error);r.success=y(r.success)}];e.requestSettings=r;return r};var S=function(e){var t=e.noData,r=e.filterKey,a=e.filterValue,i,n=j(e);n.url=w(e);if(!t&&r&&a){i={};i[r]=a;n.data=i}return n};var k=function(e){return e.filterKey+"_"+e.filterValue};var x=function(e,t){var r=e.$results,a=e.cache,i=r.data(n),o={},s;if(!i){i=k(e);r.data(n,i)}s=a[i];if(t){delete t.html;o=t}o.$contents=r.contents();if(s){a[i]=$extend(s,o)}else{a[i]=o}return a};var P=function(e,t){return e[t]};var q=function(e){var t=e.$results,r=t.contents(),a=t.data(n),i=P(e.cache,a),o=i.$contents;if(o&&r.is(o)){return false}return true};var b=function(e){var t=k(e),r,a=e.$request,i=P(e.cache,t)||{},n=i.$contents;if(a){a.abort();e.$request=null}if(n){p(e,i)}else{r=S(e);e.$request=$.ajax(r)}};var _=function(e){var r,i,n,o,s,l,f,u,v,h;r=e.closest(".js-filter-pod");if(r&&r.length>0){i=r.find(".js-filter-results")}else{r=false}n=e.find(c);if(!r||!(i&&i.length>0)||!(n&&n.length>0)){return false}f=e.data();o=n.filter(d);if(!o||o.length===0){o=n.first()}u=f.filterQuery;v=o.val()||o.data("filter-value");l=a+=1;s={$filter:e,$options:n,$pod:r,$results:i,$request:null,$selected:o,cache:{},key:l,filterKey:u,filterValue:v,noData:!!f.filterNodata,noHistory:!!f.filterNohistory,updateHistory:false};if(!s.noHistory){h={pageTitle:$("title").text(),pageDescription:$('meta[name="description"]').attr("content")}}x(s,h);t[l]=s;return s};var C=function(){var e=$(this),t,r=_(e);if(!r){return}if(!r.noHistory){v()}t=r.$options;if(e.is("select")){e.on("change",function(){var e=t.filter(d);if(r.$selected&&e.is(r.$selected)){return}if(q(r)){x(r)}r.$selected=e;r.filterValue=e.val();r.updateHistory=true;b(r)})}else{t.on("click",function(e){var a=$(this),i=t.filter(d);e.preventDefault();if(a.is(i)){return}if(q(r)){x(r)}i.removeClass(l);a.addClass(l);r.$selected=a;r.filterValue=a.data("filter-value");r.updateHistory=true;b(r)})}};var H=function(){var e=$(u);if(e&&e.length>0){e.each(C)}};H()})();(function(){var e=$(".js-filter-load-page");if(e&&e.length>0){e.each(function(){var e=$(this);e.on("change",function(){var e=$.deparam.querystring(window.location.href);var t="";if(e.score){t="?score="+e.score}location.href=$(this.options[this.selectedIndex]).data("filterUrl")+t})})}})()});
(function(t){"use strict";var i={};var a={offset:0,zIndex:100,noStop:false,bottom:false,unstickyOnAjax:true,stickyCondition:null,noStopOnBody:false,append:true};var e=[];t.sticky=function(n,o,r,s){var d=t(n);d.data("stickyEnabled",true);d.trigger("stickyEnabled");t.destroySticky=function(a){var n=t(a);t(window).off("scroll",i[a].scroll);t(window).off("resize",i[a].resize);i[a]=null;n.each(function(){var i=t(this);var a=w(i);var n=parseInt(a.originalTop,10);var o=t.inArray(n,e);if(o>=0){e.splice(o,1)}k(i);l(i);i.removeAttr("data-original-pos");i.removeAttr("data-original-width");i.data("sticky-stopped",false);i.data("stickied",false)});n.data("stickyEnabled",false);n.trigger("stickyDisabled")};o=t.extend({},a,o);function f(){var i=[];if(n instanceof jQuery){i=n}else{i=t(n)}if(i.length<=0){return}i.each(function(){var i=t(this);if(i.attr("data-sticky-disabled")==="true"){return}var a=i.outerHeight();var n=i.outerWidth();var r=t(window).height();if(a>=r||a===0||n===0){return}var s=w(i);var d=parseInt(s.originalTop,10);var f=s.originalLeft;var c=s.originalWidth;if(t.inArray(d,e)<0){e.push(d);e.sort(function(t,i){return t-i})}if(!h(i)&&t(window).scrollTop()>d){if(o.stickyCondition!==null){if(!o.stickyCondition(i)){return}}p(i,f,c);if(!o.noStop){u(i,d)}}else if(h(i)&&t(window).scrollTop()<=d){u(i,d);l(i)}if(!o.noStop&&h(i)){u(i,d)}if(o.bottom!==false&&h(i)){v(i,o.bottom)}})}function c(){var i=[];if(n instanceof jQuery){i=n}else{i=t(n)}i.each(function(){var i=t(this);i.removeAttr("data-original-pos");i.removeAttr("data-original-width");if(i.data("sticky-stopped")){k(i)}if(i.data("stickied")){l(i)}i.data("sticky-stopped",false);i.data("stickied",false)});e=[]}t(window).on("scroll",f);t(window).resize(c);i[n]={scroll:f,resize:c};function p(i,a,e){i.css("position","fixed").css("top",o.offset+"px").css("left",a+"px").css("width",e+"px").css("margin-top","0px").css("z-index",o.zIndex);if(r){r(i)}i.data("stickied",true);i.trigger("sticky");t(document).ajaxStop(function(){if(o.unstickyOnAjax){if(i.data("sticky-stopped")){k(i)}if(i.data("stickied")){l(i)}}})}function l(t){t.css("position","").css("top","").css("left","").css("width","").css("margin-top","").css("z-index","");if(s){s(t)}t.data("stickied",false);t.trigger("unsticky")}function u(i,a){var n=t.inArray(a,e);var o=e.slice(n+1);var r=o[0];if(r!==undefined){var s=i.outerHeight()+t(window).scrollTop();var d=i.data("sticky-stopped");if(!d&&s>=r){g(i,r)}else if(d&&s<r){k(i)}}}function v(i,a){var e=y(i,a);var n=e.offset().top+e.outerHeight();if(n>0){var o=i.outerHeight()+t(window).scrollTop();var r=i.data("sticky-stopped");if(!r&&o>=n){g(i,n)}else if(r&&o<n){k(i)}}}function y(i,a){var e=null;var n=i.data("sticky-stopped-parent");if(a==="parent"){if(n){e=n}else{e=i.parent()}}else{if(a.ancestor!==undefined){if(n){e=n.parents(a.ancestor).first()}else{e=i.parents(a.ancestor).first()}}else{e=t(a)}}return e}function g(i,a){var e=i.outerHeight();i.css("position","absolute");i.css("top",a-e+"px");i.data("sticky-stopped",true);if(!o.noStopOnBody){i.data("sticky-stopped-parent",i.parent());t("body").append(i)}}function k(t){t.css("position","fixed");t.css("top",o.offset+"px");t.data("sticky-stopped",false);var i=t.data("sticky-stopped-parent");if(i){if(o.append){i.append(t)}else{i.prepend(t)}}t.removeData("sticky-stopped-parent")}function h(t){return t.data("stickied")||false}function w(t){var i=t.attr("data-original-pos");var a=t.attr("data-original-width");if(!i){m(t);i=t.attr("data-original-pos");a=t.attr("data-original-width")}return{originalPos:i,originalTop:i.split(";")[0],originalLeft:i.split(";")[1],originalWidth:a}}function m(i){var a=Number(i.css("margin-left").replace("px",""));var e=i.offset().left-a;var n=i.offset().top+";"+e;var o=i.outerWidth();i.attr("data-original-pos",n);i.attr("data-original-width",o);t(document).ajaxStop(function(a){i.removeAttr("data-original-pos");i.removeAttr("data-original-width");t(document).unbind(a)})}}})(jQuery);$(window).load(function(){"use strict";$.sticky(".js-sticky-element",{offset:20,noStop:true});$.sticky(".mceEditor .toolbars",{bottom:"parent",noStopOnBody:true},function(i){t(i)},function(t){i(t)});$.sticky(".sticky-nav",{noStopOnBody:true},function(i){t(i)},function(t){i(t)});$.sticky(".sticky-li-row",{unstickyOnAjax:false,bottom:{ancestor:"div"},stickyCondition:function(t){var i=5;var a=t.parents("ul").first();var e=a.find("li");var n=t.parents("div.js-no-sticky");if(n.length>0){return false}if(e.length<i){return false}else{return true}},append:false},function(i){t(i)},function(t){i(t)});var t=function(t,i){var a=null;if(typeof i!==undefined){a=t.parents(i).first()}else{a=t.parent()}var e=parseInt(a.css("padding-top"),10);t.parent().css("padding-top",t.outerHeight()+e+"px")};var i=function(t,i){var a=null;if(typeof i!==undefined){a=t.parents(i).first()}else{a=t.parent()}t.parent().css("padding-top","")}});
$(document).ready(function(){"use strict";var e=$(".js-sticky-aside").first(),r=$("#masthead,.masthead").first(),t=!!e.length,i=!!r.length;if(!t||!i){return}var n=$(window),o=$("#site"),f=$(this),a=$(".js-sticky-watch"),s=$(".js-sticky-hold"),l=e.prev(),u=$(".js-video-sticky");if(!a||a.length===0||!s||s.length===0){return}var c="stuck";var v="bottom";var h="resizeRecirc";var g=false;var p=false;var d=false;var y=".recircBottom";var m="scroll.recircBottom resizeRecirc.recircBottom";var b=".recircTop";var C="scroll.recircTop resizeRecirc.recircTop";var k=".recircPrev";var w="scroll.recircPrev resizeRecirc.recircPrev";var T=".recircAdRender";var z="ad_rendered.recircAdRender";var H=null;var M=null;var R=function(){return g||p||d};var j=function(e){if(g===e){return}g=e;if(true===e){n.on(C,F)}else{n.off(b)}};var A=function(e){if(d===e){return}d=e;if(true===e){n.on(m,O);O()}else{n.off(y)}};var N=function(e){if(!l||l.length<=0){return}if(p===e){return}p=e;if(true===e){n.on(w,G);G()}else{n.off(k)}};var V=function(){return e.hasClass(c)};var x=function(){return e.hasClass(v)};var B=function(){var e=null;return function(){var t="fixed"===r.css("position"),i="absolute"===r.css("position"),n=0,o=false,f,a;if(t||i){a=parseInt(r.css("top"),10);if(isNaN(a)){a=0}f={top:a+scrollMonitor.viewportTop}}else{f=r.offset()}f.bottom=r.outerHeight()+f.top;if(e){n=e.top-f.top;if(n>0&&e.change<=0||n<0&&e.change>=0){o=true}}else{e=f;n=0}f.change=n;f.hasDirectionChange=o;e=f;return f}}();var P=function(){var r=null,t=0;return function(i){if(null===r||true===i){if(true===V()&&false===x()){t=parseInt(e.css("top"),10);if(true===isNaN(t)){t=0}}r=e.offset();r.cssTop=t;r.height=e.outerHeight()}return r}}();var D=function(){var e;return function(r){if(!e||r){e=o.offset()}e.bottom=e.top+o.outerHeight();return e}}();var E=function(){var e=null,r,t;return function(i){if(null===e||true===i){var n=a.offset(),o=s.offset(),f=true;n.height=a.outerHeight();o.height=s.outerHeight();if(null!==e&&r.top===n.top&&t.top===o.top&&r.height===n.height&&t.height===o.height){e.hasChange=f=false}else{r=n;t=o;if(null===e){e={primary:r,secondary:t,hasChange:f}}else{e.primary=r;e.secondary=t;e.hasChange=f}}}return e}}();var I=function(){var e;return function(r){if(!l||l.length<=0){return}if(undefined===e||r){var t=l.css("display"),i=l.css("visibility"),n=l.attr("style"),o="none"===t||"hidden"===i;if(o){l.css({display:"block",visibility:"visible"})}e=l.offset();e.bottom=e.top+l.outerHeight();if(o){l.css({display:"",visibility:""});l.attr("style",n)}}return e}}();var S=function(){var e=E();if(e.primary.top===e.secondary.top){return true}return false};var L=function(r){if(r){e.css("width",s.width())}else{e.css("width","auto")}};var O=function(r){var t=r&&r.type&&r.type.indexOf("resize")>=0||false,i=B(),n=D(t),o=n.bottom,f=E(),a=f.secondary.top,s=P(t),l=scrollMonitor.viewportTop+s.cssTop,u=l+s.height;if(t){L(V())}if(i.change>0){if(u<o){e.removeClass(v)}if(a>=l&&i.bottom<a){q(false);e.removeClass(v)}}else{if(u>=o){e.addClass(v)}else if(u<o){e.removeClass(v)}}};var _=function(){if(null===H){return}var e=V();q(false);H.unlock();H.recalculateLocation();H.lock();if(e){q(true)}};var q=function(r){L(r);e.toggleClass(c,r);A(r);N(r)};var F=function(){var e=B(),r=e.change,t=H.top+H.offsets.top,i=t<e.bottom,n=V(),o=H.isAboveViewport,f=t<=scrollMonitor.viewportTop;j(!f&&o);if(0===r){q(H.isAboveViewport)}else{if(i&&!n){q(true)}else if(!i&&n){q(false)}}G()};var G=function(){if(l&&l.length>0&&!l.next().is(e)){J()}if(!l||l.length<=0){return}var r=V(),t=I(),i=t.bottom,n=e.offset().top,o=i>n;if(o&&r){q(false)}};var J=function(){Q();l=e.prev();if(!!l&&l.length>0){_();K()}return l};var K=function(){if(M){return}if(!!l&&l.length>0){M=scrollMonitor.create(l);M.stateChange(function(){G()})}else{l=null}};var Q=function(){if(!M){return}if(!!l&&l.length>0){M.destroy();M=null}};var U=function(){if(null!==H||false===S()){return}var t={top:r.height()};H=scrollMonitor.create(e,t);H.lock();K();H.stateChange(function(){F()});if(scrollMonitor.viewportTop>0){F()}f.on(z,function(){I(true);if(R()){n.trigger(h)}})};var W=function(){if(null===H){return}f.off(T);q(false);j(false);H.destroy();H=null;Q()};var X=function(){var e=null;var r=function(){W()};var t=function(t){if(t&&null===e){e=r;u.on("sticky.recircVideoSticky",e)}else if(!t&&null!==e){e=null;u.off(".recircVideoSticky")}};return function(){if(u.data("stickyEnabled")){t(true)}u.on({stickyEnabled:function(){t(true)},stickyDisabled:function(){t(false);U()}})}}();var Y=function(){var e={load:false,livefyreChange:false};var r=null;var t=function(){var e=S();if(true===e&&null===H){U()}else if(false===e&&null!==H){W();return false}return true};return function(i){B();e[i.type]=true;if(a.height()>s.height()){if(u){X()}if(null===r){n.on("resize.recirc",r=function(r){var i=E(true);if(null!==H&&false===e.load){_()}if(t()){if(null!==H&&i.hasChange){_();F();O(r)}I(true);if(R()){n.trigger(h)}}else{W()}})}U();if("livefyreChange"===i.type){n.trigger("resize")}}}}();n.on("load livefyreChange",Y)});
(function(t){"use strict";var a=false;if(!!window.Modernizr&&!!Modernizr.video&&!!Modernizr.video.h264){a=true}var e=$(document),i=$(window);var r="stopped";var n="parent";var o="parentElement";var v="videoClip";var d="watcher";var f="resize.videoClip";var c=[],u,s=false;var l=function(t){var a=$(t);if(!a.data(r)){t.pause();a.data(r,true)}};var p=function(){u.each(function(){l(this)})};var h=function(){s=true;p()};var y=function(t){if(true===s){return}var a=$(t);if(!!a.data(r)){t.play();a.data(r,false)}};var w=function(t){var a=t.data(o),e,i;if(undefined===a){e=t.data(v);if(!e){e=t}i=t.data(n);if(!i){i="[data-no-video-clip-style]"}a=e.closest(i);if(0===a.length){a=null}t.data(o,a)}return a};var m=function(t,a){var e=w(t),i;if(!!e){if(a){e.removeAttr("style")}else{i=e.data("no-video-clip-style");if(!!i&&i!==e.attr("style")){e.attr("style",i)}}}};var z=function(t,a){var e=a.data(d);if("hidden"===t.css("visibility")){m(a);l(t[0])}else{m(a,true);if(e.isInViewport){y(t[0])}}};var M=function(t){var a,e,r=t.attr("content"),n=t.data(),o;try{n["src"]=r;e=$("<video/>",n);t.replaceWith(e);t.data(v,e)}catch(u){e=undefined;m(t)}if(!!e){a=e[0];c.push(a);o=scrollMonitor.create(a);o.enterViewport(function(){y(a)});o.exitViewport(function(){l(a)});t.data(d,o);z(e,t);i.on(f,function(){z(e,t)})}};var V=function(){var t=$(this);if(true===a){M(t)}else{m(t)}};var C=function(){var t=$("meta.js-video-clip");t.each(V);u=$(c);e.on("video_play",h)};e.ready(C)})(this);
!function(){"use strict";var t,e=function(){var t=/\-([a-z])/g,e=function(t,e){return e.toUpperCase()};return function(o){return o.replace(t,e)}}(),o=function(t,o){var n,r,i,s,a,l;if(window.getComputedStyle?n=window.getComputedStyle(t,null).getPropertyValue(o):(r=e(o),n=t.currentStyle?t.currentStyle[r]:t.style[r]),"cursor"===o&&(!n||"auto"===n))for(i=t.tagName.toLowerCase(),s=["a"],a=0,l=s.length;l>a;a++)if(i===s[a])return"pointer";return n},n=function(t){if(m.prototype._singleton){t||(t=window.event);var e;this!==window?e=this:t.target?e=t.target:t.srcElement&&(e=t.srcElement),m.prototype._singleton.setCurrent(e)}},r=function(t,e,o){t.addEventListener?t.addEventListener(e,o,!1):t.attachEvent&&t.attachEvent("on"+e,o)},i=function(t,e,o){t.removeEventListener?t.removeEventListener(e,o,!1):t.detachEvent&&t.detachEvent("on"+e,o)},s=function(t,e){if(t.addClass)return t.addClass(e),t;if(e&&"string"==typeof e){var o=(e||"").split(/\s+/);if(1===t.nodeType)if(t.className){for(var n=" "+t.className+" ",r=t.className,i=0,s=o.length;s>i;i++)n.indexOf(" "+o[i]+" ")<0&&(r+=" "+o[i]);t.className=r.replace(/^\s+|\s+$/g,"")}else t.className=e}return t},a=function(t,e){if(t.removeClass)return t.removeClass(e),t;if(e&&"string"==typeof e||void 0===e){var o=(e||"").split(/\s+/);if(1===t.nodeType&&t.className)if(e){for(var n=(" "+t.className+" ").replace(/[\n\t]/g," "),r=0,i=o.length;i>r;r++)n=n.replace(" "+o[r]+" "," ");t.className=n.replace(/^\s+|\s+$/g,"")}else t.className=""}return t},l=function(){var t,e,o,n=1;return"function"==typeof document.body.getBoundingClientRect&&(t=document.body.getBoundingClientRect(),e=t.right-t.left,o=document.body.offsetWidth,n=Math.round(100*(e/o))/100),n},d=function(t){var e={left:0,top:0,width:0,height:0,zIndex:999999999},n=o(t,"z-index");if(n&&"auto"!==n&&(e.zIndex=parseInt(n,10)),t.getBoundingClientRect){var r,i,s,a=t.getBoundingClientRect();"pageXOffset"in window&&"pageYOffset"in window?(r=window.pageXOffset,i=window.pageYOffset):(s=l(),r=Math.round(document.documentElement.scrollLeft/s),i=Math.round(document.documentElement.scrollTop/s));var d=document.documentElement.clientLeft||0,p=document.documentElement.clientTop||0;e.left=a.left+r-d,e.top=a.top+i-p,e.width="width"in a?a.width:a.right-a.left,e.height="height"in a?a.height:a.bottom-a.top}return e},p=function(t,e){var o=!(e&&e.useNoCache===!1);return o?(-1===t.indexOf("?")?"?":"&")+"nocache="+(new Date).getTime():""},u=function(t){var e=[],o=[];return t.trustedOrigins&&("string"==typeof t.trustedOrigins?o.push(t.trustedOrigins):"object"==typeof t.trustedOrigins&&"length"in t.trustedOrigins&&(o=o.concat(t.trustedOrigins))),t.trustedDomains&&("string"==typeof t.trustedDomains?o.push(t.trustedDomains):"object"==typeof t.trustedDomains&&"length"in t.trustedDomains&&(o=o.concat(t.trustedDomains))),o.length&&e.push("trustedOrigins="+encodeURIComponent(o.join(","))),"string"==typeof t.amdModuleId&&t.amdModuleId&&e.push("amdModuleId="+encodeURIComponent(t.amdModuleId)),"string"==typeof t.cjsModuleId&&t.cjsModuleId&&e.push("cjsModuleId="+encodeURIComponent(t.cjsModuleId)),e.join("&")},c=function(t,e){if(e.indexOf)return e.indexOf(t);for(var o=0,n=e.length;n>o;o++)if(e[o]===t)return o;return-1},h=function(t){if("string"==typeof t)throw new TypeError("ZeroClipboard doesn't accept query strings.");return t.length?t:[t]},f=function(t,e,o,n,r){r?window.setTimeout(function(){t.call(e,o,n)},0):t.call(e,o,n)},m=function(t,e){if(t&&(m.prototype._singleton||this).glue(t),m.prototype._singleton)return m.prototype._singleton;m.prototype._singleton=this,this.options={};for(var o in y)this.options[o]=y[o];for(var n in e)this.options[n]=e[n];this.handlers={},m.detectFlashSupport()&&C()},g=[];m.prototype.setCurrent=function(e){t=e,this.reposition();var n=e.getAttribute("title");n&&this.setTitle(n);var r=this.options.forceHandCursor===!0||"pointer"===o(e,"cursor");return v.call(this,r),this},m.prototype.setText=function(t){return t&&""!==t&&(this.options.text=t,this.ready()&&this.flashBridge.setText(t)),this},m.prototype.setTitle=function(t){return t&&""!==t&&this.htmlBridge.setAttribute("title",t),this},m.prototype.setSize=function(t,e){return this.ready()&&this.flashBridge.setSize(t,e),this},m.prototype.setHandCursor=function(t){return t="boolean"==typeof t?t:!!t,v.call(this,t),this.options.forceHandCursor=t,this};var v=function(t){this.ready()&&this.flashBridge.setHandCursor(t)};m.version="1.2.1";var y={moviePath:"ZeroClipboard.swf",trustedOrigins:null,text:null,hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",allowScriptAccess:"sameDomain",useNoCache:!0,forceHandCursor:!1};m.setDefaults=function(t){for(var e in t)y[e]=t[e]},m.destroy=function(){m.prototype._singleton.unglue(g);var t=m.prototype._singleton.htmlBridge;t.parentNode.removeChild(t),delete m.prototype._singleton},m.detectFlashSupport=function(){var t=!1;if("function"==typeof ActiveXObject)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")&&(t=!0)}catch(e){}return!t&&navigator.mimeTypes["application/x-shockwave-flash"]&&(t=!0),t};var b=null,w=null,C=function(){var t=m.prototype._singleton,e=document.getElementById("global-zeroclipboard-html-bridge");if(!e){var o={};for(var n in t.options)o[n]=t.options[n];o.amdModuleId=b,o.cjsModuleId=w;var r=u(o),i='      <object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" id="global-zeroclipboard-flash-bridge" width="100%" height="100%">         <param name="movie" value="'+t.options.moviePath+p(t.options.moviePath,t.options)+'"/>         <param name="allowScriptAccess" value="'+t.options.allowScriptAccess+'"/>         <param name="scale" value="exactfit"/>         <param name="loop" value="false"/>         <param name="menu" value="false"/>         <param name="quality" value="best" />         <param name="bgcolor" value="#ffffff"/>         <param name="wmode" value="transparent"/>         <param name="flashvars" value="'+r+'"/>         <embed src="'+t.options.moviePath+p(t.options.moviePath,t.options)+'"           loop="false" menu="false"           quality="best" bgcolor="#ffffff"           width="100%" height="100%"           name="global-zeroclipboard-flash-bridge"           allowScriptAccess="always"           allowFullScreen="false"           type="application/x-shockwave-flash"           wmode="transparent"           pluginspage="http://www.macromedia.com/go/getflashplayer"           flashvars="'+r+'"           scale="exactfit">         </embed>       </object>';e=document.createElement("div"),e.id="global-zeroclipboard-html-bridge",e.setAttribute("class","global-zeroclipboard-container"),e.setAttribute("data-clipboard-ready",!1),e.style.position="absolute",e.style.left="-9999px",e.style.top="-9999px",e.style.width="15px",e.style.height="15px",e.style.zIndex="9999",e.innerHTML=i,document.body.appendChild(e)}t.htmlBridge=e,t.flashBridge=document["global-zeroclipboard-flash-bridge"]||e.children[0].lastElementChild};m.prototype.resetBridge=function(){return this.htmlBridge.style.left="-9999px",this.htmlBridge.style.top="-9999px",this.htmlBridge.removeAttribute("title"),this.htmlBridge.removeAttribute("data-clipboard-text"),a(t,this.options.activeClass),t=null,this.options.text=null,this},m.prototype.ready=function(){var t=this.htmlBridge.getAttribute("data-clipboard-ready");return"true"===t||t===!0},m.prototype.reposition=function(){if(!t)return!1;var e=d(t);return this.htmlBridge.style.top=e.top+"px",this.htmlBridge.style.left=e.left+"px",this.htmlBridge.style.width=e.width+"px",this.htmlBridge.style.height=e.height+"px",this.htmlBridge.style.zIndex=e.zIndex+1,this.setSize(e.width,e.height),this},m.dispatch=function(t,e){m.prototype._singleton.receiveEvent(t,e)},m.prototype.on=function(t,e){for(var o=t.toString().split(/\s/g),n=0;n<o.length;n++)t=o[n].toLowerCase().replace(/^on/,""),this.handlers[t]||(this.handlers[t]=e);return this.handlers.noflash&&!m.detectFlashSupport()&&this.receiveEvent("onNoFlash",null),this},m.prototype.addEventListener=m.prototype.on,m.prototype.off=function(t,e){for(var o=t.toString().split(/\s/g),n=0;n<o.length;n++){t=o[n].toLowerCase().replace(/^on/,"");for(var r in this.handlers)r===t&&this.handlers[r]===e&&delete this.handlers[r]}return this},m.prototype.removeEventListener=m.prototype.off,m.prototype.receiveEvent=function(e,o){e=e.toString().toLowerCase().replace(/^on/,"");var n=t,r=!0;switch(e){case"load":if(o&&parseFloat(o.flashVersion.replace(",",".").replace(/[^0-9\.]/gi,""))<10)return this.receiveEvent("onWrongFlash",{flashVersion:o.flashVersion}),void 0;this.htmlBridge.setAttribute("data-clipboard-ready",!0);break;case"mouseover":s(n,this.options.hoverClass);break;case"mouseout":a(n,this.options.hoverClass),this.resetBridge();break;case"mousedown":s(n,this.options.activeClass);break;case"mouseup":a(n,this.options.activeClass);break;case"datarequested":var i=n.getAttribute("data-clipboard-target"),l=i?document.getElementById(i):null;if(l){var d=l.value||l.textContent||l.innerText;d&&this.setText(d)}else{var p=n.getAttribute("data-clipboard-text");p&&this.setText(p)}r=!1;break;case"complete":this.options.text=null}if(this.handlers[e]){var u=this.handlers[e];"string"==typeof u&&"function"==typeof window[u]&&(u=window[u]),"function"==typeof u&&f(u,n,this,o,r)}},m.prototype.glue=function(t){t=h(t);for(var e=0;e<t.length;e++)-1==c(t[e],g)&&(g.push(t[e]),r(t[e],"mouseover",n));return this},m.prototype.unglue=function(t){t=h(t);for(var e=0;e<t.length;e++){i(t[e],"mouseover",n);var o=c(t[e],g);-1!=o&&g.splice(o,1)}return this},"function"==typeof define&&define.amd?define(["require","exports","module"],function(t,e,o){return b=o&&o.id||null,m}):"object"==typeof module&&module&&"object"==typeof module.exports&&module.exports?(w=module.id||null,module.exports=m):window.ZeroClipboard=m}();
(function(t){"use strict";var a=".js-clipboard-set";var i=".js-clipboard-btn";var e=".js-clipboard-target";var o="is-clipboard-copied";var r=0;var d=2e3;var c="clipboard-copied-delay";var s="clipboard-copied-msg";var n=function(){var t=$(a);t.each(function(){var t=$(this),a=t.find(e).first(),o=t.find(i).first(),d;if(0===a.length||0===o.length){return}d=a.attr("id");if(!d){r+=1;d="js-clipboard-target-"+r;a.attr("id",d)}o.attr("data-clipboard-target",d)})};var l=function(){var t=$(this),a=t.data(c)||d,i=t.data(s),e=t.data("copiedTimeoutId");if(!!i){Phoenix.Ui.showSuccessMessage(i)}if(!!e){clearTimeout(e);t.data("copiedTimeoutId",false)}t.addClass(o);e=setTimeout(function(){t.removeClass(o);t.data("copiedTimeoutId",false)},a);t.data("copiedTimeoutId",e)};var f=function(){var a=$(i),e=t.ZeroClipboard,o=$("meta#ZeroClipBoardSwf").attr("content"),r="function"===typeof e,d,c=window.location;if(!r||!o||0===a.length){if(0<a.length){a.remove()}return}n();e.setDefaults({allowScriptAccess:"always",moviePath:o,trustedOrigins:[c.protocol+"//"+c.host]});d=new e(a);d.on("complete",l)};$(window).on("load",f)})(this);
(function(t,e){"use strict";var n=window.location.pathname;function i(){var t=e("#nav-main");var n=e(".js-highlightable-sub-nav");a(t,true,true);n.each(function(t,n){a(e(this),true)})}function a(t,i,a){var r=t.find("li");var h=null;var f=r.first();if(!a){h=f}r.each(function(t,a){var r=e(this).children("a").attr("href");if(r=="#"){r=e(this).children("a").next().attr("href")}if(typeof r!=="undefined"&&(i||r.length===n.length)&&n.indexOf(r)===0){h=e(this)}else if(typeof r==="undefined"&&h!==null&&n.length!==h.children("a").attr("href").length&&n.length!==f.children("a").attr("href").length&&h.children("a").attr("href").length==f.children("a").attr("href").length){e(this).find("dd").each(function(t,a){r=e(this).children("a").attr("href");if(typeof r!=="undefined"&&i||r.length===n.length&&n.indexOf(r)===0){h=e(this).closest("li")}})}});if(h){h.addClass("active")}}var r=function(){var t=e(".js-dropnav-active");if(typeof e.fn.menuAim==="undefined"){return false}e.each(t,function(){var t=e(this);if(t.data("hover-init")){return}var n="right";if(t.attr("data-direction")){n=t.attr("data-direction")}t.menuAim({activate:function(t){e(t).addClass("dropnav-menu__active")},deactivate:function(t){e(t).removeClass("dropnav-menu__active")},submenuDirection:n});t.data("hover-init",true)})};e(document).ready(function(){i();r()});e(document).ajaxComplete(function(){r()})})(this,jQuery);
$(document).ready(function(){"use strict";var t=$(".js-share-button-facebook");var e=$(".js-share-button-twitter");var r=$(".js-share-button-reddit");var a=$(".js-share-button-gplus");var i="https://graph.facebook.com/fql?q=SELECT%20url,%20normalized_url,%20share_count,%20like_count,%20comment_count,%20total_count,commentsbox_count,%20comments_fbid,%20click_count%20FROM%20link_stat%20WHERE%20url=";var o="http://urls.api.twitter.com/1/urls/count.json?url=";var n=".js-share-count";if(e.length>0){var s=e.attr("data-share-url");$.ajax({url:o+s,dataType:"jsonp",success:function(t){if(!t){return}var r=t.count;e.find(n).text(r);e.find(n).parent().removeClass("hide")}});e.click(function(){var t="";var e=$(".js-share-button-twitter").data("guid").split("-");if(e[0]=="1900"){t="review"}else if(e[0]=="1100"){t="article"}else if(e[0]=="2300"){t="video"}_BoomTrain.sendEvent("shared",{model:t,id:e[1],network:"twitter"})})}if(t.length>0){var s=t.attr("data-share-url");$.get(i+"'"+s+"'",function(e){if(!e){return}var r=e.data[0].total_count;t.find(n).text(r);t.find(n).parent().removeClass("hide")});t.click(function(){var t="";var e=$(".js-share-button-facebook").data("guid").split("-");if(e[0]=="1900"){t="review"}else if(e[0]=="1100"){t="article"}else if(e[0]=="2300"){t="video"}_BoomTrain.sendEvent("shared",{model:t,id:e[1],network:"facebook"})})}if(a.length>0){a.click(function(){var t="";var e=$(".js-share-button-gplus").data("guid").split("-");if(e[0]=="1900"){t="review"}else if(e[0]=="1100"){t="article"}else if(e[0]=="2300"){t="video"}_BoomTrain.sendEvent("shared",{model:t,id:e[1],network:"gplus"})})}if(r.length>0){var s=t.attr("data-share-url");var l="http://www.reddit.com/static";var c='<iframe src="http://www.reddit.com/static/button/button1.html?width=120&amp;url='+encodeURIComponent(s)+'" height="22" width="120" scrolling="no" frameborder="0"></iframe>';r.html(c)}});
$(document).ready(function(){"use strict";var a=$(".js-show-loader");var s=".js-show-loader-shows";var t=a.find(".js-show-loader-video");var e=a.find(".js-show-loader-info");var o="/api/show/{slug}/latest";a.on("click",s+" li",function(a){a.preventDefault();var s=$(this);if(s.hasClass("is-today")){return false}s.siblings().removeClass("is-today");s.addClass("is-today");var r=s.attr("data-day");var d=s.attr("data-slug");t.fadeOut("slow");e.children().fadeOut("slow",function(){AjaxApiRequest.makeGetApiRequest(o.replace("{slug}",d),function(a){if(r!=="Today"){e.find(".js-show-loader-last").removeClass("hide")}else{e.find(".js-show-loader-last").addClass("hide")}e.find(".js-show-loader-day").text(r+"'s");e.find(".js-show-loader-title").text(a.title);e.find(".js-show-loader-title").attr("href",a.url);e.find(".js-show-loader-comments").text(a.commentCount).parent("a").attr("href",a.url);t.find(".av-wrapper").css("background-image","");t.find(".av-wrapper").html(a.html);t.fadeIn("slow");e.children().fadeIn("slow")})})});$(".js-show-loader-initial").on("click",function(){var a=$(this).attr("data-video-url");$(this).parent().css("background-image","");$(this).parent().html(a)})});
$(document).ready(function(){"use strict";var e=$(".js-carousel"),s=!!e.length;if(!s){return}var o=null;var t=$(".js-carousel-pos li");var a=$('meta[itemprop="deviceType"]').attr("content");var l=function(e){o=Swipe(e.get(0),{callback:function(e){var s=t.length;while(s--){console.log(t.eq(s));if(t.eq(s).hasClass("on")){t.eq(s).removeClass("on")}}t.eq(e).addClass("on")}});var s=$(".carousel .item-list").attr("data-page-length");e.removeClass("loading");e.children().removeClass("hide");t.first().addClass("on");e.parents("section").first().on("click",".js-carousel-left",function(){o.prev()});e.parents("section").first().on("click",".js-carousel-right",function(){o.next()});$(".carousel .item-list__item").css("width",100/s+"%");if(a!="phone"){$(".carousel-control").hover(function(){$(".js-carousel").toggleClass("carousel-hover")});$(".carousel .item-list__item").hover(function(){$(".carousel-control").toggleClass("carousel-item-hover")})}};e.each(function(){l($(this))})});
(function(){"use strict";window.PhoenixUtils={getHtmlTemplate:function(n){var r=$('script[type="text/template/'+n+'"]');if(!r.length){return""}return r.html().trim()},cloneObject:function(n){try{return JSON.parse(JSON.stringify(n))}catch(r){return null}},fromJson:function(n){try{return JSON.parse(n)}catch(r){return null}},toJson:function(n){try{return JSON.stringify(n)}catch(r){return null}},capitalizeString:function(n){return n.charAt(0).toUpperCase()+n.slice(1)},getBrowser:function(){if(typeof navigator.userAgent=="undefined"){return"unknown"}if(navigator.userAgent.search("Chrome")!=-1){return"chrome"}if(navigator.userAgent.search("Firefox")!=-1){return"firefox"}if(navigator.userAgent.search("Safari")!=-1){return"safari"}if(navigator.userAgent.search("MSIE")!=-1){return"ie"}return"unknown"},getIEVersion:function(){return parseFloat(navigator.appVersion.split("MSIE")[1])},getOS:function(){var n=navigator.appVersion;if(n.indexOf("Windows")!=-1){var r=n.indexOf("Windows NT");if(r==-1){return"Windows9x"}var i=n.substr(r+11,3);if(i=="6.2"){return"Windows8"}if(i=="6.1"){return"Windows7"}if(i=="6.0"){return"WindowsVista"}if(i=="5.1"){return"WindowsXP"}if(i=="5.0"){return"Windows2K"}return"WindowsNT"}if(n.indexOf("iPad")!=-1){return"iOS-iPad"}if(n.indexOf("iPhone")!=-1){return"iOS-iPhone"}if(n.indexOf("iPod")!=-1){return"iOS-iPod"}if(n.indexOf("Android")!=-1){return"Android"}if(n.indexOf("Mac")!=-1){return"MacOS"}if(n.indexOf("X11")!=-1){return"UNIX"}if(n.indexOf("Linux")!=-1){return"Linux"}return"Unknown"},eoo:null}})();
$(document).ready(function(){"use strict";var t=$(".js-schedule--vertical"),a=!!t.length;if(!a){return}var s=$(window),i=$(document),e=$(".js-schedule-time"),r=$(".js-schedule-event"),n=$(".js-schedule-tabs"),h=$(".js-schedule-day"),d=$(".js-current-time");var c=function(){var t=$(e[0]).attr("data-attr-start");r.each(function(){var a=$(this).attr("data-attr-start");var s=$(this).attr("data-attr-length");$(this).css("top",(a-t)*.0333);$(this).css("height",s*.0333)})};var l=function(){n.find("li").each(function(t,a){$(this).on("click",function(t){var a=$(this).attr("data-attr-day"),s=$(".js-schedule-date"),i=$(this).siblings("li");if(i.hasClass("active")){i.removeClass("active");$(this).addClass("active")}if(s){var e=s.find("em");e.html($(this).attr("data-attr-date"))}f(a);t.preventDefault()});if($(this).hasClass("active")){f($(this).attr("data-attr-day"))}})};var f=function(t){var a=t,s=null;r.each(function(t,s){r.not($(this).addClass("hidden"));$(this).each(function(){if(a===$(this).attr("data-attr-day")){if($(this).hasClass("hidden")){$(this).removeClass("hidden")}}})})};var u=function(){var t=h.innerHeight(),a=d.attr("data-attr-time-offset");if(t){var s=t/e.length;if(a>0&&a<s){d.css("bottom",a*s)}}};var v=function(){c();l();u()};v()});
$(function(){$(".js-lazy-load-image").unveil({threshold:$(window).height()});$(".js-lazy-load-video").unveil({threshold:1500,delay:1e3,mode:"all"});$(".js-extra-lazy-load-video").one("click",function(e){var a=$("<iframe>");var t=$(this);var i=t.prop("attributes");$.each(i,function(){a.attr(this.name,this.value)});t.replaceWith(a);e.preventDefault()})});
$(function(){$("#toc_list a[href*=#]").click(function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var t=$(this.hash);t=t.length?t:$("[name="+this.hash.slice(1)+"]");if(t.length){$("html,body").animate({scrollTop:t.offset().top-($("#masthead-logo").is(":hidden")?0:$("#masthead").height())},1e3);return false}}});$('a[data-toggle="collapse"]').click(function(){var t=$(this);if(t.text()==="hide"){t.text("show")}else if(t.text()==="show"){t.text("hide")}})});
$(function(){"use strict";var e=$(".js-review-scale-widget-container");var r=$(".js-user-review-scale-container");var s=$(".js-user-review-scale-slider");var a=$(".js-user-review-scale-fill");var t=e.find("a[data-original-url]");var i=$(".js-user-review-scale");var o=$(".js-current-user-review-score");var c=false;var n=$(".js-current-user-review-question");if(!o.length){c=true}var u=false;var l=i.attr("data-current-score");var v=t.attr("data-original-url");var d=e.attr("data-rate-url");var f=i.attr("data-assoc-id");var w=i.attr("data-assoc-type-id");var h=w+"-"+f;var j=false;var p='<span class="breakdown-yourScore__title js-current-user-review-title">You rated <span>{objectName}</span>';var g='<span class="breakdown-yourScore__score js-current-user-review-score">{userReviewScore}</span>';t.attr("href",v+"?score="+l);r.on("mouseenter","li",function(){if(j){return}if(!u){s.fadeIn(350);s.children().removeClass("hide");s.css("width",parseInt($(this).text(),10)*10+"%")}});r.on("mouseleave",function(){if(j){return}if(!u){s.fadeOut(350)}else{s.css("width",l*10+"%")}});r.on("click","li",function(){if(j){return}l=parseInt($(this).text(),10);s.css("width",l*10+"%");t.attr("href",v+"?score="+l);u=true;s.children().addClass("hide");s.fadeOut(350,function(){u=false});a.css("width",l*10+"%");AjaxApiRequest.makeApiRequest(d,{score:l},true,function(e){j=false;if(!c){o.text(e["score"])}else{var r=p.replace("{objectName}",n.data("objectName"));if(e["success"]==true){r=r.replace("{userReviewScore}",e["score"]);c=false;n.replaceWith(r);$(".js-current-user-review-title").after($(g.replace("{userReviewScore}",e["score"])));o=$(".js-current-user-review-score")}}if(e["success"]==false){if(e["error"]=="access denied"){Phoenix.Ui.showErrorMessage("You must login to submit a score.")}else if(e["error"]=="user not allowed to create a review"){Phoenix.Ui.showErrorMessage("You are not allowed to create a review.")}else{Phoenix.Ui.showErrorMessage("Rating coult not be saved.")}}else{i.attr("data-current-score",e["score"]);Phoenix.Ui.showSuccessMessage("Rating saved.")}},function(e){j=false;if(e!=="Forbidden"){Phoenix.Ui.showErrorMessage("Error while saving.")}})})});
$(document).ready(function(){if(!Phoenix.userLoggedIn()){return}$.get("/api/user/im-here");setInterval(function(){$.get("/api/user/thump-thump")},18e4)});
(function(l){"use strict";var n=[];var t=function(){var l={init:function(l){e=l.find(".js-poll-not-voted");o=l.find(".js-poll-voted");i=l.find(".js-poll-options");s=l.find(".js-poll-tally");r=i.find(".js-poll-option");d=l.find(".js-poll-submit");v=l.find(".js-poll-error");u=v.find(".js-error-text");n=l.attr("data-poll-id");t=l.attr("data-voting-allowed");a=l.attr("data-user-voted");if(!t||a){var h=o.attr("data-tally");c($.parseJSON(h));p($.parseJSON(h));o.removeClass("hidden")}else{e.removeClass("hidden")}if(r.length){f()}return this},eoo:null};var n=null;var t=false;var a=false;var e=null;var o=null;var i=null;var s=null;var r=null;var d=null;var v=null;var u=null;function f(){r.click(function(){var l=$(this);if(l.hasClass("js-poll-option-selected")){return}var n=i.find(".js-poll-option-selected");if(n[0]){n.removeClass("js-poll-option-selected")}l.addClass("js-poll-option-selected")});d.click(function(){var l=i.find(".js-poll-option-selected");if(!l[0]){return}v.addClass("hidden");var t=l.attr("data-poll-option-id");AjaxApiRequest.makeApiRequest("/poll/"+n+"/vote/"+t,null,false,function(l){if(l.success){c(l.tally);p(l.tally);o.removeClass("hidden");e.addClass("hidden")}else{h(l.error)}},function(l,n,t){if(l||n||t){}console.log("voting error "+t)})});$("#designer-values-submit").click(function(){var l=$(".js-designer-tally-values");var n=0;var t=0;l.each(function(l,a){n++;t+=parseInt($(a).val(),10)});if(t!=100){if(t>100){l.val(100/n)}else{var a=(100-t)/n;l.each(function(l,t){var e=$(t);n++;e.val(parseInt(e.val(),10)+a)})}}})}function c(l){s.find(".js-option-tally").each(function(n,t){var a=$(t);var e=parseInt(a.attr("data-poll-option-id"),10);a.text(l[e]+"%")})}function p(l){s.find(".js-option-pollbar").each(function(n,t){var a=$(t);var e=parseInt(a.attr("data-poll-option-id"),10);if(a.hasClass("js-option-pollbar--height")){a.css("height",l[e]+"%")}else{a.css("width",l[e]+"%")}})}function h(l){u.text(l);v.removeClass("hidden")}return l};$(document).ready(function(){$(".js-poll-container").each(function(l,a){n.push((new t).init($(a)))})})})(window);
(function(){var e={active:function(){return d},getVideoHooks:function(e){return i(e)},sendEvent:function(e,r,t,n){return l(e,r,t,n)},eoo:null};var r=$(document);var t=$(window);r.ready(function(){window._BoomTrain=e;if(typeof _bt=="undefined"){return}var r=$("meta[name=pageType]");if(r.length){f=r.attr("data-type");u=r.attr("data-id");c=r.attr("data-registration");m=r.attr("data-forumTopic")}if(f==""||f=="embed"){return}PostRender.getPostRenderData("BoomTrainBundle",function(e,r){if(r.identityToken){_bt.identify(r.identityToken);s=true}else{s=false}if(r.referrer){v=r.referrer}d=true;n();l("viewed");if(c=="true"){l("registered",{model:"user",id:f})}if(m=="true"){l("viewed",{model:"forum_thread",id:f})}},function(e){console.error(e)})});function n(){r.on(i(),".js-video-player");r.scroll(a);t.resize(a)}function i(e){return{videoStart:function(){l("videoPlay",null,"video",e)},contentProgress:function(r,t){var n=Math.ceil(t.currentTime/t.duration*100);o("videoView",n,"video",e)}}}function a(){if(g.scroll.allSent){return}var e=r.outerHeight();var n=t.height();var i=e-n;var a=i-(e-(r.scrollTop()+n));var l=a/(e-n);if(l<0||l>1){return}l=Math.ceil(l*100);o("scroll",l)}function o(e,r,t,n){var i=g[e];var a=null;if(r>24&&r<50&&!i["25"]){a=e+"25";i["25"]=true}else if(r>49&&r<75&&!i["50"]){a=e+"50";i["50"]=true}else if(r>74&&r<100&&!i["75"]){a=e+"75";i["75"]=true}else if(r==100&&!i["100"]){a=e+"100";i["100"]=true}if(a){l(a,null,t,n);var o=0;var f=0;for(var u in i){if(i.hasOwnProperty(u)&&u!="allSent"){f++;if(i[u]){o++}}}if(o==f){i.allSent=true}}}function l(e,r,t,n){if(r){r.signed_in=s;r.m_referrer=v}else{r={model:f,id:u,signed_in:s,referrer:v}}if(t&&n){r.subModel=t;r.subId=n}_bt.track(e,r)}var f="";var u="";var d=false;var s="";var v="";var c=false;var m=false;var g={scroll:{25:false,50:false,75:false,100:false,allSent:false},videoView:{25:false,50:false,75:false,100:false,allSent:false}};return e})();
(function(){var n="or",a="b",e="f",t="m",r="ss",o="ih",i="s-d";var f=a+a+e+n+t,s=r+a+e+"o";var c=e+"o"+i+o;var v="den",p='"hid';var u="t t",d="in",m="ype=",h="pu";function l(n){if(n){$("form").each(function(a,e){$(e).append($("<"+d+h+u+m+p+v+'" name="'+c+'" value="'+y(n)+'"/>'))})}}$(document).ready(function(){var n=$("meta[name="+s+"]").attr("content");l(n)});$(document).ajaxSuccess(function(n,a){if(a.getResponseHeader("Content-Type").indexOf("application/json")>-1){var e=$.parseJSON(a.responseText);if(e.hasOwnProperty("botBlaster")){l(e.botBlaster)}}});function y(n){var a=[8,3,7,1];var e=16;var t=n.length;var r="";for(var o=0,i=0;o<t;o++){var f=n.charAt(o);f=parseInt(f,e);f-=a[i++];if(f<0){f+=e}if(i>3){i=0}r+=f.toString(e)}return r}})();